// Copyright 1999-2012 SeaChange International
// All Rights Reserved.
NAF.conf={debug:2,traxisip:"213.224.176.50",traxisid:"Dxxxx01",chanlocsrc:"traxis",traxisidprefix:"CpeId",traxisUrl:"",enableHttpVod:!1,numhours:6,channelRefreshInterval:0,refreshInterval:0,refreshInterval0:3600,reminderTime:1,fetchInitEventsInChunks:!0,eventsRefreshInChunks:20,eventsRefreshTimeout:200,profileRefreshInterval:3600,pretune:!0,previouspretunes:0,followingpretunes:1,codcatalog:"root",searchCacheSize:10,upcPrice:!1,maxPinAttempts:3,pinRetryInterval:300,maxHistory:5,maxHistoryDuration:0,
pinAttemptsDuration:300,wakeuptime:120,prerecordwakeuptime:3,teletextHandling:!1,langTimeOut:500,mediawareip:"",chanUpDownKeyHandling:!1,startChannel:"CNN",initChannel:"lastViewed",lockedChannels:[],profileAgeRating:0,enable000reload:!1,useNewRecordingManager:!0,useUnifiedMapPlayer:!0,tuneByChanLocator:!0,catchUpCategory:"",catchUpChannel:0,genreData:JSON.stringify({genres:[{code:"1",name:"movie",subgenres:[]},{code:"2",name:"news",subgenres:[]},{code:"3",name:"show",subgenres:[]},{code:"4",name:"sports",
subgenres:[]},{code:"5",name:"children's",subgenres:[]},{code:"6",name:"music",subgenres:[]},{code:"7",name:"arts",subgenres:[]},{code:"8",name:"social",subgenres:[]},{code:"9",name:"education",subgenres:[]},{code:"10",name:"leisure",subgenres:[]},{code:"11",name:"special",subgenres:[]},{code:"12",name:"entertainment",subgenres:[]},{code:"13",name:"crime",subgenres:[]},{code:"14",name:"series",subgenres:[]},{code:"15",name:"adult",subgenres:[]}]}),provideDefaultSettings:!0,applications:[{id:"id1",
name:"MetrologicalAppStore",shortSynopsis:"The Metrological App Store",isAdult:!1,isViewable:!0,isEntitled:!0,url:"http://widgets.metrological.com/dawn/index.html",type:"store"}],blockUnratedTitleEvents:!0,maxRecommendations:30,recommendationTimeout:1800,maxSearches:0,reminderRefreshInterval:7200};
function nafCleanupConf(){NAF.conf.canned&&(NAF.conf.traxisid="");if("undefined"!==typeof window){for(var g=[],l,k=location.href.slice(location.href.indexOf("?")+1).split("&"),d=0;d<k.length;d++)l=k[d].split("="),g.push(l[0]),g[l[0]]=l[1];d=0;for(l=g.length;d<l;d++){var k=g[d].toLowerCase(),c;for(c in NAF.conf)if(k==c.toLowerCase()){k=g[g[d]];isNaN(k)?NAF.conf[c]="true"===k?!0:"false"===k?!1:k:NAF.conf[c]=parseFloat(k,10);break}}}}nafCleanupConf();nafCleanupConf=null;
NAF.utils={convertJSONDateToJSDate:function(g){var l;return"string"===typeof g&&(l=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(g))?new Date(Date.UTC(+l[1],+l[2]-1,+l[3],+l[4],+l[5],+l[6])):l},convertLocalJSONDateToLocalJSDate:function(g){var l;return"string"===typeof g&&(l=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(g))?new Date(+l[1],+l[2]-1,+l[3],+l[4],+l[5],+l[6]):l},convertJSONDateToMins:function(g){g=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(g);
return(new Date(Date.UTC(+g[1],+g[2]-1,+g[3],+g[4],+g[5],+g[6]))).getTime()/6E4},convertJSONDateToJSDateCanned:function(g){var l,k=new Date;return"string"===typeof g&&(l=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(g))?new Date(Date.UTC(+k.getUTCFullYear(),+k.getUTCMonth(),+k.getUTCDate(),+l[4],+l[5],+l[6])):l},convertJSDateToJSONDate:function(g){var l=g.getUTCMonth()+1;10>l&&(l="0"+l);var k=g.getUTCDate();10>k&&(k="0"+k);var d=g.getUTCHours();10>d&&(d="0"+d);var c=g.getUTCMinutes();
10>c&&(c="0"+c);return g.getUTCFullYear()+"-"+l+"-"+k+"T"+d+":"+c+":00Z"},clearTimer:function(g){g&&clearTimeout(g)},encodeXML:function(g){return g.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},throttle:function(g,l){function k(){d=null}var d,c,n;return function(){c=this;n=arguments;d||(result=g.apply(c,n),d=setTimeout(k,l))}},decimalToBinary:function(g,l){for(var k=
g,d=0,c=[];0<k;)d=k%2,k=Math.floor(k/2),c.unshift(d);k=l-c.length;if(0<k)for(d=0;d<k;d++)c.unshift(0);else if(0>k)return null;return c},copyByValue:function(g){function l(d,c){c=c||[];if(!d||"object"!=typeof d)return!1;var n=Object.keys(d),e,m;c.push(d);for(e=n.length-1;0<=e;e--)if((m=d[n[e]])&&"object"==typeof m&&(0<=c.indexOf(m)||l(m,c)))return!0;c.pop(d);return!1}var k=g instanceof Array?[]:new g.constructor;for(i in g)g[i]&&g[i]instanceof Date?k[i]=new Date(g[i]):g[i]&&"object"==typeof g[i]?l(g[i])?
k[i]=g[i]:k[i]=NAF.utils.copyByValue(g[i]):k[i]=g[i];return k},Log:function(){function g(b,a){if(l&&b.rank<=q.rank){console.log((new Date).toISOString()+" "+b.text+" "+k+" "+a[0]);for(var f=1;f<a.length;f++)console.log(a[f])}}var l=!1,k="",d={text:" FATAL ",rank:0},c={text:" ERROR ",rank:1},n={text:" WARN  ",rank:2},e={text:" DEBUG ",rank:3},m={text:" TRACE ",rank:4},h={text:" INFO  ",rank:5},q=m;this.trace=function(){g(m,arguments)};this.debug=function(){g(e,arguments)};this.info=function(){g(h,
arguments)};this.warn=function(){g(n,arguments)};this.error=function(){g(c,arguments)};this.fatal=function(){g(d,arguments)};this.enable=function(){l=!0};this.disable=function(){l=!1};this.setAppName=function(b){k=b};this.setLevel=function(){return{fatal:function(){q=d},error:function(){q=c},warn:function(){q=n},debug:function(){q=e},trace:function(){q=m},info:function(){q=h}}}();this.getCurrLevel=function(){return q.rank}}};
NAF.Map=function(g,l){function k(){var b=new XMLHttpRequest,a={};a.method=arguments[0];a.id=e++;a.jsonrpc=m;for(var f={},p=1;p<arguments.length;p+=2)f[arguments[p]]=arguments[p+1];a.params=f;a=JSON.stringify(a);f="/ajax?"+encodeURI(a);"undefined"!=typeof n&&""!=n&&(f="http://"+n+f);c.debug("MAP-REQ: "+a);b.open("GET",f,!1);b.setRequestHeader("Content-Type","application/json;charset=UTF-8");b.send(null);var d;try{d=JSON.parse(b.responseText)}catch(h){d={error:h,result:-1}}d.error?c.error("MAP-ERR: code="+
d.error.code+" message="+d.error.message):4>=c.getCurrLevel()?c.debug("MAP-RES: status="+b.status+" response="+b.responseText.substr(0,80)):c.debug("MAP-RES: status="+b.status+" response="+b.responseText);return d.result}function d(b,a,f){var p=a.callbackParams;delete a.callbackParams;var d=new XMLHttpRequest,h={};h.method=b;h.id=e++;h.jsonrpc=m;a&&"{}"!=JSON.stringify(a)&&(h.params=a);b=JSON.stringify(h);a="/ajax?"+encodeURI(b);"undefined"!=typeof n&&""!=n&&(a="http://"+n+a);c.debug("MAP-ASYNC-REQ: "+
b);d.open("GET",a,!0);d.setRequestHeader("Content-Type","application/json;charset=UTF-8");d.onreadystatechange=function(){if(4===d.readyState){var a;try{200==d.status?4>=c.getCurrLevel()?c.debug("MAP-ASYNC-RESPONSE: SUCCESS "+d.responseText.substr(0,200)):c.debug("MAP-ASYNC-RESPONSE: SUCCESS "+d.responseText):c.debug("MAP-ASYNC-RESPONSE: ERROR "+d.responseText),a=JSON.parse(d.responseText)}catch(b){a={error:b,result:-1}}a.error&&c.error("MAP-ERR: code="+a.error.code+" message="+a.error.message);f&&
(a.error&&(a={error:a.error.message,result:-1}),f(a.result,p));d=p=d.onreadystatechange=null}};d.send(null);a=b=h=null}var c=g.log,n=l,e=1,m="2.0",h,q=this;c.warn("***DEPRECATED key map in NAF.Map, moving to NAF.Model.KeyMap****\n");this.VK_EXIT=3;this.VK_BACK_SPACE=8;this.VK_ENTER=this.VK_OK=13;this.VK_KEYBOARD=16;this.VK_ACCEPT=30;this.VK_SPACE=32;this.VK_PAGE_UP=33;this.VK_PAGE_DOWN=34;this.VK_HOME=36;this.VK_LEFT=37;this.VK_UP=38;this.VK_RIGHT=39;this.VK_DOWN=40;this.VK_0=48;this.VK_1=49;this.VK_2=
50;this.VK_3=51;this.VK_4=52;this.VK_5=53;this.VK_6=54;this.VK_7=55;this.VK_8=56;this.VK_9=57;this.VK_A=65;this.VK_B=66;this.VK_C=67;this.VK_D=68;this.VK_E=69;this.VK_F=70;this.VK_G=71;this.VK_H=72;this.VK_I=73;this.VK_J=74;this.VK_K=75;this.VK_L=76;this.VK_M=77;this.VK_N=78;this.VK_O=79;this.VK_P=80;this.VK_Q=81;this.VK_R=82;this.VK_S=83;this.VK_T=84;this.VK_U=85;this.VK_V=86;this.VK_W=87;this.VK_X=88;this.VK_Y=89;this.VK_Z=90;this.VK_RED=403;this.VK_GREEN=404;this.VK_BLUE=406;this.VK_YELLOW=405;
this.VK_DELETE=127;this.VK_HELP=156;this.VK_POWER=409;this.VK_CHANNEL_UP=427;this.VK_CHANNEL_DOWN=428;this.VK_VOLUME_UP=447;this.VK_VOLUME_DOWN=448;this.VK_MUTE=449;this.VK_INFO=457;this.VK_GUIDE=458;this.VK_BACK=461;this.VK_MENU=462;this.VK_PAUSE=19;this.VK_REW=412;this.VK_STOP=413;this.VK_PLAY=415;this.VK_REC=416;this.VK_FF=417;this.VK_REW_SKIP=424;this.VK_FWD_SKIP=425;this.VK_FAV=433;this.VK_TELETEXT=459;this.VK_SUBTITLE=460;this.SetAsyncEventHandlers=function(b,a,f){h=new EventSource("/server-sent-events");
h.onopen=b;h.onmessage=function(b){a:{var d;try{d=JSON.parse(b.data)}catch(e){c.error("server-sent event parsing failed, event handler not invoked."+e);f("Invalid server-sent event");break a}"undefined"!==typeof d.method?a(d):(c.error("server-sent event is not a valid MW event, event handler not invoked."),f("Invalid server-sent event"))}};h.onerror=function(p){var d;switch(p.target.readyState){case EventSource.CONNECTING:d="Eventsource reconnecting.";break;case EventSource.CLOSED:d="Eventsource closed. Creating a new one.",
setTimeout(function(){q.SetAsyncEventHandlers(b,a,f)},1E4)}f(d)}};this.VidSetAnimationParameters=function(b,a,f,p,c,e){d("VidSetAnimationParameters",{windowId:b,bAnimate:a,duration:f,speed:speed,fps:c},e)};this.VidPretune=function(b,a,f){d("VidPreTune",{windowId:b,LocatorArray:a},f)};this.VidStopPretune=function(b,a,f){d("VidStopPreTune",{windowId:b},f)};this.VidGetCurChan=function(b){d("VidGetCurChan",{},b)};this.VidGetLastChan=function(b){d("VidGetLastChan",{},b)};this.VidGetStartChan=function(){return null};
this.VidDetune=function(b){d("VidDetune",{},b)};this.VidGetChanCount=function(b){d("VidGetChanCount",{},b)};this.VidGetChannelList=function(b,a){d("VidGetChannelList",{platform:b},a)};this.VidSetVideoWinSize=function(b,a,f,p,c,e){d("VidSetVideoWinSize",{x:b,y:a,w:f,h:p,bPIP:c},e)};this.VidEnableCC=function(b,a){d("VidSetCloseCap",{enable:b},a)};this.VidGetAvailableAudioLang=function(b){d("GetAvailableAudioLanguages",{},b)};this.VidSetPrefAudioLang=function(b,a,f,p){var c={};c.language=b;if(a||""!=
a)c.type=a;c.callbackParams=p;d("SetAudioLanguagePreference",c,f)};this.VidGetPrefAudioLang=function(b){d("GetAudioLanguagePreference",{},b)};this.VidSetAudioLang=function(b,a,f){var p={};p.language=b;p.callbackParams=f;d("SetAudioLanguage",p,a)};this.VidGetAudioLang=function(b){d("GetAudioLanguage",{},b)};this.VidSetResolution=function(b,a,f){d("VidSetResolution",{port:b,resolution:a},f)};this.VidGetAvailableSubtitleLang=function(b){d("GetAvailableSubtitleLanguages",{},b)};this.VidSetPrefSubtitleLang=
function(b,a,f,p){var c={};c.language=b;c.type=a;c.callbackParams=p;d("SetSubtitleLanguagePreference",c,f)};this.VidGetPrefSubtitleLang=function(b){d("GetSubtitleLanguagePreference",{},b)};this.VidGetSubtitleAvailability=function(b){d("GetSubtitleAvailability",{},b)};this.VidEnableSubtitle=function(b,a){var f={};f.enable=b;d("EnableSubtitle",f,a)};this.VidSetSubtitleLang=function(b,a,f){var p={};p.language=b;p.callbackParams=f;d("SetSubtitleLanguage",p,a)};this.VidGetSubtitleLang=function(b){d("GetSubtitleLanguage",
{},b)};this.IsSubtitleEnabled=function(b){d("IsSubtitleEnabled",{},b)};this.VidSetPrefTeletextLang=function(b,a,f,d){c.warn("VidSetPrefTeletextLang(): Not yet supported.")};this.VidGetPrefTeletextLang=function(b){c.warn("VidGetPrefTeletextLang(): Not yet supported.")};this.IsTeletextEnabled=function(b){d("IsTeletextEnabled",{},b)};this.EnableTeletext=function(b,a){d("EnableTeletext",{enable:b},a)};this.IsTeletextAvailable=function(b){d("IsTeletextAvailable",{},b)};this.VidSetTeletextLang=function(b,
a,f,d){c.warn("VidSetTeletextLang(): Not yet supported.")};this.VidGetTeletextLang=function(b){c.warn("VidGetTeletextLang(): Not yet supported.")};this.VidSpeakerMute=function(b,a){d("VidSpeakerMute",{flag:b},a)};this.VidDisplayVideoOn=function(b,a){d("VidDisplayVideoOn",{flag:b},a)};this.DlnaSetDeviceName=function(b,a){return k("MapDLNASetDeviceName","name",b,"type",a)};this.DlnaGetDeviceName=function(b){return k("MapDLNAGetDeviceName","type",b)};this.MapDLNAGetActiveDevices=function(b){return k("MapDLNAGetActiveDevices",
"type",b)};this.MapDLNAGetContainer=function(b,a,f,p,c,e,h,n){if(n)d("MapDLNAGetContainer",{id:b,containerId:a,containerType:f,filter:p,startAt:c,requestedCount:e,sort:h},n);else return k("MapDLNAGetContainer","id",b,"containerId",a,"containerType",f,"filter",p,"startAt",c,"requestedCount",e,"sort",h)};this.MapPlayer=function(b,a,f,p,c,e,h,n,m,g,k){var l={};l.type=c;l.x=e;l.y=h;l.width=n;l.height=m;c={};k&&(c.callbackParams=k);c.ver="1.0";c.url=b;c.block=a;c.rate=f;p&&(c.playPos=p);c.window=l;d("MapPlayer",
c,g)};this.MapPlayerRTSPVod=function(b,a,f,p,c,e,h,n,m,k){var g={};g.type=c;g.x=e;g.y=h;g.width=n;g.height=m;c={ver:"1.0"};c.id=b;c.block=a;c.rate=f;void 0!=p&&""!=p&&0<=p&&(c.playPos=1E3*p);c.window=g;d("MapPlayer",c,k)};this.MapPlayerStop=function(b,a,f,p,c,e){var h={};h.type=b;h.x=a;h.y=f;h.width=p;h.height=c;d("MapPlayer",{ver:"1.0",window:h},e)};this.MapPlayerSkip=function(b,a,f,p,c,e,h,n,m){var g={};g.type=p;g.x=c;g.y=e;g.width=h;g.height=n;d("MapPlayer",{ver:"1.0",url:b,rate:a,playPos:f,window:g},
m)};this.MapPlayerMakePipPrimary=function(b,a){var f={ver:"1.0"};f.url=b;f.window={type:"pip"};f.destwin={type:"main"};d("MapPlayer",f,a)};this.MapPlayerSetVideoWinSize=function(b,a,f,c,e,h,n){var m={};m.type=a;m.x=f;m.y=c;m.width=e;m.height=h;d("MapPlayer",{ver:"1.0",url:b,window:m},n)};this.DvrGetCheckPoint=function(){return k("PvrGetCheckPoint")};this.DvrSync=function(){return k("PvrSync")};this.DvrRecord=function(b,a,f,c,e,h,n,m){var g;if(0!=n){g=h?new Date(1E3*h):new Date;for(var k="",l=0;l<
n.length;l++)k=7==n[l]?"0,"+k:k+(n[l]+",");k=k.substring(0,k.length-1);g=g.getMinutes()+" "+g.getHours()+" * * "+k}d("PvrSchedRecording",{locator:b,channelId:a,duration:f,title:c,description:e,start:h,interval:g},m)};this.DvrRecordEvent=function(b){c.trace("DvrRecordEvent: "+b);return k("PvrSchedRecording","eventCrid",b)};this.DvrRecordSeries=function(b){c.trace("DvrRecordSeries: "+b);return k("PvrSchedRecording","seriesCrid",b)};this.DvrUpdateRecord=function(b,a,f){if(void 0!=a&&void 0!=f)return k("PvrUpdateRecording",
"recordingId",b,"duration",a,"start",f);if(void 0!=f)return c.warn("DvrUpdateRecord(): duration is null!!!"),k("PvrUpdateRecording","recordingId",b,"start",f);if(void 0!=a)return c.warn("DvrUpdateRecord(): startTime is null!!!"),k("PvrUpdateRecording","recordingId",b,"duration",a)};this.DvrAssetList=function(b){d("PvrListRecording",{},b)};this.DvrListRequests=function(b){if(b)d("PvrListRequests",{},b);else return k("PvrListRequests")};this.DvrListOperations=function(b){if(b)d("PvrListOperations",
{},b);else return k("PvrListOperations")};this.DvrListRecordings=function(b){if(b)d("PvrListRecordings",{},b);else return k("PvrListRecordings")};this.DvrListRequestsOperationsRecordings=function(b){if(b)d("PvrBatchCommand",{commands:["PvrListRequests","PvrListOperations","PvrListRecordings"]},b);else return k("PvrBatchCommand","commands",["PvrListRequests","PvrListOperations","PvrListRecordings"])};this.DvrGetRecords=function(b,a){if(a)d("MapPvrGetRecords",{checkPoint:b},a);else return k("MapPvrGetRecords",
"checkPoint",b)};this.DvrGetConflicts=function(b,a,f){var c={},c={opId:b};c.callbackParams=f;d("MapPvrGetConflicts",c,a)};this.DvrPause=function(b){d("PvrPlayTrick",{speed:0},b)};this.DvrResume=function(b){d("PvrPlayTrick",{speed:100},b)};this.DvrFastForward=function(b,a){d("PvrPlayTrick",{speed:b},a)};this.DvrRewind=function(b,a){d("PvrPlayTrick",{speed:-b},a)};this.DvrOffset=function(b,a){d("PvrPlaySkip",{offset:b},a)};this.DvrDelete=function(b,a){d("PvrDeleteRecording",{locator:b},a)};this.DvrDeleteAll=
function(b){d("PvrDeleteAll",{},b)};this.DvrDeleteRequest=function(b,a){d("PvrDelete",{requestId:b},a)};this.DvrDeleteOperation=function(b,a){d("PvrDelete",{operationId:b},a)};this.DvrDeleteRecording=function(b,a){d("PvrDelete",{recordingId:b},a)};this.DvrDeleteProtectOperation=function(b,a,f,c){var e={},e={operationId:b,protect:a};e.callbackParams=c;d("PvrDeleteProtect",e,f)};this.DvrPinProtectOperation=function(b,a,f,c){var e={},e={operationId:b,protect:a};e.callbackParams=c;d("PvrPinProtect",e,
f)};this.DvrDeleteProtectRequest=function(b,a,f,c){var e={},e={requestId:b,protect:a};e.callbackParams=c;d("PvrDeleteProtect",e,f)};this.DvrPinProtectRequest=function(b,a,f,c){var e={},e={requestId:b,protect:a};e.callbackParams=c;d("PvrPinProtect",e,f)};this.DvrStop=function(b){d("DvrStop",{},b)};this.PvrStop=function(b){d("PvrStop",{},b)};this.DvrStopRecording=function(b,a){d("PvrStopRecording",{recordingId:b},a)};this.VodSessionOpen=function(b,a,f){d("VodSessionOpen",{assetId:b,vodType:a},f)};this.VodSessionClose=
function(b){d("VodSessionClose",{},b)};this.VodPlay=function(b,a,f){d("VodPlay",{blocked:b,start:a},f)};this.VodPause=function(b){d("VodPause",{},b)};this.VodFastforward=function(b,a,f){d("VodFastforward",{numerator:b,denominator:a},f)};this.VodRewind=function(b,a,f){d("VodRewind",{numerator:b,denominator:a},f)};this.VodStop=function(b){d("VodStop",{},b)};this.VodGet=function(b,a){d("VodGet",{name:b},a)};this.VodSet=function(b,a,f){d("VodSet",{name:b,value:a},f)};this.VodPlaySkip=function(b,a){d("VodPlaySkip",
{offset:b},a)};this.VodResume=function(b){d("VodFastforward",{numerator:1,denominator:1},b)};this.ConfigGet=function(b,a){d("ConfigGet",{name:b},a)};this.ConfigSet=function(b,a){return k("ConfigSet","name",b,"value",a)};this.GetMWConfig=function(b,a,f){d("GetMWConfig",{section:b,key:a},f)};this.EmulateRemoteKey=function(b){return k("EmulateRemoteKey","KeyCode",b)};this.VerifyPin=function(b,a,f,c,e){var h={},h={profile:b,type:a,pin:f};h.callbackParams=e;d("VerifyPin",h,c)};this.ResetPin=function(b,
a,f,c,e,h){var n={},n={profile:b,type:a,masterpin:f,newpin:c};n.callbackParams=h;d("ResetPin",n,e)};this.GetPinState=function(b,a){d("GetPinState",{profile:b,type:a},callback)};this.ActivatePin=function(b,a,f,c){d("ActivatePin",{profile:b,type:a,masterpin:masterpin,activate:c},callback)};this.GetProfileNames=function(b,a){b()};this.ProfileSetInitChan=function(b,a,f,c){var e={};c&&(e.callbackParams=c);e.profileId=b;-1!=b.indexOf("MasterProfile")&&(e.keyword="master");e.Settings={};e.Settings.initChannel=
a;d("WriteProfile",e,f)};this.ProfileGetInitChan=function(b,a,f){var c={};f&&(c.callbackParams=f);c.profileId=b;c.Settings=["initChannel"];d("ReadProfile",c,a)};this.ProfileSetAgeRating=function(b,a,f,c){a=a?a:1001;var e={};c&&(e.callbackParams=c);e.profileId=b;-1!=b.indexOf("MasterProfile")&&(e.keyword="master");e.Settings={};e.Settings.ageRating=a;d("WriteProfile",e,f)};this.ProfileGetAgeRating=function(b,a,f){var c={};f&&(c.callbackParams=f);c.profileId=b;c.Settings=["ageRating"];d("ReadProfile",
c,a)};this.ProfileSetStartupProtection=function(b,a,f,c){var e={};c&&(e.callbackParams=c);e.profileId=b;-1!=b.indexOf("MasterProfile")&&(e.keyword="master");e.Settings={};e.Settings.startupProtection=a;d("WriteProfile",e,f)};this.ProfileGetStartupProtection=function(b,a,f){var c={};f&&(c.callbackParams=f);c.profileId=b;c.Settings=["startupProtection"];d("ReadProfile",c,a)};this.ProfileSetNeedPinForPurchase=function(b,a,f,c){var e={};c&&(e.callbackParams=c);e.profileId=b;-1!=b.indexOf("MasterProfile")&&
(e.keyword="master");e.Settings={};e.Settings.needPinForPurchase=a;d("WriteProfile",e,f)};this.ProfileGetNeedPinForPurchase=function(b,a,f){var c={};f&&(c.callbackParams=f);c.profileId=b;c.Settings=["needPinForPurchase"];d("ReadProfile",c,a)};this.SetStandbyMode=function(b,a,f,c){d("SetStandbyMode",{mode:b,time:a,callbackParams:c},f)};this.AcknowledgePowerManagerEvent=function(b){d("AcknowledgePowerManagerEvent",{},b)};this.PesGetAllEvents=function(b,a){d("GetAllEvents",{filter:b},a)};this.PesGetChannelsWithEvent=
function(b,a,f,c){d("GetChannelsWithEvent",{ChanFilter:b,ChanProps:a,EventFilter:f},c)};this.PesGetEventsByChanId=function(b,a){return k("GetEventsByChanId","chanId",b,"filter",a)};this.PesGetEventsByLcn=function(b,a){return k("GetEventsByLcn","lcn",b,"filter",a)};this.PesGetPfEventsByChanId=function(b){return k("GetPfEventsByChanId","chanId",b)};this.PesGetPfEventsByLcn=function(b){return k("GetPfEventsByLcn","lcn",b)};this.MapGetOnlineMode=function(b){d("MapGetOnlineMode",{},b)};this.writePVRProfile=
function(b,a,f,c){var e={};e.callbackParams=c;e.profileId=b;-1!=b.indexOf("MasterProfile")&&(e.keyword="master");e.Settings={};e.Settings.pvrSettings={};e.Settings.pvrSettings.frontPad=void 0!=a.newFrontPad?a.newFrontPad:a.frontPad;e.Settings.pvrSettings.backPad=void 0!=a.newBackPad?a.newBackPad:a.backPad;e.Settings.pvrSettings.seriesDomain=void 0!=a.newSeriesDomain?a.newSeriesDomain:a.seriesDomain;e.Settings.pvrSettings.diskManagement=void 0!=a.newDiskManagement?a.newDiskManagement:a.diskManagement;
d("WriteProfile",e,f)};this.readPVRProfile=function(b,a,f){var c={};f&&(c.callbackParams=f);c.profileId=b;-1!=b.indexOf("MasterProfile")&&(c.keyword="master");c.Settings=["pvrSettings"];d("ReadProfile",c,a)};this.writeViewSettingsProfile=function(b,a,f,c,e){var h={};h.callbackParams=e;h.profileId=b;-1!=b.indexOf("MasterProfile")&&(h.keyword="master");h.Settings={};h.Settings.viewSettings={};h.Settings.viewSettings.lang={};h.Settings.viewSettings.lang.code=void 0!=a.newCode?a.newCode:a.code;h.Settings.viewSettings.lang.type=
void 0!=a.newType?a.newType:a.type;h.Settings.viewSettings.transparency=void 0!=f.newTransparency?f.newTransparency:f.transparency;h.Settings.viewSettings.bannerTimeout=void 0!=f.newBannerTimeout?f.newBannerTimeout:f.bannerTimeout;h.Settings.viewSettings.epgStyle=void 0!=f.newEpgStyle?f.newEpgStyle:f.epgStyle;h.Settings.viewSettings.epgSpan=void 0!=f.newEpgSpan?f.newEpgSpan:f.epgSpan;h.Settings.viewSettings.assetsStyle=void 0!=f.newAssetsStyle?f.newAssetsStyle:f.assetsStyle;h.Settings.viewSettings.settingsProtection=
void 0!=f.newSettingsProtection?f.newSettingsProtection:f.settingsProtection;d("WriteProfile",h,c)};this.readViewSettingsProfile=function(b,a,f){var c={};f&&(c.callbackParams=f);c.profileId=b;-1!=b.indexOf("MasterProfile")&&(c.keyword="master");c.Settings=["viewSettings"];d("ReadProfile",c,a)};this.writeOutputSettingsProfile=function(b,a,f,c){var e={};e.callbackParams=c;e.profileId=b;-1!=b.indexOf("MasterProfile")&&(e.keyword="master");e.Settings={};e.Settings.outputSettings={};e.Settings.outputSettings.primary=
void 0!=a.newPrimary?a.newPrimary:a.primary;e.Settings.outputSettings.hdmi={};e.Settings.outputSettings.hdmi.resolution=void 0!=a.hdmi.newResolution?a.hdmi.newResolution:a.hdmi.resolution;e.Settings.outputSettings.hdmi.format=void 0!=a.hdmi.newFormat?a.hdmi.newFormat:a.hdmi.format;e.Settings.outputSettings.hdmi.color=void 0!=a.hdmi.newColor?a.hdmi.newColor:a.hdmi.color;e.Settings.outputSettings.hdmi.audio={};e.Settings.outputSettings.hdmi.audio.enable=void 0!=a.hdmi.audio.newEnable?a.hdmi.audio.newEnable:
a.hdmi.audio.enable;e.Settings.outputSettings.hdmi.audio.delay=void 0!=a.hdmi.audio.newDelay?a.hdmi.audio.newDelay:a.hdmi.audio.delay;e.Settings.outputSettings.spdif={};e.Settings.outputSettings.spdif.enable=void 0!=a.spdif.newEnable?a.spdif.newEnable:a.spdif.enable;e.Settings.outputSettings.spdif.delay=void 0!=a.spdif.newDelay?a.spdif.newDelay:a.spdif.delay;e.Settings.outputSettings.tv={};e.Settings.outputSettings.tv.aspectRatio=void 0!=a.tv.newAspectRatio?a.tv.newAspectRatio:a.tv.aspectRatio;e.Settings.outputSettings.tv.start=
void 0!=a.tv.newStart?a.tv.newStart:a.tv.start;e.Settings.outputSettings.scart={};e.Settings.outputSettings.scart.format=void 0!=a.scart.newFormat?a.scart.newFormat:a.scart.format;e.Settings.outputSettings.scart.color=void 0!=a.scart.newColor?a.scart.newColor:a.scart.color;e.Settings.outputSettings.scart.enable=void 0!=a.scart.newEnable?a.scart.newEnable:a.scart.enable;e.Settings.outputSettings.audio={};e.Settings.outputSettings.audio.format=void 0!=a.audio.newFormat?a.audio.newFormat:a.audio.format;
e.Settings.outputSettings.frontPanel={};e.Settings.outputSettings.frontPanel.luminosity=void 0!=a.frontPanel.newLuminosity?a.frontPanel.newLuminosity:a.frontPanel.luminosity;d("WriteProfile",e,f)};this.readOutputSettingsProfile=function(b,a,f){var c={};f&&(c.callbackParams=f);c.profileId=b;-1!=b.indexOf("MasterProfile")&&(c.keyword="master");c.Settings=["outputSettings"];d("ReadProfile",c,a)};this.VidGetTSBInfo=function(b){d("GetTSBInfo",{},b)};this.VidGetTSBEventInfo=function(b){d("GetTSBEventInfo",
{},b)};this.SubscribePlayerPosition=function(b,a){d("MAPSubscribeEvent",{name:"MWPlayerPosition",frequency:b},a)};this.UnsubscribePlayerPosition=function(b){d("MAPUnsubscribeEvent",{name:"MWPlayerPosition"},b)};this.SubscribeTSBEventInfo=function(b){d("MAPSubscribeEvent",{name:"TSBEventInfo"},b)};this.UnsubscribeTSBEventInfo=function(b){d("MAPUnsubscribeEvent",{name:"TSBEventInfo"},b)};this.AdjustUserAgeRating=function(b,a){d("AdjustUserAgeRating",{tempAgeRating:b},a)};this.RevertUserAgeRating=function(b){d("RevertUserAgeRating",
{},b)};this.GetDiagnostics=function(b){d("GetDiagnostics",{},function(a){if(b){if(a){var f={};f.caDecoder=null!=a.caDecoder?a.caDecoder:"";f.homeNetworkMode=null!=a.homeNetworkMode?a.homeNetworkMode:"";f.docsisStatus=null!=a.docsisStatus?a.docsisStatus:"";f.hw={};f.hw.hdd={};f.hw.tuners=[];if(a.hw){f.hw.hdd.available=a.hw.hdd.available;f.hw.hdd.capacity=a.hw.hdd.capacity;f.hw.hdd.temperature=a.hw.hdd.temperature;f.hw.version=a.hw.version;f.hw.interfaces=null!=a.hw.interfaces?a.hw.interfaces:"";f.hw.cm=
null!=a.hw.cm?a.hw.cm:"";for(var c=0;c<a.hw.tuners.length;c++)f.hw.tuners.push(a.hw.tuners[c])}f.ioports={};f.ioports.hdmi={};a.ioports&&(f.ioports.hdmi.hdcpStatus=a.ioports.hdmi.hdcpStatus,f.ioports.hdmi.status=a.ioports.hdmi.status,f.ioports.hdmi.tvEdid=a.ioports.hdmi.tvEdid);f.network={};f.network.docsis={};f.network.docsis.down={};f.network.docsis.up={};a.network&&(f.network.docsis.down.freq=a.network.docsis.down.freq,f.network.docsis.down.locked=a.network.docsis.down.locked,f.network.docsis.down.modulation=
a.network.docsis.down.modulation,f.network.docsis.down.snr=a.network.docsis.down.snr,f.network.docsis.down.synced=a.network.docsis.down.synced,f.network.docsis.up.freq=a.network.docsis.up.freq,f.network.docsis.up.locked=a.network.docsis.up.locked,f.network.docsis.up.modulation=a.network.docsis.up.modulation,f.network.docsis.up.power=a.network.docsis.up.power);f.ca={};a.ca&&(f.ca.caCallback=a.ca.caCallback,f.ca.ecmReception=a.ca.ecmReception,f.ca.emmReception=a.ca.emmReception,f.ca.status=a.ca.status);
f.sw={};a.sw&&(f.sw.cmVersion=a.sw.cmVersion,f.sw.lastSWUpdate=a.sw.lastSWUpdate,f.sw.version=a.sw.version);f.transportstream={};a.transportstream&&(f.transportstream.lockSignal=null!=a.transportstream.lockSignal?a.transportstream.lockSignal:"",f.transportstream.freq=null!=a.transportstream.freq?a.transportstream.freq:"",f.transportstream.modulation=null!=a.transportstream.modulation?a.transportstream.modulation:"",f.transportstream.bitRate=null!=a.transportstream.bitRate?a.transportstream.bitRate:
"",f.transportstream.nid=null!=a.transportstream.nid?a.transportstream.nid:"");f.freqscan={};a.freqscan&&(f.freqscan.tsid=null!=a.freqscan.tsid?a.freqscan.tsid:"",f.freqscan.quality=null!=a.freqscan.quality?a.freqscan.quality:0,f.freqscan.level=null!=a.freqscan.level?a.freqscan.level:0);f.chanstatus={};a.chanstatus&&(f.chanstatus.lockStatus=null!=a.chanstatus.lockStatus?a.chanstatus.lockStatus:"",f.chanstatus.ber=null!=a.chanstatus.ber?a.chanstatus.ber:"",f.chanstatus.freq=null!=a.chanstatus.freq?
a.chanstatus.freq:"",f.chanstatus.symbolRate=null!=a.chanstatus.symbolRate?a.chanstatus.symbolRate:"",f.chanstatus.modulation=null!=a.chanstatus.modulation?a.chanstatus.modulation:"",f.chanstatus.snr=null!=a.chanstatus.snr?a.chanstatus.snr:"",f.chanstatus.inversion=null!=a.chanstatus.inversion?a.chanstatus.inversion:"",f.chanstatus.quality=null!=a.chanstatus.quality?a.chanstatus.quality:0,f.chanstatus.level=null!=a.chanstatus.level?a.chanstatus.level:0);a=f}else a=null;b(a)}})};this.SendDiagMsg=function(b,
a,f){k("SendTo","method","DiagResult","targetIP",a,"result",b,"message",f)};this.SendDiagResp=function(b,a,f,c){k("QueryResult","method","DiagResult","targetIP",a,"result",b,"message",f,"dqId",c)};this.GetStandbyModeSettings=function(b){d("GetStandbyModeSettings",{},b)};this.SetStandbyModeSettings=function(b,a,f,c,e,h,n){var m={},m={autoStandby:b,timeout:a,startTime:f,endTime:c,weekday:e};n&&(m.callbackParams=n);d("SetStandbyModeSettings",m,h)};this.GetNetworks=function(b){b()};this.HideSplashScreen=
function(){};this.writePrefAudioLangs=function(b,a,f){var c={};-1!=b.indexOf("MasterProfile")&&(c.keyword="master");c.profileId=b;c.Settings={};c.Settings.prefAudioLangs={};c.Settings.prefAudioLangs=a;d("WriteProfile",c,f)};this.readPrefAudioLangs=function(b,a,f){var c={};f&&(c.callbackParams=f);-1!=b.indexOf("MasterProfile")&&(c.keyword="master");c.profileId=b;c.Settings=["prefAudioLangs"];d("ReadProfile",c,a)};this.writePrefSubtitleLangs=function(b,a,f){var c={};-1!=b.indexOf("MasterProfile")&&
(c.keyword="master");c.profileId=b;c.Settings={};c.Settings.prefSubtitleLangs={};c.Settings.prefSubtitleLangs=a;d("WriteProfile",c,f)};this.readPrefSubtitleLangs=function(b,a,f){var c={};f&&(c.callbackParams=f);-1!=b.indexOf("MasterProfile")&&(c.keyword="master");c.profileId=b;c.Settings=["prefSubtitleLangs"];d("ReadProfile",c,a)};this.writePrefTeletextLangs=function(b,a,f){var c={};-1!=b.indexOf("MasterProfile")&&(c.keyword="master");c.profileId=b;c.Settings={};c.Settings.prefTeletextLangs={};c.Settings.prefTeletextLangs=
a;d("WriteProfile",c,f)};this.readPrefTeletextLangs=function(b,a,c){var e={};c&&(e.callbackParams=c);-1!=b.indexOf("MasterProfile")&&(e.keyword="master");e.profileId=b;e.Settings=["prefTeletextLangs"];d("ReadProfile",e,a)};this.GetBootupState=function(b){b(null,"normal")};this.RemotePairing=function(b){d("MapRF4CBind",{},b)};this.RemoteUnbind=function(b,a){var c={};c.bindingId=b;d("MapRF4CUnbind",c,a)};this.RemotePairingAbort=function(b){d("MapRF4CAbortBind",{},b)};this.GetCacheUpdateStatus=function(b){d("AppGetCacheUpdateStatus",
{},b)};this.SetCacheEventListener=function(b,a){d("AppSetCacheEventListener",a,b)};this.UpdateCache=function(b){d("AppUpdateCache",{},b)};this.SwapCache=function(b){d("AppSwapCache",{},b)};this.AbortCaching=function(b){d("AppAbortCaching",{},b)};this.RemoveCacheEventListener=function(b,a){d("AppRemoveCacheEventListener",a,b)}};
pmrpc=self.pmrpc=function(){function g(){for(var a=[],b=0;36>b;b++)a[b]="0123456789ABCDEF"[Math.floor(16*Math.random())];a[14]="4";a[19]="89AB"[Math.floor(4*Math.random())];a[8]=a[13]=a[18]=a[23]="-";return a.join("")}function l(a,b){for(var c=a.whitelist,f=a.blacklist,e=!1,d=!1,h=0;h<c.length;++h)if(b.match(RegExp(c[h]))){e=!0;break}for(c=0;c<f.length;++c)if(b.match(RegExp(f[c]))){d=!0;break}return e&&!d}function k(a,b,c,f){if(!(c instanceof Array)){for(var e=a.toString(),d=e.substring(e.indexOf("(")+
1,e.indexOf(")")),d=""===d?[]:d.split(", "),e={},h=0;h<d.length;h++)e[d[h]]=h;var d=[],n;for(n in c)if("undefined"!==typeof e[n])d[e[n]]=c[n];else throw"No such param: "+n;c=d}"undefined"!==typeof f&&(c=c.concat(f));return a.apply(b,c)}function d(a,b,c){var f={jsonrpc:"2.0"};f.method=a;f.params=b;"undefined"!==typeof c&&(f.id=c);return f}function c(a,b,c){var f={};f.code=a;f.message=b;f.data=c;return f}function n(a,b,c){var f={jsonrpc:"2.0"};f.id=c;"undefined"===typeof a||null===a?f.result="undefined"===
b?null:b:f.error=a;return f}function e(a){if(a.publicProcedureName in v)return!1;t[a.publicProcedureName]={publicProcedureName:a.publicProcedureName,procedure:a.procedure,context:a.procedure.context,isAsync:"undefined"!==typeof a.isAsynchronous?a.isAsynchronous:!1,acl:"undefined"!==typeof a.acl?a.acl:{whitelist:["(.*)"],blacklist:[]}};return!0}function m(b){var c=b.event,f=b.source,e="undefined"!==typeof f&&null!==f;0===c.data.indexOf("pmrpc.")&&(b=JSON.parse(c.data.substring(6)),"undefined"!==typeof b.method?
(c={data:c.data,source:e?f:c.source,origin:e?"*":c.origin,shouldCheckACL:!e},b=h(b,c),null!==b&&a(c.source,b,c.origin)):q(b))}function h(b,f,e){if("2.0"!==b.jsonrpc)return n(c(-32600,"Invalid request.","The recived JSON is not a valid JSON-RPC 2.0 request."),null,null);var d=b.id;e=t[b.method];if("undefined"!==typeof e)if(!f.shouldCheckACL||l(e.acl,f.origin))try{if(e.isAsync)return k(e.procedure,e.context,b.params,[function(b){a(f.source,n(null,b,d),f.origin)},function(b){a(f.source,n(c(-1,"Application error.",
b.message),null,d),f.origin)},f]),null;var h=k(e.procedure,e.context,b.params,[f]);return"undefined"===typeof d?null:n(null,h,d)}catch(m){return"undefined"===typeof d?null:m.match("^(No such param)")?n(c(-32602,"Invalid params.",m.message),null,d):n(c(-1,"Application error.",m.message),null,d)}else return"undefined"===typeof d?null:n(c(-2,"Application error.","Access denied on server."),null,d);else return"undefined"===typeof d?null:n(c(-32601,"Method not found.","The requestd remote procedure does not exist or is not available."),
null,d)}function q(a){var b=a.id,c=r[b];if("undefined"!==typeof c&&null!==c)if(delete r[b],"undefined"===typeof a.error)c.onSuccess({destination:c.destination,publicProcedureName:c.publicProcedureName,params:c.params,status:"success",returnValue:a.result});else c.onError({destination:c.destination,publicProcedureName:c.publicProcedureName,params:c.params,status:"error",message:a.error.message+" "+a.error.data})}function b(a){if(a.retries&&0>a.retries)throw new Exception("number of retries must be 0 or higher");
var b=[];if("undefined"===typeof a.destination||null===a.destination||"workerParent"===a.destination)b=[{context:null,type:"workerParent"}];else if("publish"===a.destination)b=u().concat(w);else if(a.destination instanceof Array)for(var c=0;c<a.destination.length;c++)"workerParent"===a.destination[c]?b.push({context:null,type:"workerParent"}):"undefined"!==typeof a.destination[c].frames?b.push({context:a.destination[c],type:"window"}):b.push({context:a.destination[c],type:"worker"});else"undefined"!==
typeof a.destination.frames?b.push({context:a.destination,type:"window"}):b.push({context:a.destination,type:"worker"});for(c=0;c<b.length;c++){var e={destination:b[c].context,destinationDomain:"undefined"===typeof a.destinationDomain?["*"]:"string"===typeof a.destinationDomain?[a.destinationDomain]:a.destinationDomain,publicProcedureName:a.publicProcedureName,onSuccess:"undefined"!==typeof a.onSuccess?a.onSuccess:function(){},onError:"undefined"!==typeof a.onError?a.onError:function(){},retries:"undefined"!==
typeof a.retries?a.retries:5,timeout:"undefined"!==typeof a.timeout?a.timeout:500,status:"requestNotSent"};isNotification="undefined"===typeof a.onError&&"undefined"===typeof a.onSuccess;params="undefined"!==typeof a.params?a.params:[];callId=g();r[callId]=e;e.message=isNotification?d(a.publicProcedureName,params):d(a.publicProcedureName,params,callId);f(callId)}}function a(a,b,c){if("undefined"===typeof a||null===a)self.postMessage("pmrpc."+JSON.stringify(b));else{if("undefined"!==typeof a.frames)return a.postMessage("pmrpc."+
JSON.stringify(b),c);a.postMessage("pmrpc."+JSON.stringify(b))}}function f(e){var d=r[e];if("undefined"!==typeof d)if(-1>=d.retries)q(n(c(-4,"Application error.","Destination unavailable."),null,e));else if("requestSent"!==d.status)if(0===d.retries||"available"===d.status){d.status="requestSent";d.retries=-1;r[e]=d;for(var h=0;h<d.destinationDomain.length;h++)a(d.destination,d.message,d.destinationDomain[h],d),self.setTimeout(function(){f(e)},d.timeout)}else d.status="pinging",d.retries-=1,b({destination:d.destination,
publicProcedureName:"receivePingRequest",onSuccess:function(a){!0===a.returnValue&&"undefined"!==typeof r[e]&&(r[e].status="available",f(e))},params:[d.publicProcedureName],retries:0,destinationDomain:d.destinationDomain}),r[e]=d,self.setTimeout(function(){r[e]&&"pinging"===r[e].status&&f(e)},d.timeout/d.retries)}function p(a,b,c,f){"addEventListener"in a?a.addEventListener(b,c,f):a.attachEvent("on"+b,c)}function s(a,b,c){return function(f){a({event:f,source:b,destinationType:c})}}function u(){var a=
[];if("undefined"!==typeof window){a.push({context:window.top,type:"window"});for(var b=0;"undefined"!==typeof a[b];b++)for(var c=a[b],f=0;f<c.context.frames.length;f++)a.push({context:c.context.frames[f],type:"window"})}else a.push({context:this,type:"workerParent"});return a}if("undefined"===typeof JSON||"undefined"===typeof JSON.stringify||"undefined"===typeof JSON.parse)throw"pmrpc requires the JSON library";if("undefined"===typeof this.postMessage&&"undefined"===typeof this.onconnect)throw"pmrpc requires the HTML5 cross-document messaging and worker APIs";
var t={},r={},v={};if("window"in this){var x=s(m,null,"window");p(this,"message",x,!1)}else if("onmessage"in this)x=s(m,this,"worker"),p(this,"message",x,!1);else if("onconnect"in this)p(this,"connect",function(a){var b=s(m,a.ports[0],"sharedWorker");p(a.ports[0],"message",b,!1);a.ports[0].start()},!1);else throw"Pmrpc must be loaded within a browser window or web worker.";var y=this.Worker;this.nonPmrpcWorker=y;var z=this.SharedWorker;this.nonPmrpcSharedWorker=z;var w=[];this.Worker=function(a){a=
new y(a);w.push({context:a,type:"worker"});var b=s(m,a,"worker");p(a,"message",b,!1);return a};this.SharedWorker=function(a,b){var c=new z(a,b);w.push({context:c,type:"sharedWorker"});var f=s(m,c.port,"sharedWorker");p(c.port,"message",f,!1);c.postMessage=function(a,b){return c.port.postMessage(a,b)};c.port.start();return c};e({publicProcedureName:"receivePingRequest",procedure:function(a){return"undefined"!==typeof t[a]}});e({publicProcedureName:"getRegisteredProcedures",procedure:function(){var a=
[],b="undefined"!==typeof this.frames?window.location.protocol+"//"+window.location.host+(""!==window.location.port?":"+window.location.port:""):"",c;for(c in t)c in v||a.push({publicProcedureName:t[c].publicProcedureName,acl:t[c].acl,origin:b});return a}});v={getRegisteredProcedures:null,receivePingRequest:null};return{register:e,unregister:function(a){if(a in v)return!1;delete t[a];return!0},call:b,discover:function(a){var b=null;if("undefined"===typeof a.destination)for(var b=u().concat(w),c=0;c<
b.length;c++)b[c]=b[c].context;else b=a.destination;var f="undefined"===typeof a.originRegex?"(.*)":a.originRegex,e="undefined"===typeof a.nameRegex?"(.*)":a.nameRegex,d=b.length,h=[];pmrpc.call({destination:b,destinationDomain:"*",publicProcedureName:"getRegisteredProcedures",onSuccess:function(b){d--;var c=b.returnValue;b=b.destination;for(var n=0;n<c.length;n++)c[n].origin.match(RegExp(f))&&c[n].publicProcedureName.match(RegExp(e))&&h.push({publicProcedureName:c[n].publicProcedureName,destination:b,
procedureACL:c[n].acl,destinationOrigin:c[n].origin});0===d&&a.callback(h)},onError:function(b){d--;0===d&&a.callback(h)}})}}}();"function"==typeof define&&define.amd&&define(pmrpc);
WebApp.Controller=function(g){function l(a){h.trace("WebApp.Controller: received init reply");g.channels=a.returnValue[0];g.state.players=a.returnValue[1];g.state.applications=a.returnValue[2];g.initialized=!0;h.trace("WebApp.Controller: WebApp.model is initialized");k("model.initialized")}function k(a){try{h.debug("WebApp.Controller: controller.notifyView('"+a+"')"),setTimeout(function(){m.emit(a,a)},0)}catch(b){h.error("WebApp.Controller: error thrown by listener for event "+a+" - "+b),b.stack&&
h.error(b.stack)}}function d(a,b,e){void 0==e&&(e=c);b.splice(0,0,window.name);h.debug("WebApp.Controller: sending pmrpc call to master controller - "+a+"("+JSON.stringify(b)+")");pmrpc.call({destination:window.top,publicProcedureName:a,params:[b],timeout:1E4,onSuccess:e,onError:n})}function c(a){h.trace("WebApp.Controller: pmrpc message ("+a.publicProcedureName+") delivery confirmed");void 0!=a.returnValue&&(h.debug("WebApp.Controller: object returned from pmrpc message send:  "+JSON.stringify(a.returnValue)),
h.warn("WebApp.Controller: this return object is ignored"))}function n(a){h.error("WebApp.Controller: pmrpc message "+a.publicProcedureName+"("+JSON.stringify(a.params)+") send FAILED");h.error("WebApp.Controller: error status info returned: "+a.message)}var e=this;g=g?g:new WebApp.Model;var m=new WebApp.EventEmitter({wildcard:!0}),h=new NAF.utils.Log,q;q=["model.channels","model.state.players","model.state.applications"];h.enable();0===NAF.conf.debug?h.setLevel.error():1===NAF.conf.debug?h.setLevel.warn():
2===NAF.conf.debug?h.setLevel.debug():3===NAF.conf.debug?h.setLevel.trace():4===NAF.conf.debug?h.setLevel.info():h.disable();this.loadCallbacks={};this.onCallbacks={};this.onCallbacksReverseMap={};this.callbackCounter=0;this.on=function(a,b){if("model.initialized"===a||"model.state.key"===a)m.on(a,b);else{var c="on-callback-"+e.callbackCounter++;e.onCallbacks[c]=b;e.onCallbacksReverseMap[b]=c;d("on",[a,c])}};this.off=function(a,b){var c=e.onCallbacksReverseMap[b],h=[a,c];delete e.onCallbacks[c];delete e.onCallbacksReverseMap[b];
d("off",h)};this.init=function(){d("init",q,l)};this["do"]=function(a,b){if(a.match(/^model\.state\.applications\.\d+\.appMsg$/)&&b instanceof Object)if(void 0==b.sourceId){var c;try{c=e.getApplicationIndex(),b.sourceId=g.state.applications[c].id,h.debug("WebApp.Controller: supplying appMsg sourceId - "+b.sourceId+" for app #"+c)}catch(n){b.sourceId="unknown"}}else h.debug("WebApp.Controller: using webapp-supplied appMsg sourceId - "+b.sourceId);b instanceof Object&&(b.serializedObjectType=b.constructor.name,
h.debug("WebApp.Controller: serializing object type of do() argument and embedding type name - "+b.constructor.name));d("do",[a,b])};this.load=function(a,b){var c="load-callback-"+e.callbackCounter++;e.loadCallbacks[c]=b;d("load",[a,c])};this.registerPMRPC=function(){pmrpc.register({publicProcedureName:"update-model",procedure:function(a){try{h.trace("WebApp.Controller: pmrpc model update message received - "+a),g.initialized?e.UpdateModel(a):h.debug("WebApp.Controller: ignoring model update prior to completing initialization")}catch(b){h.error("WebApp.Controller: error thrown BY WEBAPP processing model update - "+
b),b.stack&&h.error(b.stack)}}});pmrpc.register({publicProcedureName:"load-callback",procedure:function(a){try{h.trace("WebApp.Controller: pmrpc load callback received - "+a),e.processLoadCallback(a)}catch(b){h.error("WebApp.Controller: error processing load callback - "+b),b.stack&&h.error(b.stack)}}});pmrpc.register({publicProcedureName:"on-callback",procedure:function(a){try{h.trace("WebApp.Controller: pmrpc 'on' callback received - "+a),e.processOnCallback(a)}catch(b){h.error("WebApp.Controller: error processing 'on' callback - "+
b),b.stack&&h.error(b.stack)}}});pmrpc.register({publicProcedureName:"off-callback",procedure:function(a){try{h.trace("WebApp.Controller: pmrpc 'off' callback received - "+a),e.processOffCallback(a)}catch(b){h.error("WebApp.Controller: error processing 'off' callback - "+b),b.stack&&h.error(b.stack)}}})};this.UpdateModel=function(a){if("key"===a[0])h.trace("WebApp.Controller: key input received - "+JSON.stringify(a[1])),g.state.key=a[1],k("model.state.key");else if("application"==a[0]){var b=g.state.applications[a[1]].inFocus;
g.state.applications[a[1]].inFocus="true"==a[2];if(g.state.applications[a[1]].inFocus)if(b){for(var b=g.state.applications,c=parseInt(a[1]),e=0;e<b.length;e++)e!==c&&(g.state.applications[e].inFocus=!1);h.trace("WebApp.Controller: focus set on app "+a[1])}else h.trace("WebApp.Controller: app "+a[1]+" already had focus");else h.trace("WebApp.Controller: focus unset on app "+a[1])}else"channels"==a[0]?(h.trace("WebApp.Controller: channel array update received"),g.channels=a[1]):"applications"==a[0]?
(h.trace("WebApp.Controller: application array update received"),g.state.applications=a[1]):"players"==a[0]?(h.trace("WebApp.Controller: player array update received"),g.state.players=a[1]):"channelTuned"==a[0]&&(h.trace("WebApp.Controller: channel tuned update received - player "+a[1]+", channel "+a[2]),b=a[1],void 0!=a[2]&&(g.state.players[b].source.idx=a[2]))};this.processLoadCallback=function(a){var b=a[0];a=a[1];void 0===e.loadCallbacks[b]?h.error("WebApp.Controller: could not identify callback with key "+
b):(e.loadCallbacks[b].apply(e,[a]),delete e.loadCallbacks[b])};this.processOnCallback=function(a){var b=a[0],c=a[1];e.storeTransmittedModelData(c,a[2]);void 0===e.onCallbacks[b]?h.error("WebApp.Controller: could not identify 'on' callback with key "+b):(h.debug("WebApp.Controller: calling proxied listener for "+c),e.onCallbacks[b].apply(e,[c]))};this.storeTransmittedModelData=function(a,b){var c=a.replace(/(\.)([0-9]+)(\.)/g,"[$2].")+" = data;";eval(c)};this.processOffCallback=function(a){var b=
a[0];a=a[1];void 0===e.offCallbacks[b]?h.error("WebApp.Controller: could not identify 'off' callback with key "+b):(e.offCallbacks[b].apply(e,[a]),delete e.offCallbacks[b])};var b=null;this.getApplicationIndex=function(a){if(null!=b)return b;for(var c=0;c<g.state.applications.length;c++)if(window.name===g.state.applications[c].windowId)return b=c;if(void 0!=a)return a;h.error("WebApp.Controller: app index queried, but no app with window name "+window.name+" currently stored in model");throw Error("no app with window name "+
window.name+" currently stored in model");}};
!function(g,l){function k(c,d,e,m){if(!e)return[];var h=[],g,b,a,f;a=d.length;f=d[m];var l=d[m+1];if(m===a&&e._listeners){if("function"===typeof e._listeners)c&&c.push(e._listeners);else for(d=0,m=e._listeners.length;d<m;d++)c&&c.push(e._listeners[d]);return[e]}if("*"===f||"**"===f||e[f]){if("*"===f){for(g in e)"_listeners"!==g&&e.hasOwnProperty(g)&&(h=h.concat(k(c,d,e[g],m+1)));return h}if("**"===f){(f=m+1===a||m+2===a&&"*"===l)&&e._listeners&&(h=h.concat(k(c,d,e,a)));for(g in e)"_listeners"!==g&&
e.hasOwnProperty(g)&&("*"===g||"**"===g?(e[g]._listeners&&!f&&(h=h.concat(k(c,d,e[g],a))),h=h.concat(k(c,d,e[g],m))):h=g===l?h.concat(k(c,d,e[g],m+2)):h.concat(k(c,d,e[g],m)));return h}h=h.concat(k(c,d,e[f],m+1))}(b=e["*"])&&k(c,d,b,m+1);if(e=e["**"])if(m<a)for(g in e._listeners&&k(c,d,e,a),e)"_listeners"!==g&&e.hasOwnProperty(g)&&(g===l?k(c,d,e[g],m+2):g===f?k(c,d,e[g],m+1):(a={},a[g]=e[g],k(c,d,{"**":a},m+1)));else e._listeners?k(c,d,e,a):e["*"]&&e["*"]._listeners&&k(c,d,e["*"],a);return h}var d=
Array.isArray?Array.isArray:function(c){return"[object Array]"===Object.prototype.toString.call(c)};WebApp.EventEmitter=function(c){this._events={};c&&(c.delimiter&&(this.delimiter=c.delimiter),c.wildcard&&(this.wildcard=c.wildcard),this.wildcard&&(this.listenerTree={}))};WebApp.EventEmitter.prototype.delimiter=".";WebApp.EventEmitter.prototype.setMaxListeners=function(c){this._events||(this._events={});this._events.maxListeners=c};WebApp.EventEmitter.prototype.event="";WebApp.EventEmitter.prototype.once=
function(c,d){this.many(c,1,d);return this};WebApp.EventEmitter.prototype.many=function(c,d,e){function g(){0===--d&&h.off(c,g);e.apply(this,arguments)}var h=this;if("function"!==typeof e)throw Error("many only accepts instances of Function");g._origin=e;this.on(c,g);return h};WebApp.EventEmitter.prototype.emit=function(){this._events||(this._events={});var c=arguments[0];if("newListener"===c&&!this._events.newListener)return!1;if(this._all){for(var d=arguments.length,e=Array(d-1),g=1;g<d;g++)e[g-
1]=arguments[g];g=0;for(d=this._all.length;g<d;g++)this.event=c,this._all[g].apply(this,e)}if("error"===c&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}var h;this.wildcard?(h=[],d="string"===typeof c?c.split(this.delimiter):c.slice(),k.call(this,h,d,this.listenerTree,0)):h=this._events[c];if("function"===typeof h){this.event=c;if(1===arguments.length)h.call(this);else if(1<
arguments.length)switch(arguments.length){case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:d=arguments.length;e=Array(d-1);for(g=1;g<d;g++)e[g-1]=arguments[g];h.apply(this,e)}return!0}if(h){d=arguments.length;e=Array(d-1);for(g=1;g<d;g++)e[g-1]=arguments[g];h=h.slice();g=0;for(d=h.length;g<d;g++)this.event=c,h[g].apply(this,e);return 0<h.length||this._all}return this._all};WebApp.EventEmitter.prototype.on=function(c,g){if("function"===typeof c)return this.onAny(c),
this;if("function"!==typeof g)throw Error("on only accepts instances of Function");this._events||(this._events={});this.emit("newListener",c,g);if(this.wildcard){a:{for(var e=c,e="string"===typeof e?e.split(this.delimiter):e.slice(),k=0,h=e.length;k+1<h;k++)if("**"===e[k]&&"**"===e[k+1])break a;k=this.listenerTree;for(h=e.shift();h;){k[h]||(k[h]={});k=k[h];if(0===e.length){k._listeners?"function"===typeof k._listeners?k._listeners=[k._listeners,g]:d(k._listeners)&&(k._listeners.push(g),k._listeners.warned||
(e=10,"undefined"!==typeof this._events.maxListeners&&(e=this._events.maxListeners),0<e&&k._listeners.length>e&&(k._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",k._listeners.length),console.trace()))):k._listeners=g;break a}h=e.shift()}}return this}this._events[c]?"function"===typeof this._events[c]?this._events[c]=[this._events[c],g]:d(this._events[c])&&(this._events[c].push(g),
this._events[c].warned||(e=10,"undefined"!==typeof this._events.maxListeners&&(e=this._events.maxListeners),0<e&&this._events[c].length>e&&(this._events[c].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[c].length),console.trace()))):this._events[c]=g;return this};WebApp.EventEmitter.prototype.onAny=function(c){this._all||(this._all=[]);if("function"!==typeof c)throw Error("onAny only accepts instances of Function");
this._all.push(c);return this};WebApp.EventEmitter.prototype.addListener=WebApp.EventEmitter.prototype.on;WebApp.EventEmitter.prototype.off=function(c,g){if("function"!==typeof g)throw Error("removeListener only takes instances of Function");var e,m=[];if(this.wildcard)e="string"===typeof c?c.split(this.delimiter):c.slice(),m=k.call(this,null,e,this.listenerTree,0);else{if(!this._events[c])return this;e=this._events[c];m.push({_listeners:e})}for(var h=0;h<m.length;h++){var l=m[h];e=l._listeners;if(d(e)){for(var b=
-1,a=0,f=e.length;a<f;a++)if(e[a]===g||e[a].listener&&e[a].listener===g||e[a]._origin&&e[a]._origin===g){b=a;break}if(0>b)break;this.wildcard?l._listeners.splice(b,1):this._events[c].splice(b,1);0===e.length&&(this.wildcard?delete l._listeners:delete this._events[c])}else if(e===g||e.listener&&e.listener===g||e._origin&&e._origin===g)this.wildcard?delete l._listeners:delete this._events[c]}return this};WebApp.EventEmitter.prototype.offAny=function(c){var d=0,e=0,g;if(c&&this._all&&0<this._all.length)for(g=
this._all,d=0,e=g.length;d<e;d++){if(c===g[d]){g.splice(d,1);break}}else this._all=[];return this};WebApp.EventEmitter.prototype.removeListener=WebApp.EventEmitter.prototype.off;WebApp.EventEmitter.prototype.removeAllListeners=function(c){if(0===arguments.length)return this._events&&(this._events={}),this;if(this.wildcard)for(var d="string"===typeof c?c.split(this.delimiter):c.slice(),d=k.call(this,null,d,this.listenerTree,0),e=0;e<d.length;e++)d[e]._listeners=null;else{if(!this._events[c])return this;
this._events[c]=null}return this};WebApp.EventEmitter.prototype.listeners=function(c){if(this.wildcard){var g=[];c="string"===typeof c?c.split(this.delimiter):c.slice();k.call(this,g,c,this.listenerTree,0);return g}this._events||(this._events={});this._events[c]||(this._events[c]=[]);d(this._events[c])||(this._events[c]=[this._events[c]]);return this._events[c]};WebApp.EventEmitter.prototype.listenersAny=function(){return this._all?this._all:[]};"function"===typeof define&&define.amd?define(function(){return WebApp.EventEmitter}):
g.EventEmitter2=WebApp.EventEmitter}("undefined"!==typeof process&&"undefined"!==typeof process.title&&"undefined"!==typeof exports?exports:"undefined"!==typeof window?window:null);
WebApp.Model=function(){var g=function(d,c){this.code=d;this.type=c},l=function(){this.applications=[];this.key=null;this.players=[]},k=function(d,c,g){this.id=d;this.sourceId=c;this.method=g;this.message={}};this.State=l;this.Application=function(d,c,g,e,m,h,l,b,a,f,p,s){this.id=d;this.name=c;this.shortSynopsis=g;this.isAdult=e;this.isViewable=m;this.isEntitled=h;this.products=[];this.pictures=[];this.url=l;this.inFocus=b;this.windowId=a;this.viewState=f;this.state=p;this.type=s;this.appMsg=new k;
this.reservedKeys=[];this.appKeys=[];this.modelSets=[];this.media={assets:[]}};this.Player=function(d,c,k,e,l,h,q,b){this.currentChannel=this.source=d;this.playRate=c;this.position=k;this.window=e;this.zIndex=l;this.duration=h;this.status=null;this.availAudioLangs=[];this.availSubtitleLangs=[];this.audioLang=new g(q,b);this.subtitleLang=new g(q,b);this.teletextLang=new g(q,b);this.restricted=this.mapLoc=null;this.isBlocked=!1};this.channels=[];this.state=new l;this.Channel=function(d,c,g,e,k,h,l,
b){this.idx=d;this.id=c;this.locator=g;this.lcn=e;this.name=k;this.pictures=h;this.viewable=l;this.isFav=!1;this.plcn=0};this.keymap=new function(){this.VK_EXIT=3;this.VK_BACK_SPACE=8;this.VK_ENTER=this.VK_OK=13;this.VK_KEYBOARD=16;this.VK_ACCEPT=30;this.VK_SPACE=32;this.VK_PAGE_UP=33;this.VK_PAGE_DOWN=34;this.VK_HOME=36;this.VK_LEFT=37;this.VK_UP=38;this.VK_RIGHT=39;this.VK_DOWN=40;this.VK_0=48;this.VK_1=49;this.VK_2=50;this.VK_3=51;this.VK_4=52;this.VK_5=53;this.VK_6=54;this.VK_7=55;this.VK_8=56;
this.VK_9=57;this.VK_A=65;this.VK_B=66;this.VK_C=67;this.VK_D=68;this.VK_E=69;this.VK_F=70;this.VK_G=71;this.VK_H=72;this.VK_I=73;this.VK_J=74;this.VK_K=75;this.VK_L=76;this.VK_M=77;this.VK_N=78;this.VK_O=79;this.VK_P=80;this.VK_Q=81;this.VK_R=82;this.VK_S=83;this.VK_T=84;this.VK_U=85;this.VK_V=86;this.VK_W=87;this.VK_X=88;this.VK_Y=89;this.VK_Z=90;this.VK_RED=403;this.VK_GREEN=404;this.VK_BLUE=406;this.VK_YELLOW=405;this.VK_DELETE=127;this.VK_HELP=156;this.VK_POWER=409;this.VK_CHANNEL_UP=427;this.VK_CHANNEL_DOWN=
428;this.VK_VOLUME_UP=447;this.VK_VOLUME_DOWN=448;this.VK_MUTE=449;this.VK_INFO=457;this.VK_GUIDE=458;this.VK_BACK=461;this.VK_MENU=462;this.VK_PAUSE=19;this.VK_REW=412;this.VK_STOP=413;this.VK_PLAY=415;this.VK_REC=416;this.VK_FF=417;this.VK_REW_SKIP=424;this.VK_FWD_SKIP=425;this.VK_FAV=433;this.VK_TELETEXT=459;this.VK_SUBTITLE=460};this.MediaAsset=function(d,c,g,e,k,h,l,b,a,f,p,s,u){this.id=d;this.name=c;this.URL=g;this.picture=e;this.type=k;this.mimeType=h;this.encoding=l;this.description=b;this.genre=
a;this.date=f;this.size=p;this.duration=s;this.ageRating=u};this.AnnouncementEvent=function(d,c,g,e,k){this.type=d;this.time=c;this.message=g;this.imageURL=e;this.timeout=k};this.Announcement=function(d,c,g,e,k){this.event=d;this.id=c;this.name=g;this.image=e;this.url=k}};