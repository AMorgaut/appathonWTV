var NDS=createPluginObject("my_user_api","my_user_api","application/x-jsuserapi-plugin"),Application=NDS.Application_getInstance&&NDS.Application_getInstance(),VideoPlayer=NDS.Player_getInstance&&NDS.Player_getInstance(),AudioPlayer=NDS.AudioOutput_getInstance&&NDS.AudioOutput_getInstance(),TVContext=NDS.ApplicationTvContext_getInstance&&NDS.ApplicationTvContext_getInstance()||NDS.ApplicationTVContext_getInstance&&NDS.ApplicationTVContext_getInstance(),User=NDS.UserAuthentication_getInstance&&NDS.UserAuthentication_getInstance(),
UserData=TVContext&&TVContext.getUserData(),Planner=NDS.Planner_getInstance&&NDS.Planner_getInstance();KeyMap.defineKeys(KeyMap.NORMAL,{403:"red",404:"green",405:"yellow",406:"blue",413:"stop",415:"playpause",417:"forward",412:"rewind",462:"menu",461:"back"},!0);
var NDSPlayer=function(){function e(a){l!==a&&(fire.call(b,"onStateChange",{state:a}),l=a)}function m(){d&&!h?(screen.log("START"),VideoPlayer.start(),5>k?(c=setTimeout(m,1E3*(5-k)),k++):(k=0,c&&(clearTimeout(c),c=null),e(Player.state.ERROR))):c&&(screen.log("STARTED"),k=0,clearTimeout(c),c=null)}function n(a){return!0}var b=this,p=Player.prototype.bounds,h=!1,f=!1,g=!1,d=null,l=null,k=0,c;b.subscribers={};VideoPlayer&&(VideoPlayer.onPlaybackStarted=function(){f&&d&&VideoPlayer&&(h=!0,screen.log("INFOLOADED"),
e(Player.state.INFOLOADED))},VideoPlayer.onPlaybackEnd=function(){f&&d&&(screen.log("EOF"),e(Player.state.EOF))},VideoPlayer.onPlaybackUnexpectedStop=function(){f&&d&&h&&(screen.log("STOPPED"),e(Player.state.STOP))},VideoPlayer.onPlaybackError=function(){f&&d&&(screen.log("ERROR"),e(Player.state.ERROR))});TVContext&&(TVContext.onContentSelectionSucceeded=function(){f||(screen.log("CHANNEL CHANGE"),fire.call(b,"onChannelChange"))});getter(b,"id",function(){return Player.TV});getter(b,"type",function(){return Player.type.VIDEO});
getter(b,"supports",function(){return n});getter(b,"waitIndicator",function(){return!1});getter(b,"channel",function(){var a=TVContext&&TVContext.getCurrentChannel()||{};return new TVChannel(a.number,a.name)});setter(b,"channel",function(a){TVContext&&TVContext.selectContentByID("service:number:"+a)});getter(b,"program",function(){var a=TVContext&&TVContext.getCurrentChannel()||{},a=a&&a.getCurrentProgram()||{};return new TVProgram(a.title,a.description,a.startTime,a.duration)});getter(b,"startTime",
function(){return 0});setter(b,"startTime",function(a){});getter(b,"currentTime",function(){try{return VideoPlayer&&VideoPlayer.position/1E3||0}catch(a){return 0}});setter(b,"currentTime",function(a){if(VideoPlayer)try{VideoPlayer.seek(1E3*a)}catch(b){}});getter(b,"rate",function(){if(h&&VideoPlayer)try{return VideoPlayer.speed||0}catch(a){return 1}else return 1});setter(b,"rate",function(a){});getter(b,"duration",function(){try{return VideoPlayer&&VideoPlayer.getPlaybackDuration()||0}catch(a){return 0}});
getter(b,"buffered",function(){return 100});getter(b,"muted",function(){try{return AudioPlayer&&!0===AudioPlayer.muted||!1}catch(a){return!1}});setter(b,"muted",function(a){if(AudioPlayer)try{AudioPlayer.mute(!0===a)}catch(b){}});getter(b,"volume",function(){if(AudioPlayer)try{return AudioPlayer.level/100}catch(a){return 1}else return 1});setter(b,"volume",function(a){if(AudioPlayer)try{AudioPlayer.setVolume(parseInt(100*a,10))}catch(b){}});getter(b,"src",function(){return f&&d});setter(b,"src",function(a){if(a&&
VideoPlayer&&!d){h=!1;l=null;g=!1;c&&(clearTimeout(c),c=null);screen.log("BUFFERING");e(Player.state.BUFFERING);if(!f)try{VideoPlayer.grab(),f=!0}catch(b){return}else if(d&&VideoPlayer.status!==VideoPlayer.PLAYER_STATUS_STOPPED)try{VideoPlayer.stop()}catch(k){}try{screen.log("LOAD"),VideoPlayer.setURI(a),d=a,m.delay(800)}catch(n){screen.log("LOAD ERROR")}}else if(d&&VideoPlayer){h=!1;l=d=null;g=!1;c&&(clearTimeout(c),c=null);if(VideoPlayer.status!==VideoPlayer.PLAYER_STATUS_STOPPED)try{VideoPlayer.stop()}catch(p){}screen.log("STOP");
e(Player.state.STOP);(function(){if(f&&!d){f=!1;try{VideoPlayer.ungrab()}catch(a){}}}).delay(800)}});getter(b,"paused",function(){return g});setter(b,"paused",function(a){if(f&&VideoPlayer)if(!1===a&&!0===g)try{VideoPlayer.status!==VideoPlayer.PLAYER_STATUS_STOPPED?VideoPlayer.resume():VideoPlayer.start(),g=!1}catch(b){}else if(!0===a&&!1===g)try{VideoPlayer.pause(),g=!0}catch(c){}screen.log(g?"PAUSED":"RESUME");e(g?Player.state.PAUSE:Player.state.PLAY)});getter(b,"bounds",function(){return VideoPlayer?
[VideoPlayer.x,VideoPlayer.y,VideoPlayer.width,VideoPlayer.height]:p});setter(b,"bounds",function(a){var b=a&&a.length||0;1<b&&VideoPlayer&&(4===b&&VideoPlayer.setSize(a[2],a[3]),VideoPlayer.move(a[0],a[1]))})};NDSPlayer.prototype=new Player;NDSPlayer.prototype.constructor=NDSPlayer;plugins.players.push(new NDSPlayer);
var NDSCOUNTRIES={eng:"en",enm:"en",ned:"nl",nld:"nl",dut:"nl",che:"ch",fre:"fr",fra:"fr",ger:"de",deu:"de",irl:"ie"},NDSLANGUAGES={ang:"en",eng:"en",enm:"en",ned:"nl",nld:"nl",dut:"nl",fre:"fr",fra:"fr",frm:"fr",fro:"fr",ger:"de",deu:"de",gmh:"de",goh:"de",ita:"it",irl:"en",gla:"en",gle:"en"},resetNDSPlayer=function(){var e=plugins.players[0];e&&(e.src="")};Application&&(Application.onHide=function(){resetNDSPlayer()});window.addEventListener("unload",function(){resetNDSPlayer()});
window.addEventListener("blur",function(){resetNDSPlayer();Application&&Application.pause()});