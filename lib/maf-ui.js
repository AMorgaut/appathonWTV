define("MAF.utility.PagerStorageClass",function(){return new MAF.Class({ClassName:"PagerStorageClass",initialize:function(){this.items=[];this.config.data&&(this.addItems([].concat(this.config.data)),this.config.data=null,delete this.config.data)},add:function(a){this.addItems(a)},addItems:function(a){this.items=this.items.concat(a||[]).unique()},remove:function(a,b){a=[].concat(a);b=!0===b?!0:!1;for(var d=0,c=a.length;d<c;d++)!1!==this.contains(a[d],b)&&this.items.splice(itemIndex,1)},contains:function(a,
b){return Object.contains(a,this.items,b)},truncate:function(){this.items=[]}})});define("MAF.utility.Pager",function(){var a={};return new MAF.Class({ClassName:"Pager",eventType:"pageDone",Protected:{filterItems:function(b){var d=[],c=a[this._classID];c.storage.remove("filter");c.allowFiltering&&(c.dataSize=0);c.storage.forEach(function(a,f){if(b&&"function"===typeOf(b)?b(a,f):a)b&&"function"===typeOf(b)?d.push(f):d[f]=f,c.allowFiltering&&c.dataSize++},this);c.storage.set("filter",d)},setData:function(){},getData:function(b,d,c){var e=a[this._classID];b=b||0;d=d||e.dataSize;c=
"function"===typeOf(this.config.filter)&&!0===c?!0:!1;var f=[];(e.storage.get("filter")||[]).slice(b,b+d).forEach(function(b,a){f.push(e.storage.get(b))},this);return f}},config:{filter:null},initialize:function(b,d,c,e,f){var g=a[this._classID]={};g.pageSize=b||1;g.fetchSize=d||48;g.loadFactor=f;g.storage=new HashMap;c?(g.fetch={func:c,obj:e},g.allowFiltering=!1):g.allowFiltering=!0},initItems:function(b,d){if(!b)return!1;var c=a[this._classID];c.curIndex=0;c.nextIndex=0;c.leftIndex=0;c.rightIndex=
0;c.paramsMap={};b.forEach(function(b,a){c.storage.set(a,b)},this);c.dataSize=d||b.length||0;this.filterItems(this.config.filter)},setFilter:function(b){var d=a[this._classID];"function"===typeOf(b)&&d.allowFiltering?(this.config.filter=b,this.filterItems(this.config.filter)):warn("Filtering needs a function or is not allowed because its set on dynamic paging.")},getItem:function(b){var d=a[this._classID];b=d.storage.get("filter")[b];return d.storage.get(b)},getItems:function(){return this.getData()},
addItems:function(b){b&&"array"===typeOf(b)&&(b=this.getItems().concat(b),this.initItems(b,b.length))},removeItems:function(b,a){var c=this.getItems();c.splice(b,a);this.initItems(c,c.length)},getPageSize:function(){return a[this._classID].pageSize||0},setPageSize:function(b){a[this._classID].pageSize=b||0},getFetchSize:function(){return a[this._classID].fetchSize||0},getItemsSize:function(){return this.getItems().length},getDataSize:function(){return a[this._classID].dataSize||0},getNumPages:function(){var b=
a[this._classID];return 0<b.dataSize?Math.ceil(b.dataSize/b.pageSize):0},getPage:function(b,d,c,e){var f=a[this._classID];b=b||0;c=c||f.pageSize||0;var g=this.getData(b,c,!0);if(g&&0<g.length)return f=new MAF.utility.PagerStorageClass({data:g}),this.fire(this.eventType,{data:f,index:b,wrap:d}),f;var h=Math.floor(b/f.fetchSize),k=Math.max(c,f.fetchSize),g=""+Date.now()+Math.random();b={index:b,wrap:d,add_index:h*f.fetchSize,page_size:c||f.pageSize,quiet:e};d={page:h,per_page:k,key:g};f.paramsMap||
(f.paramsMap={});f.paramsMap[g]=b;f.fetch&&f.fetch.func&&f.fetch.func.call(f.fetch.obj,d);return null},onGotPage:function(b,d,c){var e=a[this._classID],f=e.paramsMap[b.key];if(!f)return!1;e.paramsMap[b.key]=null;d.forEach(function(b,a){e.storage.set(f.add_index+a,b)},this);this.filterItems(this.config.filter);null!==c&&(e.dataSize=c);b=this.getData(f.index,f.page_size);b=new MAF.utility.PagerStorageClass({data:b});f.quiet||this.fire(this.eventType,{data:b,index:f.index,wrap:f.wrap});return!0},suicide:function(){delete a[this._classID]}})});define("MAF.element.Core",function(){return new MAF.Class({ClassName:"BaseCore",Implements:[Library.Storage,Library.DOM,Library.Styles],Protected:{dispatcher:function(){},initElement:function(){var a=this.config.element;a&&a.nodeType||(a=a&&a.prototype&&a.prototype.constructor?new a:new this.constructor.prototype.config.element);a.addClass(this.ClassName);this.config.ClassName&&a.addClass(this.config.ClassName);this.config.element=null;delete this.config.element;a.owner=this;this.element=a;this.proxyProperties();
this.elementEvents();this.config.id&&(this.id=this.config.id);!0===this.config.frozen&&this.freeze()},proxyProperties:function(a){a="width height visible frozen hAlign vAlign zOrder hOffset vOffset scrollLeft scrollTop".split(" ").concat(a||[]);MAF.Class.Methods.proxyProperties(this,this.element,a);var b=this.element;getter(this,"outerWidth",function(){return b.width+(b.hOffset||0)});getter(this,"outerHeight",function(){return b.height+(b.vOffset||0)});getter(this,"id",function(){return b.getAttribute("id")});
setter(this,"id",function(a){return b.setAttribute("id",a)})},elementEvents:function(a){if(a){var b=this.dispatcher.bindTo(this);[].concat(a).forEach(function(a){a=a&&a.type?a.type:a;var c=!0===a.phase;a&&this.element&&this.element.addEventListener(a,b,c)},this)}},getViewController:function(){var a=this.element;return(a=a&&a.window)&&a.owner}},config:{element:Frame},initialize:function(){this.initElement();this.children=[];this.setStyles(this.config.styles)},getView:function(){return this.getViewController()},
show:function(){this.element.visible=!0;return this},hide:function(){this.element.visible=!1;return this},freeze:function(){this.element.updatesEnabled=!1;return this},thaw:function(){this.element.updatesEnabled=!0;return this},getAbsolutePosition:function(){var a=this.hOffset,b=this.vOffset,d=this.element.window,c=this.element.parentNode;if(d&&c)for(;c&&d!==c;)a+=c.hOffset,b+=c.vOffset,c=c.parentNode;return{hOffset:a,vOffset:b}}})});define("MAF.element.Container",function(){return new MAF.Class({ClassName:"BaseContainer",Extends:MAF.element.Core,Implements:Library.Themes,Protected:{dispatcher:function(a,b){this.parent(a,b);var d=a.type;switch(d){case "navigate":this.fire("onNavigate",a.detail,a);return}this.fire("on"+d.capitalize(),b,a)},elementEvents:function(a){this.parent(["focus","blur","select","navigate"].concat(a||[]))}},initialize:function(){this.parent();this.element.wantsFocus=this.config.focus;this.config.content&&
(this.content=this.config.content,this.config.content.element?this.adopt(this.content):this.config.content.length&&this.adopt.apply(this,this.content),this.config.content=null,delete this.config.content)},focus:function(){if(this.element.hasFocus)return!0;this.element.focusable&&this.element.focus();return!0===this.element.hasFocus},suicide:function(){if(this.content){for(this.content=[].concat(this.content);this.content.length;)this.content.pop().suicide();delete this.content}this.parent()}})},{BaseGlow:{applyLayer:function(a,
b,d){if(!a.hasClass("BaseGlow"))return a.addClass("BaseGlow"),a},styles:{backgroundColor:"rgba(0,0,0,.5)"}},BaseHighlight:{applyLayer:function(a,b,d){},styles:{}},BaseFocus:{applyLayer:function(a,b,d){if(!a.hasClass("BaseFocus"))return a.addClass("BaseFocus"),a},styles:{backgroundColor:"red"}},BaseActive:{applyLayer:function(a,b,d){if(!a.hasClass("BaseActive"))return a.addClass("BaseActive"),a},styles:{backgroundColor:"rgba(255,0,0,.5)"}}});define("MAF.element.Image",function(){return new MAF.Class({ClassName:"BaseImage",Extends:MAF.element.Core,Protected:{dispatcher:function(a,b){this.parent(a,b);switch(a.type){case "load":this.fire("onLoaded",b,a);this.config.autoShow&&this.show();break;case "error":this.fire("onError",b,a),this.config.autoShow&&this.show()}},elementEvents:function(a){this.parent(["load","error"].concat(a||[]))},proxyProperties:function(a){this.parent(["source","aspect","srcWidth","srcHeight","remoteAsync"].concat(a||
[]));getter(this,"src",function(){return this.element&&this.element.source});setter(this,"src",function(b){this.element&&(this.element.source=b)})}},config:{remoteAsync:!0,element:Image,hideWhileLoading:!1,autoShow:!0,manageWaitIndicator:!1},initialize:function(){this.parent();this.remoteAsync=!1===this.config.remoteAsync?!1:!0;delete this.config.remoteAsync;this.config.aspect&&(this.aspect=this.config.aspect);this.setSources(this.config)},getSource:function(){return this.source},setSource:function(a){return this.setSources({src:a})},
setSources:function(a){a=a||{};var b=this.element,d=this.config,c=a.src||a.source;"missingSrc"in a&&(b.missingSrc=d.missingSrc=a.missingSrc);"loadingSrc"in a&&(b.loadingSrc=d.loadingSrc=a.loadingSrc);if(void 0!==c){if(""!==b.source&&c===d.src)return this;b.remoteAsync=!1===d.remoteAsync?!1:!0;d.hideWhileLoading&&this.hide();b.source=d.src=c;delete d.source}return this},aspectSizeMax:function(a){var b,d=this.srcWidth/this.srcHeight;1<=d?(b=a,a/=d):b=a*d;return this.setStyles({width:b,height:a})},aspectSizeMin:function(a){var b,
d=this.srcWidth/this.srcHeight;1<=d?b=a*d:(b=a,a/=d);return this.setStyles({width:b,height:a})},aspectSizeBestFit:function(a,b,d){var c=0;"height"===d?(c=b/this.srcHeight,a>this.srcWidth*c?this.setStyles({width:this.srcWidth*c,height:b}):(c=a/(this.srcWidth*c),this.setStyles({width:a,height:b*c}))):(c=a/this.srcWidth,b>this.srcHeight*c?this.setStyles({width:a,height:this.srcHeight*c}):(c=b/(this.srcHeight*c),this.setStyles({width:a*c,height:b})))},fitToParent:function(){var a=this.element&&this.element.parentNode;
return a?this.aspectSizeMax(Math.min(a.width,a.height)):null},fillParent:function(){var a=this.element&&this.element.parentNode;return a?this.aspectSizeMin(Math.max(a.width,a.height)):null}})});define("MAF.element.Text",function(){return new MAF.Class({ClassName:"BaseText",Extends:MAF.element.Core,Protected:{dispatcher:function(a,b){this.parent(a,b);switch(a.type){case "change":this.fire("onChange",b,a);break;case "layoutchange":this.fire("onLayoutChange",b,a)}},proxyProperties:function(a){this.parent("data text size scrolling truncation wrap font lineHeight totalLines visibleLines firstLine anchorStyle color".split(" ").concat(a||[]))}},config:{element:Text},initialize:function(){this.config.anchorStyle=
this.config.styles&&this.config.styles.anchorStyle||this.config.anchorStyle;this.config.styles&&delete this.config.styles.anchorStyle;if("wrap"in this.config||"truncation"in this.config)this.config.styles||(this.config.styles={}),this.config.styles.wrap="wrap"in this.config.styles?this.config.styles.wrap:this.config.wrap,this.config.styles.truncation="truncation"in this.config.styles?this.config.styles.truncation:this.config.truncation,delete this.config.wrap,delete this.config.truncation;this.parent();
this.config.anchorStyle&&(this.anchorStyle=this.config.anchorStyle);this.config.visibleLines&&(this.visibleLines=this.config.visibleLines);this.setText(this.config.data||this.config.text||this.config.label)},setText:function(a){this.element.data=a}})});define("MAF.element.TextField",function(){return new MAF.Class({ClassName:"BaseTextField",Extends:MAF.element.Text,Protected:{dispatcher:function(a,b){this.parent(a,b);var d=a.type;switch(d){case "navigate":this.fire("onNavigate",a.detail,a);return;case "keydown":this.fire("onKeyDown",{keyCode:a.keyCode,key:a.key,eventPhase:a.eventPhase,type:a.type},a);return;case "cursor":this.fire("onCursor",a.detail,a);return}this.fire("on"+d.capitalize(),b,a)},elementEvents:function(a){this.parent(["focus","blur",
"keydown","navigate","cursor"].concat(a||[]))},proxyProperties:function(a){this.parent(["editable"].concat(a||[]))}},config:{editable:!0},initialize:function(){this.parent();this.editable=this.config.editable}})});define("MAF.element.Button",function(){var a=function(b){this.fire(Boolean(b)?"onSelect":"onSecureFailed",null,arguments.callee.caller.__event__||null)};return new MAF.Class({ClassName:"BaseButton",Extends:MAF.element.Container,Protected:{dispatcher:function(b,d){switch(b.type){case "select":if(this.secure){var c=this.config,e=a.bindTo(this);e.__event__=b;c.verifySecure&&c.verifySecure.call?c.verifySecure.call(this,e):this.verifySecure(e);return}}this.parent(b,d)}},config:{focus:!0,secure:!1},initialize:function(){this.parent();
this.setDisabled(!1===this.config.enabled||!0===this.config.disabled);delete this.config.enabled;delete this.config.disabled;this.setSecure(this.config.secure);delete this.config.secure},generateStatePacket:function(b){return Object.merge({focused:this.element.hasFocus,disabled:this.disabled,secure:this.secure},b||{})},inspectStatePacket:function(b,a){if(!this.config.guid||b&&!(this.config.guid in b))return b;var c=b&&b[this.config.guid];"object"===typeOf(c)&&(a?c.focused&&this.focus():c&&Object.forEach(c,
function(b){switch(b){case "disabled":c[b]&&this.setDisabled(!0);break;case "secure":c[b]&&this.setSecure(!0);break;case "label":this.setText&&c[b]&&this.setText(c[b])}},this));return c},appendTo:function(b){this.parent(b)&&this.getSubscriberCount("onBroadcast")&&(b=this.getViewController())&&b.registerMessageCenterListenerControl(this);return this},setDisabled:function(b){!0===b&&!0!==this.disabled?(this.disabled=!0,this.setStyle("opacity",0.5),this.fire("onDisable"),this.fire("onChangeDisabled",
{disabled:!0})):!1===b&&!1!==this.disabled&&(this.disabled=!1,this.setStyle("opacity",null),this.fire("onEnable"),this.fire("onChangeDisabled",{disabled:!1}));this.disabled===this.element.wantsFocus&&this.config.focus&&(this.element.wantsFocus=!this.disabled);return this},toggleDisabled:function(){this.setDisabled(!this.disabled);return this},setSecure:function(b){this.secure=b=!0===b;this.fire("onChangeSecure",{secure:b});return this},toggleSecure:function(){return this.setSecure(!this.secure)},
verifySecure:function(b){b(!0)}})});define("MAF.element.GridCell",function(){return new MAF.Class({ClassName:"BaseGridCell",Extends:MAF.element.Container,getCellDimensions:function(){return this.grid&&this.grid.getCellDimensions()},getCellCoordinates:function(){return this.grid&&this.grid.getCellCoordinates(this)},getCellIndex:function(){return this.grid&&this.grid.getCellIndex(this)},getCellDataIndex:function(){return this.grid&&this.grid.getCellDataIndex(this)},getCellDataItem:function(){return this.grid&&this.grid.getCellDataItem(this)},
suicide:function(){delete this.grid;Object.forEach(this,function(a,b){"owner"!==a&&("instance"===typeOf(b)&&b.suicide&&b!==this)&&(delete this[a],b.suicide())},this);this.parent()}})});define("MAF.element.Grid",function(){var a=function(b,a){var c=a%this.config.columns,e=Math.floor(a/this.config.columns);0<c&&(b.hOffset=b.width*c);0<e&&(b.vOffset=b.height*e);return b};return new MAF.Class({ClassName:"BaseGrid",Extends:MAF.element.Container,Protected:{generateCells:function(b,d){if(0<b&&0===this.cells.length){for(var c=createDocumentFragment(),e=this.getCellDimensions(),f=0;f<b;f++){var g=this.config.cellCreator.call(this).setStyles(e);g.grid=this;c.appendChild(a.call(this,g,f).element);
this.cells.push(g)}this.body.element.appendChild(c)}return this.cells.length},updateWaitIndicator:function(){},updateState:function(b){this._state=Object.merge(this._state,b||{});this.fire("onStateUpdated",this._state);return this._state},handleFocusEvent:function(b){if(!1===this.element.allowNavigation)b.preventDefault();else{var a=this._state.focusCoordinates||{row:0,column:0},c=this.element.currentNavigation||"down";switch(b.type){case "onFocus":switch(c){case "up":a.row=this.config.rows-1;break;
case "down":a.row=0}this.focusCell(a);break;case "onBlur":this.blurCell(a)}}},handleSelectEvent:function(b){b=this.getCellIndex(this._state.focusCoordinates||-1);var a=-1<b?this.cells[b]:!1,c=a&&this.getCellDataIndex(a),e=a&&this.getCellDataItem(a);a&&a.fire("onSelect",{cellIndex:b,dataIndex:c,dataItem:e})},handleNavEvent:function(b){var a=b.payload.direction,c=this.config.carousel,e=!1,f=!1,g=this._state,h=g.currentPage||0,k=Math.max(0,this.getPageCount()-1),m=g.dataLength,p="horizontal"==this.config.orientation,
n=g.focusCoordinates||{},l={row:n.row||0,column:n.column||0},r=this.pager._dataSize,q=Math.ceil(m/this.config.columns);switch(a){case "left":if(p)if(0===l.column){if(h||c)f=!0,l.column=this.config.columns-1}else l.column--;else 0===l.column?e=!0:l.column-=1;break;case "right":if(p)if(l.column==this.config.columns-1){if(h<k||c)f=!0,l.column=0}else l.column++;else n.column===this.config.columns-1?e=!0:l.column+=1;break;case "up":if(p)0===l.row?e=!0:l.row--;else if(m=Math.ceil(r/this.config.columns)%
this.config.rows,m=0===m?this.config.rows-1:m-1,0===l.row){if(h||c)f=!0,l.row=0===h&&c?m:this.config.rows-1}else l.row-=1;break;case "down":if(p)l.row==this.config.rows-1?e=!0:l.row++;else if(p=r%(this.config.columns*this.config.rows),p=0!==p?p:this.config.columns,q<l.row+2&&(l.row=this.config.rows-1),l.row===this.config.rows-1){if(h<k||c)f=!0,l.row=0,h===k-1&&n.column+1>p&&(l.column=p-1)}else c=m%this.config.columns,m-(n.row+1)*this.config.columns<this.config.columns&&n.column+1>c&&(l.column=c-1),
l.row=n.row+1}this.getVisibleCellCount()||(e=!0);if(f&&!g.animating)this.shift(a,{focus:l}),b.preventDefault();else if(e)this.releaseFocus(a,b);else if(l.column==n.column&&l.row==n.row)b.preventDefault();else if(e=this.getCellIndex(l),-1<e&&this.cells[e]&&!this.cells[e].frozen&&this.cells[e].visible)b.preventDefault(),this.focusCell(l,b);else switch(a){case "right":if(!l.row){l.column=0;this.shift(a,{focus:l});break}l.row-=1;b.preventDefault();this.focusCell(l,b);break;case "down":f=!1;for(g=l.column;g;g--)l.column-=
1,e=this.getCellIndex(l),-1!==e&&(this.cells[e]&&!this.cells[e].frozen&&this.cells[e].visible)&&(b.preventDefault(),this.focusCell(l,b),f=!0);f&&this.releaseFocus(a,b)}},onDataPage:function(b){var a=this._state.pageRequested,c=this.config.cellUpdater,e=b.payload;b=b.type;var f=e&&e.index;if(e&&b===this.pager.eventType&&e.data&&a&&f===a.index){var g=e.data.items&&e.data.items.length&&[].concat(e.data.items)||[],h=g.length;this._state.dataLength=h;this.config.focus&&(this.element.wantsFocus=0===h?!1:
!0);void 0===this._state.focusIndex&&(this._state.focusIndex=-1);this.body.freeze();0<this.generateCells(h)&&this.cells.forEach(function(b,a){a<h?(b.thaw(),c.call(this,b,g[a])):b.freeze()},this);this.body.thaw();this.updateState({startIndex:a.index,currentPage:a.index/this.getCellCount()});e=a.options.focus;b=this.getCellIndex(e);if(e)for(f=this.cells.length;b>=h&&f;){switch(a.options.direction){case "right":e.column&&e.row?e.row-=1:e.row?(e.row-=1,e.column=this.config.columns-1):e.column-=1;b=this.getCellIndex(e);
break;case "left":e.row=Math.max(0,e.row-1);b=this.getCellIndex(e);break;case "up":e.column=Math.max(0,e.column-1);b=this.getCellIndex(e);break;case "down":e.row&&e.column?e.column-=1:e.column?(e.row-=1,e.column=this.config.row-1):e.row-=1;b=this.getCellIndex(e);break;default:b--,b=this.getCellIndex(b)}f--}this.fire("onPageChanged",this.updateState({pageChanging:!1}));void 0!==b&&-1<b&&this.focusCell(b)}}},config:{rows:1,columns:1,orientation:"horizontal",carousel:!1,inverted:!1,render:!0,focus:!0,
manageWaitIndicator:!1,animate:!1,animation:{duration:400,transition:"slide",direction:"left",ease:0}},initialize:function(){this.config.orientation="vertical"===this.config.orientation?"vertical":"horizontal";this.config.rows=this.config.rows||1;this.config.columns=this.config.columns||1;this.parent();this.cells=[];if(this.config.pager)this.pager=this.config.pager,delete this.config.pager;else{var b=this.config.dataset||this.config.dataSet||[],a=this.config.rows*this.config.columns;this.pager=new MAF.utility.Pager(a,
this.config.payloadSize||a);this.pager.initItems(b,b.length)}this.body=(new MAF.element.Core({styles:{width:this.width||"inherit",height:this.height||"inherit"}})).appendTo(this);this.generateCells(Math.min(this.pager.getDataSize(),this.pager.getPageSize()));this.onDataPage.subscribeTo(this.pager,this.pager.eventType,this);this.updateWaitIndicator.subscribeTo(this,["onChangePage","onPageChanged"],this);this.handleFocusEvent.subscribeTo(this,["onFocus","onBlur"],this);this.handleSelectEvent.subscribeTo(this,
"onSelect",this);this.handleNavEvent.subscribeTo(this,"onNavigate",this);this._state={};this.config.render&&(b=this.config.state||{},a={transition:"none"},b.focusCoordinates&&(a.focus=b.focusCoordinates),this.changePage(b.currentPage||0,a));delete this.config.state;delete this.config.dataset;delete this.config.dataSet;0===this.getVisibleCellCount()&&(this.element.wantsFocus=!1)},setFilter:function(b){this.pager&&(this.pager.setFilter(b),this.changePage(0))},appendTo:function(b){this.parent(b)&&this.getSubscriberCount("onBroadcast")&&
(b=this.getViewController())&&b.registerMessageCenterListenerControl(this);return this},changeDataset:function(b,a,c){b=b&&b.length?b:[];c=c&&c>b.length?c:b.length;this.pager.initItems(b,c);a&&(this._state.focusCoordinates={row:null,column:null});b=this._state;this.changePage(a?0:this._state.currentPage||0,{transition:"none",refresh:!0,focus:this.element.hasFocus&&b.focusCoordinates});this.fire("onDatasetChanged");return this},getDataItem:function(b){return this.pager.getItem(b)},getState:function(){return clone(this._state)},
releaseFocus:function(b,a){return!0},shift:function(b,a){var c=!1,e=this._state.currentPage||0,f=Math.max(0,this.pager.getNumPages()-1),g=this.config.carousel;a=a||{};switch(b){case "first":c=0;a.direction=g&&e>f/2?"right":"left";break;case "last":c=f;a.direction=g&&e>f/2?"right":"left";break;case "up":c=g?e-1:Math.max(e-1,0);a.direction="up";break;case "down":c=g?e+1:Math.min(e+1,f);a.direction="down";break;case "left":c=g?e-1:Math.max(e-1,0);a.direction="right";break;case "right":c=g?e+1:Math.min(e+
1,f),a.direction="left"}!1!==c&&this.changePage(c,a)},changePage:function(b,a){var c=this.getCellCount(),c=this.normalizeIndex((b||0)*c);if(b!==this._state.currentPage||!a||a.refresh){var e=this.updateState({pageRequested:{index:c,options:a||{}},pageChanging:!0});this.fire("onChangePage",e);this.pager.getPage(c)}},normalizeIndex:function(b){var a=this.pager.getPageSize(),c=this.pager.getDataSize(),e=Math.ceil(c/a),f=e*a,g=this.config.carousel;b=isNaN(b)?0:b;return a>=c?0:b>=c?g?Math.floor(b%f/a)*
a:e*a:0>b?g?Math.floor((b%f+f)%f/a)*a:0:Math.floor(b/a)*a},getCellCount:function(){return this.config.rows*this.config.columns},getVisibleCellCount:function(){return this.cells&&this.cells.filter(function(b){return b&&!b.frozen}).length||this.cells.length},getPageCount:function(){return this.pager.getNumPages()},getCurrentPage:function(){return this._state.currentPage},getStartIndex:function(){return this._state.startIndex},getFocusIndex:function(){return this._state.focusIndex},getFocusCoordinates:function(){return this._state.focusCoordinates},
focusCell:function(b){var a=this._state.focusIndex;b=this.getCellIndex(b||{row:0,column:0});var c=this.getVisibleCellCount();if(c&&-1!==b&&this.element&&this.element.hasFocus)return b=Math.min(c-1,b),a!=b&&this.blurCell(a),-1<b&&this.cells[b].fire("onFocus"),a=this.getCellCoordinates(b),this.updateState({focusIndex:b,focusCoordinates:{row:a.row,column:a.column}}),this},blurCell:function(b){b=-1<parseInt(b,10)?b:this._state.focusCoordinates;b=this.getCellIndex(b);-1<b&&this.cells[b]&&this.cells[b].fire("onBlur");
return this},getCellDimensions:function(){return{width:Math.floor(this.body.width/this.config.columns),height:Math.floor(this.body.height/this.config.rows)}},getCellCoordinates:function(b){var a=this.cells.indexOf(b);try{-1==a&&(a=parseInt(b,10))}catch(c){}return-1==a?!1:{row:Math.floor(a/this.config.columns),column:a%this.config.columns,rows:this.config.rows,columns:this.config.columns}},getCellIndex:function(b,a){var c=this.cells.indexOf(b),e=this.config.columns;if(-1<parseInt(c,10))return c;"object"===
typeOf(b)?"row"in b&&"column"in b&&(c=(b.row||0)*e+(b.column||0)):-1<parseInt(a,10)?c=b*e+a:-1<parseInt(b,10)&&(c=b);return-1<c?c:-1},getCellDataIndex:function(b){var a=this._state,a=a.pageRequested&&a.pageRequested.index;b=this.getCellIndex(b);return-1<parseInt(a,10)&&-1<b?a+b:!1},getCellDataItem:function(b){b=this.getCellDataIndex(b);return-1<parseInt(b,10)&&this.pager.getItem(b)},attachAccessory:function(b){b&&b.attachToSource&&b.attachToSource(this);return this},attachAccessories:function(){Array.slice(arguments).forEach(this.attachAccessory,
this);return this},inspectStatePacket:function(b,a){if(!this.config.guid||b&&!(this.config.guid in b))return b;var c=b&&b[this.config.guid],e=typeof c;if("null"==e||"undefined"==e)return b;a?c.focused&&(this.getVisibleCellCount()?this.focus():(e=this.getView())&&e.resetFocus()):"object"==e&&c.state&&this.changePage(c.state.currentPage||0,{transition:"none",focus:!1});return c},generateStatePacket:function(b){return Object.merge({state:this._state,focused:this.element.hasFocus},b||{})},suicide:function(){for(;this.cells.length;)this.cells.pop().suicide();
delete this.cells;this.body.suicide();delete this.body;delete this.pager;delete this._state;this.parent()}})});define("MAF.element.TextGrid",function(){return new MAF.Class({ClassName:"BaseTextGrid",Extends:MAF.element.Text,Protected:{dispatcher:function(a,b){"layoutchange"===a.type&&this.fire("onStateUpdated",{currentPage:this.getCurrentPage(),pageCount:this.getPageCount()},a);this.parent(a,b)},elementEvents:function(a){this.parent(["change","layoutchange"].concat(a||[]))}},initialize:function(){this.parent();this.element.allowChangeEvents=!0},getCurrentPage:function(){return Math.round(this.getPageCount()*
this.firstLine/this.totalLines)},getPageCount:function(){return Math.ceil(this.totalLines/this.visibleLines)},getStartLine:function(a){return a*this.visibleLines},shift:function(a){var b=this.getCurrentPage(),d=this.getPageCount(),c;switch(a){case "left":c=Math.max(b-1,0);break;case "right":c=Math.min(b+1,d-1)}this.firstLine=this.getStartLine(c);return this},attachAccessory:function(a){a&&a.attachToSource&&a.attachToSource(this);return this},attachAccessories:function(){Array.slice(arguments).forEach(this.attachAccessory,
this);return this},setText:function(a){this.freeze();this.firstLine=0;this.parent(a);this.thaw()}})});define("MAF.element.Carousel",function(){return new MAF.Class({})});define("MAF.element.CarouselCell",function(){return new MAF.Class({})});define("MAF.keyboard.ReuseKeyboard",function(a){var b={Tables:{CharacterDefinitions:{"char-a":{label:"a",value:"a",unicode:"a"},"char-A":{label:"A",value:"A",unicode:"A"},"char-agrave":{label:"\u00e0",value:"\u00e0",unicode:"\u00e0"},"char-aacute":{label:"\u00e1",value:"\u00e1",unicode:"\u00e1"},"char-acirc":{label:"\u00e2",value:"\u00e2",unicode:"\u00e2"},"char-auml":{label:"\u00e4",value:"\u00e4",unicode:"\u00e4"},"char-aring":{label:"\u00e5",value:"\u00e5",unicode:"\u00e5"},"char-atilde":{label:"\u00e3",
value:"\u00e3",unicode:"\u00e3"},"char-Agrave":{label:"\u00c0",value:"\u00c0",unicode:"\u00c0"},"char-Aacute":{label:"\u00c1",value:"\u00c1",unicode:"\u00c1"},"char-Acirc":{label:"\u00c2",value:"\u00c2",unicode:"\u00c2"},"char-Auml":{label:"\u00c4",value:"\u00c4",unicode:"\u00c4"},"char-Aring":{label:"\u00c5",value:"\u00c5",unicode:"\u00c5"},"char-Atilde":{label:"\u00c3",value:"\u00c3",unicode:"\u00c3"},"char-aelig":{label:"\u00e6",value:"\u00e6",unicode:"\u00e6"},"char-AElig":{label:"\u00c6",value:"\u00c6",
unicode:"\u00c6"},"char-b":{label:"b",value:"b",unicode:"b"},"char-B":{label:"B",value:"B",unicode:"B"},"char-c":{label:"c",value:"c",unicode:"c"},"char-C":{label:"C",value:"C",unicode:"C"},"char-ccedil":{label:"\u00e7",value:"\u00e7",unicode:"\u00e7"},"char-Ccedil":{label:"\u00c7",value:"\u00c7",unicode:"\u00c7"},"char-d":{label:"d",value:"d",unicode:"d"},"char-D":{label:"D",value:"D",unicode:"D"},"char-e":{label:"e",value:"e",unicode:"e"},"char-E":{label:"E",value:"E",unicode:"E"},"char-egrave":{label:"\u00e8",
value:"\u00e8",unicode:"\u00e8"},"char-eacute":{label:"\u00e9",value:"\u00e9",unicode:"\u00e9"},"char-ecirc":{label:"\u00ea",value:"\u00ea",unicode:"\u00ea"},"char-euml":{label:"\u00eb",value:"\u00eb",unicode:"\u00eb"},"char-Egrave":{label:"\u00c8",value:"\u00c8",unicode:"\u00c8"},"char-Eacute":{label:"\u00c9",value:"\u00c9",unicode:"\u00c9"},"char-Ecirc":{label:"\u00ca",value:"\u00ca",unicode:"\u00ca"},"char-Euml":{label:"\u00cb",value:"\u00cb",unicode:"\u00cb"},"char-f":{label:"f",value:"f",unicode:"f"},
"char-F":{label:"F",value:"F",unicode:"F"},"char-g":{label:"g",value:"g",unicode:"g"},"char-G":{label:"G",value:"G",unicode:"G"},"char-h":{label:"h",value:"h",unicode:"h"},"char-H":{label:"H",value:"H",unicode:"H"},"char-i":{label:"i",value:"i",unicode:"i"},"char-I":{label:"I",value:"I",unicode:"I"},"char-igrave":{label:"\u00ec",value:"\u00ec",unicode:"\u00ec"},"char-iacute":{label:"\u00ed",value:"\u00ed",unicode:"\u00ed"},"char-icirc":{label:"\u00ee",value:"\u00ee",unicode:"\u00ee"},"char-iuml":{label:"\u00ef",
value:"\u00ef",unicode:"\u00ef"},"char-Igrave":{label:"\u00cc",value:"\u00cc",unicode:"\u00cc"},"char-Iacute":{label:"\u00cd",value:"\u00cd",unicode:"\u00cd"},"char-Icirc":{label:"\u00ce",value:"\u00ce",unicode:"\u00ce"},"char-Iuml":{label:"\u00cf",value:"\u00cf",unicode:"\u00cf"},"char-j":{label:"j",value:"j",unicode:"j"},"char-J":{label:"J",value:"J",unicode:"J"},"char-k":{label:"k",value:"k",unicode:"k"},"char-K":{label:"K",value:"K",unicode:"K"},"char-l":{label:"l",value:"l",unicode:"l"},"char-L":{label:"L",
value:"L",unicode:"L"},"char-m":{label:"m",value:"m",unicode:"m"},"char-M":{label:"M",value:"M",unicode:"M"},"char-n":{label:"n",value:"n",unicode:"n"},"char-N":{label:"N",value:"N",unicode:"N"},"char-ntilde":{label:"\u00f1",value:"\u00f1",unicode:"\u00f1"},"char-Ntilde":{label:"\u00d1",value:"\u00d1",unicode:"\u00d1"},"char-o":{label:"o",value:"o",unicode:"o"},"char-O":{label:"O",value:"O",unicode:"O"},"char-ograve":{label:"\u00f2",value:"\u00f2",unicode:"\u00f2"},"char-oacute":{label:"\u00f3",value:"\u00f3",
unicode:"\u00f3"},"char-ocirc":{label:"\u00f4",value:"\u00f4",unicode:"\u00f4"},"char-ouml":{label:"\u00f6",value:"\u00f6",unicode:"\u00f5"},"char-oslash":{label:"\u00f8",value:"\u00f8",unicode:"\u00f8"},"char-otilde":{label:"\u00f5",value:"\u00f5",unicode:"\u00f6"},"char-Ograve":{label:"\u00d2",value:"\u00d2",unicode:"\u00d2"},"char-Oacute":{label:"\u00d3",value:"\u00d3",unicode:"\u00d3"},"char-Ocirc":{label:"\u00d4",value:"\u00d4",unicode:"\u00d4"},"char-Ouml":{label:"\u00d6",value:"\u00d6",unicode:"\u00d5"},
"char-Oslash":{label:"\u00d8",value:"\u00d8",unicode:"\u00d8"},"char-Otilde":{label:"\u00d5",value:"\u00d5",unicode:"\u00d6"},"char-oelig":{label:"\u0153",value:"\u0153",unicode:"\u0153"},"char-OElig":{label:"\u0152",value:"\u0152",unicode:"\u0152"},"char-p":{label:"p",value:"p",unicode:"p"},"char-P":{label:"P",value:"P",unicode:"P"},"char-q":{label:"q",value:"q",unicode:"q"},"char-Q":{label:"Q",value:"Q",unicode:"Q"},"char-r":{label:"r",value:"r",unicode:"r"},"char-R":{label:"R",value:"R",unicode:"R"},
"char-s":{label:"s",value:"s",unicode:"s"},"char-S":{label:"S",value:"S",unicode:"S"},"char-t":{label:"t",value:"t",unicode:"t"},"char-T":{label:"T",value:"T",unicode:"T"},"char-u":{label:"u",value:"u",unicode:"u"},"char-U":{label:"U",value:"U",unicode:"U"},"char-ugrave":{label:"\u00f9",value:"\u00f9",unicode:"\u00f9"},"char-uacute":{label:"\u00fa",value:"\u00fa",unicode:"\u00fa"},"char-ucirc":{label:"\u00fb",value:"\u00fb",unicode:"\u00fb"},"char-uuml":{label:"\u00fc",value:"\u00fc",unicode:"\u00fc"},
"char-Ugrave":{label:"\u00d9",value:"\u00d9",unicode:"\u00d9"},"char-Uacute":{label:"\u00da",value:"\u00da",unicode:"\u00da"},"char-Ucirc":{label:"\u00db",value:"\u00db",unicode:"\u00db"},"char-Uuml":{label:"\u00dc",value:"\u00dc",unicode:"\u00dc"},"char-v":{label:"v",value:"v",unicode:"v"},"char-V":{label:"V",value:"V",unicode:"V"},"char-w":{label:"w",value:"w",unicode:"w"},"char-W":{label:"W",value:"W",unicode:"W"},"char-x":{label:"x",value:"x",unicode:"x"},"char-X":{label:"X",value:"X",unicode:"X"},
"char-y":{label:"y",value:"y",unicode:"y"},"char-Y":{label:"Y",value:"Y",unicode:"Y"},"char-yuml":{label:"\u00ff",value:"\u00ff",unicode:"\u00ff"},"char-yacute":{label:"\u00fd",value:"\u00fd",unicode:"\u00fd"},"char-Yacute":{label:"\u00dd",value:"\u00dd",unicode:"\u00dd"},"char-z":{label:"z",value:"z",unicode:"z"},"char-Z":{label:"Z",value:"Z",unicode:"Z"},"char-eth":{label:"\u00f0",value:"\u00f0",unicode:"\u00f0"},"char-thorn":{label:"\u00fe",value:"\u00fe",unicode:"\u00fe"},"char-ETH":{label:"\u00d0",
value:"\u00d0",unicode:"\u00d0"},"char-THORN":{label:"\u00de",value:"\u00de",unicode:"\u00de"},"char-szlig":{label:"\u00df",value:"\u00df",unicode:"\u00df"},"char-scaron":{label:"\u0161",value:"\u0161",unicode:"\u0161"},"char-Scaron":{label:"\u0160",value:"\u0160",unicode:"\u0160"},"char-excl":{label:"!",value:"!",unicode:"!"},"char-iexcl":{label:"\u00a1",value:"\u00a1",unicode:"\u00a1"},"char-quest":{label:"?",value:"?",unicode:"?"},"char-iquest":{label:"\u00bf",value:"\u00bf",unicode:"\u00bf"},
"char-dollar":{label:"$",value:"$",unicode:"$"},"char-euro":{label:"\u20ac",value:"\u20ac",unicode:"\u20ac"},"char-pound":{label:"\u00a3",value:"\u00a3",unicode:"\u00a3"},"char-yen":{label:"\u00a5",value:"\u00a5",unicode:"\u00a5"},"char-atsign":{label:"@",value:"@",unicode:"@"},"char-colon":{label:":",value:":",unicode:":"},"char-semicolon":{label:";",value:";",unicode:";"},"char-caret":{label:"^",value:"^",unicode:"^"},"char-lt":{label:"<",value:"<",unicode:"<"},"char-gt":{label:">",value:">",unicode:">"},
"char-equal":{label:"=",value:"=",unicode:"="},"char-number":{label:"#",value:"#",unicode:"#"},"char-apos":{label:"'",value:"'",unicode:"'"},"char-quot":{label:'"',value:'"',unicode:'"'},"char-amp":{label:"&",value:"&",unicode:"&"},"char-lparen":{label:"(",value:"(",unicode:"("},"char-rparen":{label:")",value:")",unicode:")"},"char-lcurly":{label:"{",value:"{",unicode:"{"},"char-rcurly":{label:"}",value:"}",unicode:"}"},"char-lsquare":{label:"[",value:"[",unicode:"["},"char-rsquare":{label:"]",value:"]",
unicode:"]"},"char-vertline":{label:"|",value:"|",unicode:"|"},"char-grave":{label:"`",value:"`",unicode:"`"},"char-tilde":{label:"~",value:"~",unicode:"~"},"char-asterisk":{label:"*",value:"*",unicode:"*"},"char-comma":{label:",",value:",",unicode:","},"char-hyphen":{label:"-",value:"-",unicode:"-"},"char-underscore":{label:"_",value:"_",unicode:"_"},"char-period":{label:".",value:".",unicode:"."},"char-plus":{label:"+",value:"+",unicode:"+"},"char-percent":{label:"%",value:"%",unicode:"%"},"char-divide":{label:"\u00f7",
value:"\u00f7",unicode:"\u00f7"},"char-doubledagger":{label:"\u2021",value:"\u2021",unicode:"\u2021"},"char-degree":{label:"\u00b0",value:"\u00b0",unicode:"\u00b0"},"char-bullet":{label:"\u2022",value:"\u2022",unicode:"\u2022"},"char-ellipsis":{label:"\u2026",value:"\u2026",unicode:"\u2026"},"char-slash":{label:"/",value:"/",unicode:"/"},"char-backslash":{label:"\\",value:"\\",unicode:"\\"},"digit-0":{label:"0",value:"0",unicode:"0"},"digit-1":{label:"1",value:"1",unicode:"1"},"digit-2":{label:"2",
value:"2",unicode:"2"},"digit-3":{label:"3",value:"3",unicode:"3"},"digit-4":{label:"4",value:"4",unicode:"4"},"digit-5":{label:"5",value:"5",unicode:"5"},"digit-6":{label:"6",value:"6",unicode:"6"},"digit-7":{label:"7",value:"7",unicode:"7"},"digit-8":{label:"8",value:"8",unicode:"8"},"digit-9":{label:"9",value:"9",unicode:"9"},"char-space":{label:"space",value:" ",unicode:" "},"numpad-0":{label:"0",sublabel:"",value:"0"},"numpad-1":{label:"1",sublabel:"",value:"1"},"numpad-2":{label:"2",sublabel:"abc",
value:"2"},"numpad-3":{label:"3",sublabel:"def",value:"3"},"numpad-4":{label:"4",sublabel:"ghi",value:"4"},"numpad-5":{label:"5",sublabel:"jkl",value:"5"},"numpad-6":{label:"6",sublabel:"mno",value:"6"},"numpad-7":{label:"7",sublabel:"pqrs",value:"7"},"numpad-8":{label:"8",sublabel:"tuv",value:"8"},"numpad-9":{label:"9",sublabel:"wxyz",value:"9"}},KeyDefinitions:{"key-a":{normal:"char-a",shift:"char-A",extended:"char-a char-agrave char-aacute char-acirc char-auml char-aring char-aelig".split(" "),
shiftextended:"char-A char-Agrave char-Aacute char-Acirc char-Auml char-Aring char-AElig".split(" ")},"key-b":{normal:"char-b",shift:"char-B"},"key-c":{normal:"char-c",shift:"char-C",extended:["char-c","char-ccedil"],shiftextended:["char-C","char-Ccedil"]},"key-d":{normal:"char-d",shift:"char-D",extended:["char-d","char-eth","char-thorn"],shiftextended:["char-D","char-ETH","char-THORN"]},"key-e":{normal:"char-e",shift:"char-E",extended:["char-e","char-egrave","char-eacute","char-ecirc","char-euml"],
shiftextended:["char-E","char-Egrave","char-Eacute","char-Ecirc","char-Euml"]},"key-f":{normal:"char-f",shift:"char-F"},"key-g":{normal:"char-g",shift:"char-G"},"key-h":{normal:"char-h",shift:"char-H"},"key-i":{normal:"char-i",shift:"char-I",extended:["char-i","char-igrave","char-iacute","char-icirc","char-iuml"],shiftextended:["char-I","char-Igrave","char-Iacute","char-Icirc","char-Iuml"]},"key-j":{normal:"char-j",shift:"char-J"},"key-k":{normal:"char-k",shift:"char-K"},"key-l":{normal:"char-l",
shift:"char-L"},"key-m":{normal:"char-m",shift:"char-M"},"key-n":{normal:"char-n",shift:"char-N",extended:["char-ntilde"],shiftextended:["char-Ntilde"]},"key-o":{normal:"char-o",shift:"char-O",extended:"char-o char-ograve char-oacute char-ocirc char-ouml char-oslash char-otilde char-oelig".split(" "),shiftextended:"char-O char-Ograve char-Oacute char-Ocirc char-Ouml char-Oslash char-Otilde char-OElig".split(" ")},"key-p":{normal:"char-p",shift:"char-P"},"key-q":{normal:"char-q",shift:"char-Q"},"key-r":{normal:"char-r",
shift:"char-R"},"key-s":{normal:"char-s",shift:"char-S",extended:["char-s","char-szlig"],shiftextended:["char-S","char-szlig"]},"key-t":{normal:"char-t",shift:"char-T"},"key-u":{normal:"char-u",shift:"char-U",extended:["char-u","char-ugrave","char-uacute","char-ucirc","char-uuml"],shiftextended:["char-U","char-Ugrave","char-Uacute","char-Ucirc","char-Uuml"]},"key-v":{normal:"char-v",shift:"char-V"},"key-w":{normal:"char-w",shift:"char-W"},"key-x":{normal:"char-x",shift:"char-X"},"key-y":{normal:"char-y",
shift:"char-Y",extended:["char-y","char-yacute","char-yuml"],shiftextended:["char-Y","char-Yacute"]},"key-z":{normal:"char-z",shift:"char-Z"},"key-currency":{normal:"char-dollar",shift:"char-dollar",extended:["char-dollar","char-euro","char-pound","char-yen"],shiftextended:["char-dollar","char-euro","char-pound","char-yen"]},"key-currency2":{normal:"char-euro",shift:"char-euro",extended:["char-dollar","char-euro","char-pound","char-yen"],shiftextended:["char-dollar","char-euro","char-pound","char-yen"]},
"key-excl":{normal:"char-excl",shift:"char-excl",extended:["char-excl","char-iexcl"],shiftextended:["char-excl","char-iexcl"]},"key-quest":{normal:"char-quest",shift:"char-quest",extended:["char-quest","char-iquest"],shiftextended:["char-quest","char-iquest"]},"key-lparen":{normal:"char-lparen",shift:"char-lparen"},"key-rparen":{normal:"char-rparen",shift:"char-rparen"},"key-lcurly":{normal:"char-lcurly",shift:"char-lcurly"},"key-rcurly":{normal:"char-rcurly",shift:"char-rcurly"},"key-lsquare":{normal:"char-lsquare",
shift:"char-lsquare"},"key-rsquare":{normal:"char-rsquare",shift:"char-rsquare"},"key-atsign":{normal:"char-atsign",shift:"char-atsign"},"key-period":{normal:"char-period",shift:"char-period"},"key-underscore":{normal:"char-underscore",shift:"char-underscore"},"key-comma":{normal:"char-comma",shift:"char-comma"},"key-semicolon":{normal:"char-semicolon",shift:"char-semicolon"},"key-colon":{normal:"char-colon",shift:"char-colon"},"key-caret":{normal:"char-caret",shift:"char-caret"},"key-plus":{normal:"char-plus",
shift:"char-plus"},"key-tilde":{normal:"char-tilde",shift:"char-tilde"},"key-grave":{normal:"char-grave",shift:"char-grave"},"key-vertline":{normal:"char-vertline",shift:"char-vertline"},"key-amp":{normal:"char-amp",shift:"char-amp"},"key-percent":{normal:"char-percent",shift:"char-percent"},"key-divide":{normal:"char-divide",shift:"char-divide"},"key-hash":{normal:"char-number",shift:"char-number"},"key-doubledagger":{normal:"char-doubledagger",shift:"char-doubledagger"},"key-degree":{normal:"char-degree",
shift:"char-degree"},"key-lt":{normal:"char-lt",shift:"char-lt"},"key-gt":{normal:"char-gt",shift:"char-gt"},"key-slash":{normal:"char-slash",shift:"char-slash"},"key-backslash":{normal:"char-backslash",shift:"char-backslash"},"key-apos":{normal:"char-apos",shift:"char-apos"},"key-quot":{normal:"char-quot",shift:"char-quot"},"key-hyphen":{normal:"char-hyphen",shift:"char-hyphen"},"key-equal":{normal:"char-equal",shift:"char-equal"},"key-bullet":{normal:"char-bullet",shift:"char-bullet"},"key-asterisk":{normal:"char-asterisk",
shift:"char-asterisk"},"key-0":{normal:"digit-0",shift:"char-hyphen"},"key-1":{normal:"digit-1",shift:"char-excl"},"key-2":{normal:"digit-2",shift:"char-atsign"},"key-3":{normal:"digit-3",shift:"char-number"},"key-4":{normal:"digit-4",shift:"char-euro"},"key-5":{normal:"digit-5",shift:"char-colon"},"key-6":{normal:"digit-6",shift:"char-slash"},"key-7":{normal:"digit-7",shift:"char-period"},"key-8":{normal:"digit-8",shift:"char-comma"},"key-9":{normal:"digit-9",shift:"char-quest"},"numkey-0":{normal:"numpad-0"},
"numkey-1":{normal:"numpad-1"},"numkey-2":{normal:"numpad-2"},"numkey-3":{normal:"numpad-3"},"numkey-4":{normal:"numpad-4"},"numkey-5":{normal:"numpad-5"},"numkey-6":{normal:"numpad-6"},"numkey-7":{normal:"numpad-7"},"numkey-8":{normal:"numpad-8"},"numkey-9":{normal:"numpad-9"},"numkey-decimal":{normal:"char-period"},"numkey-comma":{normal:"char-comma"},"key-space":{normal:"char-space",shift:"char-space",event:"space"},"action-shift":{code:"shift",label:"&#8679;",glyph:"shift",event:"shiftselect"},
"action-extended":{label:"\u00e2\u00eb\u00ed",event:"extendedselect"},"action-backspace":{code:"back",label:"&#9003;",glyph:"delete",event:"backspace"},"action-closeextendedpanel":{label:"&#9099;",glyph:"cancel",event:"extendedselect"},"action-nextlayout":{label:"",glyph:"",event:"layoutchanged"}},KeyLayouts:[{id:"alphanumeric",label:"abc",glyph:"",keyrows:[[{keyid:"key-a"},{keyid:"key-b"},{keyid:"key-c"},{keyid:"key-d"},{keyid:"key-e"},{keyid:"key-f"},{keyid:"key-g"},{keyid:"key-h"},{keyid:"key-i"}],
[{keyid:"key-j"},{keyid:"key-k"},{keyid:"key-l"},{keyid:"key-m"},{keyid:"key-n"},{keyid:"key-o"},{keyid:"key-p"},{keyid:"key-q"},{keyid:"key-r"}],[{keyid:"key-s"},{keyid:"key-t"},{keyid:"key-u"},{keyid:"key-v"},{keyid:"key-w"},{keyid:"key-x"},{keyid:"key-y"},{keyid:"key-z"},{keyid:"key-0"}],[{keyid:"key-1"},{keyid:"key-2"},{keyid:"key-3"},{keyid:"key-4"},{keyid:"key-5"},{keyid:"key-6"},{keyid:"key-7"},{keyid:"key-8"},{keyid:"key-9"}]],controlrow:[{keyid:"action-nextlayout"},{keyid:"action-shift"},
{keyid:"key-space"},{keyid:"action-extended"},{keyid:"action-backspace"}]},{id:"symbols",label:".@#",glyph:"",keyrows:[[{keyid:"key-currency"},{keyid:"key-currency2"},{keyid:"key-lparen"},{keyid:"key-rparen"},{keyid:"key-lcurly"},{keyid:"key-rcurly"},{keyid:"key-tilde"},{keyid:"key-grave"},{keyid:"key-vertline"}],[{keyid:"key-comma"},{keyid:"key-amp"},{keyid:"key-lsquare"},{keyid:"key-rsquare"},{keyid:"key-caret"},{keyid:"key-percent"},{keyid:"key-divide"},{keyid:"key-hash"},{keyid:"key-degree"}],
[{keyid:"key-excl"},{keyid:"key-quest"},{keyid:"key-lt"},{keyid:"key-gt"},{keyid:"key-colon"},{keyid:"key-semicolon"},{keyid:"key-plus"},{keyid:"key-asterisk"},{keyid:"key-bullet"}],[{keyid:"key-period"},{keyid:"key-atsign"},{keyid:"key-backslash"},{keyid:"key-slash"},{keyid:"key-apos"},{keyid:"key-quot"},{keyid:"key-hyphen"},{keyid:"key-equal"},{keyid:"key-underscore"}]],controlrow:[{keyid:"action-nextlayout"},{keyid:"action-shift"},{keyid:"key-space"},{keyid:"action-extended"},{keyid:"action-backspace"}],
noShift:!0,noExtended:!0},{id:"digits",label:"123",glyph:"",keyrows:[[],[{keyid:"key-1"},{keyid:"key-2"},{keyid:"key-3"},{keyid:"key-4"},{keyid:"key-5"}],[{keyid:"key-6"},{keyid:"key-7"},{keyid:"key-8"},{keyid:"key-9"},{keyid:"key-0"}],[]],controlrow:[{keyid:"action-nextlayout"},{keyid:"action-shift"},{keyid:"action-extended"},{keyid:"key-space"},{keyid:"action-backspace"}]},{id:"pinentry",label:"PIN",glyph:"",keyrows:[[{keyid:"numkey-1"},{keyid:"numkey-2"},{keyid:"numkey-3"}],[{keyid:"numkey-4"},
{keyid:"numkey-5"},{keyid:"numkey-6"}],[{keyid:"numkey-7"},{keyid:"numkey-8"},{keyid:"numkey-9"}],[{keyid:"spacer-numkey"},{keyid:"numkey-0"},{keyid:"action-backspace"}]],controlrow:[],needNumericBackspace:!0,isPin:!0,isNumeric:!0},{id:"numeric-decimal",label:"123",glyph:"",keyrows:[[{keyid:"numkey-1"},{keyid:"numkey-2"},{keyid:"numkey-3"}],[{keyid:"numkey-4"},{keyid:"numkey-5"},{keyid:"numkey-6"}],[{keyid:"numkey-7"},{keyid:"numkey-8"},{keyid:"numkey-9"}]],controlrow:[{keyid:","===Number.DECIMAL?
"numkey-comma":"numkey-decimal"},{keyid:"numkey-0"},{keyid:"action-backspace"}],needNumericBackspace:!0,isNumeric:!0}],KeyLayoutSets:{normal:["alphanumeric","symbols"],pin:["pinentry"],decimal:["numeric-decimal"]},ControlDimensions:{standard:{container:{width:522,height:331},key:{width:58,height:63},action:{width:87,height:63},space:{width:198,height:63},numkey:{width:116,height:63},keypadding:6,rowpadding:2,"keypadding-pinentry":4,"rowpadding-pinentry":1},small:{container:{width:522,height:331},
key:{width:52,height:63},action:{width:77,height:63},space:{width:176,height:63},numkey:{width:116,height:63},keypadding:4,rowpadding:4,"keypadding-pinentry":4,"rowpadding-pinentry":1}},KeyImageSources:{}}},d=function(a){var c="";switch(a){case "action-nextlayout":case "action-shift":case "action-extended":case "action-backspace":c="action";b[this._classID].state.currentLayout.isNumeric&&(c="numkey");break;case "key-space":c="space";break;case "numkey":case "spacer-numkey":c="numkey"}a&&0===a.indexOf("numkey-")&&
(c="numkey");a&&(0===a.indexOf("key-")&&!c)&&(c="key");return c},c=function(a){var c=b.Tables.KeyLayoutSets,d=b.Tables.KeyLayouts,e=b[this._classID];a||(a="normal");"string"===typeOf(a)&&(a=c[a]||[a]);e.availableLayouts=a.map(function(b){return d.filter(function(a){return a.id==b})[0]});e.availableLayouts.length||(e.availableLayouts=c.normal.map(function(b){return d.filter(function(a){return a.id==b})[0]}))},e=function(a){return b.Tables.KeyLayouts.filter(function(b){return b.id==a})[0]},f=function(){var a=
b[this._classID],c=a.availableLayouts,d=c.indexOf(a.state.currentLayout);return 0>d?a.state.currentLayout:c[d+1<c.length?d+1:0]},g=function(a){a=b[this._classID];k.call(this,a.state.current_focused_key,a.body.firstChild.firstChild)},h=function(a){b[this._classID].state.current_focused_key&&b[this._classID].state.current_focused_key.removeClass("focused")},k=function(a,c){var d=b[this._classID].state;d.current_focused_key=a||c;d.current_focused_key.focus()},m=function(a,c,d){d=b[this._classID];var e=
b.Tables.KeyDefinitions[c],g,k;a.store("definition",e);a.store("keyid",c);if(0===c.indexOf("spacer-"))a.opacity=0,a.wantsFocus=!1;else{0===c.indexOf("action-")?(g="action-nextlayout"===c?f.call(this).label:e.label,k=e.code||g):(k=b.Tables.CharacterDefinitions[e[d.state.showShift?"shift":"normal"]],g=k.label,k=k.code||g);if(g){var h=a.retrieve("label");h||(h=(new Text).inject(a),h.addClass("ReuseKeyboardLabel"),a.store("label",h));var l=a.retrieve("key");d.indexing["key-"+k]=l&&l.key||0;h.data="space"===
g?widget.getLocalizedString("SPACE"):g}g=!1;d.state.showExtended?(e.extended&&!d.extendedOverlay.visible&&(g=!0),"control"!==a.retrieve("key").row||d.extendedOverlay.visible||(g=!0)):g=!0;a.disabled=g?!1:!0;"action-extended"===c&&(a.disabled=d.state.currentLayout.noExtended?!0:a.disabled);"action-shift"===c&&(a.disabled=d.state.currentLayout.noShift?!0:a.disabled);"action-nextlayout"===c&&(a.disabled=d.state.showExtended?!0:a.disabled)}},p=function(a){var c=b[this._classID];a=c.indexing["key-"+a];
return isNumber(a)&&(c=c.body.firstChild.childNodes[a],!c.disabled)?(c.focus(),c.select(),!0):!1},n=function(a){var c=a.target;if(a.isChar||a.isNumeric){if(!p.call(c.owner,a.key))return c.owner.appendToValue(a.key)}else if(this.visible)switch(a.key){case "shift":b[c.owner._classID].state.currentLayout.noShift||b[c.owner._classID].state.showShift||c.owner.setShiftState(!0);break;case "back":case "delete":a.preventDefault();if(!p.call(c.owner,a.key))return c.owner.deleteFromValue();break;case "space":if(!p.call(c.owner,
a.key))return c.owner.appendToValue(" ")}return a},l=function(a){var c=a.target;"shift"===a.key&&(b[c.owner._classID].state.currentLayout.noShift||c.owner.setShiftState(!1))},r=function(a){var c=b[this._classID],d=c.extendedOverlay||new Frame,e=(a.retrieve("definition")[c.state.showShift?"shiftextended":"extended"]||[]).slice();e.push("action-closeextendedpanel");d.store("type","view");d.addClass("extendedOverlay");d.store("focusTarget",a.retrieve("key").key||0);var f=(new List).inject(d),g=createDocumentFragment();
e.forEach(function(c,d){var e=new Item({focus:!0});e.addClass("ReuseKeyboardkey");"small"===this.config.controlSize&&e.addClass("small");e.addEventListener("select",u,this);e.owner=a.owner;g.appendChild(e);var f=b.Tables.CharacterDefinitions[c];f||"action-closeextendedpanel"!=c||(f=b.Tables.KeyDefinitions[c]);var k=f.label;e.store("definition",f);e.store("keyid",c);f=e.retrieve("label");f||(f=(new Text).inject(e),f.addClass("ReuseKeyboardLabel"),e.store("label",f));k&&f?f.data=k:f&&(f.data="")},this);
f.appendChild(g);var h=a.getBounds(),l=a.retrieve("key"),m=this.element.getBounds(),p=m.top,m=m.left,n=Math.min(0,l.keysonrow-l.column-e.length),l=c.body.width/l.keysonrow;d.hOffset=h.left-m-(this.width-c.body.width)+n*l||0;d.vOffset=h.top-p||0;d.width=f.width=l*e.length;f.height=Theme.getStyles("extendedOverlay","height");c.body.appendChild(d);c.body.firstChild.allowNavigation=!1;d.visible=!0;k.call(this,d.lastChild.firstChild)},q=function(){var a=b[this._classID];a.extendedOverlay.firstChild.destroy(!0);
a.extendedOverlay.visible=!1;a.body.firstChild.allowNavigation=!0},s=function(a,b,c){var d={};switch(a){case "key":case "numkey":d.shiftKey=c;d.isChar=!0;d.isNumeric=!0;d.key=b;d.keyCode=13;break;case "char":d.shiftKey=c;d.isChar=!0;d.key=b;d.keyCode=13;break;case "backspace":d.key="back"}this.fireEvent("keydown",d)},u=function(a){var c=b[this.owner._classID||a.target.owner._classID];a=a.target||c.state.current_focused_key;var d=a.retrieve("definition")||a._characterDefinition,e=String(a.retrieve("keyid")||
a._charDefId).split("-")[0],g=String(a.retrieve("keyid")||a._charDefId).split("-")[1],k=c.state.showShift,h=null,h=null,h=c.state.showExtended;switch(e){case "key":case "numkey":h&&"space"!==g?(r.call(this.owner,a),a.owner.fire("extendedselect")):(h=b.Tables.CharacterDefinitions[d[k?"shift":"normal"]],a.owner.appendToValue(h.value||""),s.call(a.owner,e,h.value,k));break;case "char":h=c.extendedOverlay.retrieve("focusTarget");a.owner.appendToValue(d.value||"");s.call(a.owner,e,d.value,k);a.owner.toggleExtended();
k&&a.owner.toggleShift();q.call(this.owner);isNumber(h)&&c.body.firstChild.childNodes[h].focus();break;case "action":switch(g){case "shift":a.owner.toggleShift();break;case "extended":a.owner.toggleExtended();break;case "backspace":a.owner.deleteFromValue();s.call(a.owner,g);break;case "nextlayout":a.owner.loadLayout(f.call(this.owner),{focusTarget:a.retrieve("key").key});break;case "closeextendedpanel":h=c.extendedOverlay.retrieve("focusTarget"),a.owner.toggleExtended(),q.call(this.owner),isNumber(h)&&
c.body.firstChild.childNodes[h].focus()}}},w=function(a){var c=b[this._classID].body.firstChild.firstChild;do 1===c.nodeType&&m.call(this,c,c.retrieve("keyid"),"shiftselect"===a.type?"shift":"extended"),c=c.nextSibling;while(c)},v={space:"onSpace",keydown:"onKeyDown",backspace:"onBackspace",valuechanged:"onValueChanged",layoutchanged:"onLayoutChanged",shiftselect:"onShiftSelect",extendedselect:"onExtendedSelect",closeextendedpanel:"onCloseExtendedPanel",maxlengthexceeded:"onMaxLengthExceeded"};return new MAF.Class({ClassName:"ReuseKeyboard",
Extends:MAF.element.Core,config:{controlSize:"standard",autoAdjust:!0,allowSpace:!0,maxLength:99,keyPadding:!1,rowPadding:!1,wrapNavigation:!0},initialize:function(){var a=b[this._classID]={value:[],body:new Frame({frozen:!0}),extendedOverlay:new Frame,state:{showShift:!1,showExtended:!1,controlSize:this.config.controlSize}};this.config.element=b[this._classID].body;this.parent();"CharacterDefinitions KeyDefinitions KeyLayouts KeyLayoutSets ControlDimensions KeyLabelPresentation KeyImageSources".split(" ").forEach(function(a){this.config[a]&&
(b.Tables[a]=this.config[a])},this);this.body=new List;this.body.inject(this.element);c.call(this,this.config.availableLayouts);var d=a.body;d.addEventListener("focus",g);d.addEventListener("blur",h);d.addEventListener("keydown",n,this);d.addEventListener("keyup",l,this);d.addEventListener("navigateoutofbounds",function(a){var b=a.detail&&a.detail.direction;a=a.target;var c=d.getBounds()||{},e=a.getBounds()||{};switch(b){case "left":a.navigate(b,[c.width||0,e.top||0]);break;case "right":a.navigate(b,
[c.left||0,e.top||0])}});w.subscribeTo(this,["shiftselect","extendedselect"],this);a.extendedOverlay.visible=!1;this.config.startShifted&&(a.state.showShift=!0);this.setValue(this.config.value);this.loadLayout(this.config.layout||a.availableLayouts[0]);this.config.startFocused&&this.focus()},appendTo:function(a){if(a){var c=b[this._classID].body;c.inject(a);c.frozen=!1}return this},loadLayout:function(a,c){var f=b[this._classID];a="string"===typeOf(a)?e(a):a;if(f.state.currentLayout!==a){c=c||{};
var g=b.Tables.ControlDimensions[b[this._classID].state.controlSize];f.indexing={};f.state.currentLayout=a;this.body&&(this.body.destroy(!0),this.body=(new List).inject(f.body,"top"));var h=0,k=0,l=0,p=createDocumentFragment();if(this.config.autoAdjust){var n=Theme.getStyles("ReuseKeyboard .item"),r=0,q=0;["border","borderLeftWidth","borderRightWidth","marginLeft","marginRight"].forEach(function(a){a="border"===a?2*parseInt(n[a],10):n[a];r+=a||0},this);["border","borderTopWidth","borderBottomWidth",
"marginTop","marginBottom"].forEach(function(a){a="border"===a?2*parseInt(n[a],10):n[a];q+=a||0},this)}a.keyrows.forEach(function(a,b){var c=0,e=0;a.forEach(function(f,g){var h=new Item({focus:!0}),k=this.ClassName+d.call(this,f.keyid),n="small"===this.config.controlSize?Theme.getStyles(k,"small")||{}:Theme.getStyles(k),t=0;h.addClass(k);"small"===this.config.controlSize&&h.addClass("small");h.addEventListener("select",u,this);h.owner=this;p.appendChild(h);h.store("key",{row:b,column:g,key:l++,keysonrow:a.length||
0});m.call(this,h,f.keyid);this.config.autoAdjust&&(c+=r+n.width||0,t+=q+n.height||0,e=Math.max(t,e))},this);h=Math.max(h,c);k+=e},this);var s=0;a.controlrow.forEach(function(a,b){var c=new Item({focus:!0}),e=this.ClassName+d.call(this,a.keyid),f="small"===this.config.controlSize?Theme.getStyles(e,"small")||{}:Theme.getStyles(e),g=0;c.addClass(e);"small"===this.config.controlSize&&c.addClass("small");c.addEventListener("select",u,this);c.owner=this;p.appendChild(c);c.store("key",{row:"control",column:b,
key:l++});m.call(this,c,a.keyid);this.config.autoAdjust&&(g+=q+f.height||0,s=Math.max(g,s))},this);k+=s;this.setStyles({width:this.config.autoAdjust?h:g.container.width,height:this.config.autoAdjust?k:g.container.height});this.body.setStyles({width:this.config.autoAdjust?h:g.container.width,height:this.config.autoAdjust?k:g.container.height});this.body.appendChild(p);c.focusTarget&&this.body.childNodes[c.focusTarget].focus()}},getValue:function(){return b[this._classID].value.join("")},setValue:function(a){var c=
this.getValue(),d=String(a||""),e=parseInt(this.config.maxLength,10);this.config.allowSpace||a.replace(/\s/g,"");d.length>e&&(this.fire("maxlengthexceeded"),d.length=e);b[this._classID].value=d.split("");c!=d&&this.fireEvent("valuechanged",{oldValue:c,newValue:d});return d},appendToValue:function(a){return this.setValue(this.getValue()+String(a||""))},deleteFromValue:function(a){a=parseInt(a,10)||1;var c=b[this._classID].value.slice();c.length=Math.max(0,c.length-a);return this.setValue(c.join(""))},
clearValue:function(){return this.setValue("")},setShiftState:function(a){var c=b[this._classID];return c.state.showShift===Boolean(a)?c.state.showShift:this.toggleShift()},getShiftState:function(){return b[this._classID].state.showShift},toggleShift:function(){var a=b[this._classID];a.state.showShift=!a.state.showShift;this.fire("shiftselect")},setExtendedState:function(a){var c=b[this._classID];return c.state.showExtended===Boolean(a)?c.state.showExtended:this.toggleExtended()},getExtendedState:function(){return b[this._classID].state.showExtended},
toggleExtended:function(){var a=b[this._classID];a.state.showExtended=!a.state.showExtended;this.fire("extendedselect")},focus:function(){g.call(this)},resetFocus:emptyFn,clearFocus:function(){b[this._classID].state.current_focused_key=null},fireEvent:function(a){var b=Array.slice(arguments,1);this.fire(arguments);var c=this[v[a]];c&&c.apply&&c.apply(this,b)},reset:function(a){var c=b[this._classID];q.call(this);a=a||{};for(var d in a)this.config[d]=a[d];c.state.controlSize=this.config.controlSize;
c.state.showShift=!0===this.config.startShifted;this.fire("shiftselect");c.state.showExtended=!0===this.config.startExtended;this.fire("extendedselect");c.state.current_focused_key&&c.state.current_focused_key._applyState("normal");c.state.current_focused_key=null;this.setValue(this.config.value||"");this.loadLayout(this.config.layout||c.availableLayouts[0]);this.config.startFocused&&this.focus()},suicide:function(){Object.forEach(v,function(a,b){this[b]&&delete this[b]},this);this.element.owner=
this;var a=b[this._classID],c=a.body.firstChild,d=a.extendedOverlay;c&&c.destroy(!0);d&&(delete a.overlay,d.destroy());delete a.body;delete b[this._classID];this.parent()}})},{ReuseKeyboard:{normal:{styles:{width:"inherit"}}},"ReuseKeyboard .item":{styles:{border:"2px solid white",backgroundColor:"black",borderRadius:"10px",marginLeft:2,marginRight:2,marginBottom:2,"float":"left"}},ReuseKeyboardkey:{normal:{styles:{width:57,height:63}},small:{styles:{width:52,height:63}},focused:{styles:{backgroundColor:Theme.getStyles("BaseFocus",
"backgroundColor")}},disabled:{styles:{opacity:0.3}}},ReuseKeyboardaction:{normal:{styles:{width:87,height:63}},small:{styles:{width:82,height:63}},focused:{styles:{backgroundColor:Theme.getStyles("BaseFocus","backgroundColor")}},disabled:{styles:{opacity:0.3}}},ReuseKeyboardspace:{normal:{styles:{width:196,height:63}},small:{styles:{width:171,height:63}},focused:{styles:{backgroundColor:Theme.getStyles("BaseFocus","backgroundColor")}},disabled:{styles:{opacity:0.3}}},ReuseKeyboardnumkey:{normal:{styles:{width:116,
height:63}},small:{styles:{width:116,height:63}},focused:{styles:{backgroundColor:Theme.getStyles("BaseFocus","backgroundColor")}},disabled:{styles:{opacity:0.3}}},ReuseKeyboardLabel:{styles:{width:"inherit",height:"inherit",fontSize:32,anchorStyle:"center"}},extendedOverlay:{styles:{height:67}}});define("MAF.keyboard.KeyboardValueManager",function(a){var b={};return new MAF.Class({initialize:function(){b[this._classID]={value:"",cursorPosition:0};getter(this,"value",function(){return b[this._classID].value||""});setter(this,"value",function(a){if(null===a||void 0===a)a="";var c=b[this._classID].value;a!==c&&(c=a,this.config.maxLength&&c.length>this.config.maxLength&&(c=c.substr(0,this.config.maxLength),this.fire("maxlengthexceeded")),b[this._classID].value=c,this.fire("valuechanged",{value:c}));
return c});getter(this,"cursorPosition",function(){return b[this._classID].cursorPosition||0});setter(this,"cursorPosition",function(a){"number"===typeOf(a)&&(a=Math.max(0,Math.min(parseInt(a,10),this.value.length)),this.cursorPosition!==a&&(b[this._classID].cursorPosition=a,this.fire("cursormoved",{cursorPosition:a})));return this.cursorPosition})},deleteLeft:function(a){a=parseInt(a,10)||1;var b=this.value;this.value=b.substr(0,Math.max(0,this.cursorPosition-a))+b.substr(this.cursorPosition,b.length);
this.moveCursorLeft(a);return this.value},deleteRight:function(a){a=parseInt(a,10)||1;var b=this.value;this.value=b.substr(0,this.cursorPosition)+b.substr(this.cursorPosition+a,b.length);this.moveCursorRight(a);return this.value},handleExternalKeyInput:function(a){DEBUG&&(a||log("handleExternalKeyInput ... no event to process"));var b=a.payload&&a.payload.layout||null;a.Event&&(a={payload:a.Event});if("pinentry"===b&&!a.payload.isNumeric&&0>["tab","back","enter"].indexOf(a.payload.key))return!1;if(a.payload.isChar||
"space"===a.payload.key)return this.insertCharacters("space"===a.payload.key?" ":a.payload.key);switch(a.payload.key){case "back":this.deleteLeft();break;case "delete":this.deleteRight()}},insertCharacters:function(a){if(null===a||void 0===a)return this.value;a=String(a);var b=this.value;this.value=b.substr(0,this.cursorPosition)+a+b.substr(this.cursorPosition,b.length);this.moveCursorRight(a.length);return b},moveCursorLeft:function(a){return this.cursorPosition-=a||1},moveCursorRight:function(a){return this.cursorPosition+=
a||1},setMaxLength:function(a){isNumber(a)&&(this.config.maxLength=a)},suicide:function(){delete b[this._classID]}})});define("MAF.control.EmptySpace",function(){return new MAF.Class({ClassName:"ControlEmptySpace",Extends:MAF.element.Core})},{ControlEmptySpace:{styles:{backgroundImage:"url("+Image.CHECKERS+")"}}});define("MAF.control.Button",function(){var a=function(a){a=Theme.getStyles("SecureButtonIndicator");var d=Theme.storage.SecureButtonIndicator&&Theme.storage.SecureButtonIndicator.source,c=a&&"right"==a.hAlign,e=a&&"bottom"==a.vAlign;!this.secureIndicator&&this.secure&&(this.secureIndicator=d?(new MAF.element.Image({src:d,styles:a})).appendTo(this):(new MAF.element.Text({data:"&#128274;",styles:a})).appendTo(this));this.secureIndicator&&this.secureIndicator.setStyles({hOffset:c?parseInt(a.marginRight||
0,10):lock.hOffset,vOffset:e?parseInt(a.marginBottom||0,10):lock.vOffset,visible:this.secure});this.adjustAccessories()};return new MAF.Class({ClassName:"ControlButton",Extends:MAF.element.Button,Protected:{onThemeNeeded:function(b){if(!b.defaultPrevented)switch(b.type){case "onFocus":this.renderSkin("focused");break;case "onBlur":this.renderSkin("normal");break;case "onAppend":this.renderSkin("normal"),this.createContent(),a.call(this)}}},initialize:function(){this.onThemeNeeded.subscribeTo(this,
["onFocus","onBlur","onAppend"],this);a.subscribeTo(this,"onChangedSecure",this);this.parent()},createContent:emptyFn,adjustAccessories:emptyFn})},{ControlButton:{renderSkin:function(a,b,d,c,e){b=new Frame;e.applyLayer("BaseGlow",b);"focused"===a&&e.applyLayer("BaseFocus",b);e.applyLayer("BaseHighlight",b);return b},styles:{width:"inherit",height:51}},SecureButtonIndicator:{source:!1,normal:{styles:{visible:!1,hAlign:"right",vAlign:"bottom",marginRight:5,marginBottom:7}}}});define("MAF.control.TextButton",function(){return new MAF.Class({ClassName:"ControlTextButton",Extends:MAF.control.Button,createContent:function(){this.content=(new MAF.element.Text({ClassName:(this.config.ClassName||this.ClassName)+"Text",label:this.config.label,styles:this.config.textStyles})).appendTo(this)},setText:function(a){this.content.setText(a)}})},{ControlTextButton:"ControlButton",ControlTextButtonText:{styles:{width:"100%",height:"inherit",paddingLeft:10,paddingRight:10,anchorStyle:"leftCenter",
truncation:"end"}}});define("MAF.control.BackButton",function(){return new MAF.Class({ClassName:"ControlBackButton",Extends:MAF.control.Button,Protected:{dispatcher:function(a,b){switch(a.type){case "select":this.fire("onSelect",b,a)&&MAF.application.previousView();break;default:this.parent(a,b)}}},createContent:function(){this.content=[(new MAF.element.Text({ClassName:(this.config.ClassName||this.ClassName)+"Icon",label:"&#x21A9;"})).appendTo(this),(new MAF.element.Text({ClassName:(this.config.ClassName||this.ClassName)+
"Text",label:this.config.label||widget.getLocalizedString("BACK"),styles:this.config.textStyles})).appendTo(this)]},setText:function(a){this.content[1].setText(a)}})},{ControlBackButton:"ControlButton",ControlBackButtonIcon:{styles:{width:60,height:"inherit",fontSize:24,paddingTop:3,anchorStyle:"center"}},ControlBackButtonText:{styles:{width:"inherit",height:"inherit",paddingLeft:60,fontSize:24,anchorStyle:"leftCenter",truncation:"end"}}});define("MAF.control.PhotoBackButton",function(){var a=function(){this.aspectSizeMax(Math.min(this.width,this.height))};return new MAF.Class({ClassName:"ControlPhotoBackButton",Extends:MAF.control.BackButton,createContent:function(){this.parent();this.photo=(new MAF.element.Image({ClassName:(this.config.ClassName||this.ClassName)+"Image"})).appendTo(this);a.subscribeTo(this.photo,"onLoaded",this.photo);this.photo.setSources(this.config)},setSource:function(a){return this.photo.setSource(a)},setSources:function(a){return this.photo.setSources(a)}})},
{ControlPhotoBackButton:"ControlButton",ControlPhotoBackButtonImage:{styles:{vAlign:"center",hOffset:100,width:40,height:40}}});define("MAF.control.Header",function(){return new MAF.Class({ClassName:"ControlHeader",Extends:MAF.element.Container,config:{headerStyle:"large"},initialize:function(){delete this.config.focus;this.parent();var a=this.config,b=a.ClassName||this.ClassName,d=a.headerStyle&&a.headerStyle.capitalize()||"";this.element.addClass(b+d);this.content=(new MAF.element.Text({ClassName:b+"Text"+d,label:a.label,styles:a.textStyles})).appendTo(this)},setText:function(a){this.content.setText(a)}})},{ControlHeader:{styles:{backgroundColor:Theme.getStyles("BaseGlow",
"backgroundColor"),width:"inherit"}},ControlHeaderSmall:{styles:{height:"32px"}},ControlHeaderLarge:{styles:{height:"48px"}},ControlHeaderTextSmall:{styles:{width:"100%",height:"inherit",paddingLeft:10,paddingRight:10,fontSize:18,anchorStyle:"leftCenter",truncation:"end"}},ControlHeaderTextLarge:{styles:{width:"100%",height:"inherit",paddingLeft:10,paddingRight:10,fontSize:24,anchorStyle:"leftCenter",truncation:"end"}}});define("MAF.control.Keyboard",function(){var a={},b={},d=function(){var c=b[this._classID]={valueChanged:function(){this.fire("onValueChanged",{value:this.getValue()})}.bindTo(this),maxLengthExceeded:function(){this.fire("onMaxLengthExceeded")}.bindTo(this),keyDown:function(a){this.fire("onKeyDown",a,a.type?a:null)}.bindTo(this)},d=a[this._classID]=new MAF.keyboard.ReuseKeyboard({focus:this.config.focus,autoAdjust:!0,allowSpace:this.config.allowSpace,maxLength:this.config.maxLength,controlSize:this.config.controlSize,
startShifted:this.config.startShifted,startExtended:this.config.startExtended,startFocused:this.config.startFocused,layout:this.config.layout,availableLayouts:this.config.availableLayouts,wrapNavigation:this.config.wrapNavigation});d.element.hAlign="center";d.element.owner=this;d.appendTo(this.element);this.setStyle("height",d.element.height);d.onValueChanged=c.valueChanged;d.onMaxLengthExceeded=c.maxLengthExceeded;d.onKeyDown=c.keyDown};return new MAF.Class({ClassName:"ControlKeyboard",Extends:MAF.element.Container,
config:{embedded:!0,focus:!0,controlSize:"standard",autoAdjust:!0,allowSpace:!0,maxLength:99,startShifted:!1,wrapNavigation:!0},Protected:{dispatcher:function(a,b){switch(a.type){case "focus":this.focus()}},generateStatePacket:function(b){return Object.merge({value:this.getValue(),focused:a[this._classID].element.hasFocus},b)},inspectStatePacket:function(a,b){if(!this.config.guid||a&&!(this.config.guid in a))return a;var d=a&&a[this.config.guid],g=typeOf(d);if("null"===g||"undefined"===g)return a;
if(b)d.focused&&this.focus();else switch(g){case "boolean":case "string":return this.setValue(d);case "object":for(var h in d)switch(h){case "value":d[h]&&this.setValue(d[h])}}return d}},initialize:function(){this.config.autoAdjust&&this.config.styles&&delete this.config.styles.height;this.parent();this.element.wantsFocus=!1;d.call(this);this.config.value&&this.setValue(this.config.value);delete this.config.value;this.config.autoAdjust&&this.setStyle("height",a[this._classID].element.height)},getValue:function(){return a[this._classID].getValue()},
setValue:function(b){return a[this._classID].setValue(b)},appendToValue:function(b){return a[this._classID].appendToValue(b)},deleteFromValue:function(b){return a[this._classID].deleteFromValue(b)},clearValue:function(){return a[this._classID].clearValue()},loadLayout:function(b,d){return a[this._classID].loadLayout(b,d)},focus:function(){return a[this._classID].focus()},resetFocus:function(){return a[this._classID].resetFocus()},reset:function(){return a[this._classID].reset()},getShiftState:function(){return a[this._classID].getShiftState()},
setShiftState:function(b){return a[this._classID].setShiftState(b)},toggleShift:function(){return a[this._classID].toggleShift()},getExtendedState:function(){return a[this._classID].getExtendedState()},setExtendedState:function(b){return a[this._classID].setExtendedState(b)},toggleExtendedState:function(){return a[this._classID].toggleExtended()},toggleKey:function(b){a[this._classID].toggleKey(b)},suicide:function(){var c=this._classID;a[c].suicide();delete a[c];delete b[c];this.parent()}})},{ControlKeyboard:{styles:{width:"inherit"}}});define("MAF.control.ValueDisplay",function(){return new MAF.Class({ClassName:"ControlValueDisplay",Extends:MAF.element.Core,Protected:{onSourceUpdated:function(){var a=this.getSourceDisplayValue();this.updateContent(a)},updateContent:function(a,b){b=b||{};if(this.config.animate&&"none"!=b.transition){this.content.freeze();this.content.appendTo(this.buffer);this.buffer.freeze();this.content.hide();this.content.thaw();this.content.appendTo(this);this.content.data=a;var d=this.config.animation,c=[],
e=function(a){var c={};a.forEach(function(a){c[a]=a in b?b[a]:d[a]});return c}(["duration","fade","slide","direction","ease"]),f=this.width,g=this.height,h=this.content.element,k=this.buffer.element,m=this.contentUpdated.bindTo(this);if(!e.slide&&!e.fade)return m();e.fade&&(c.push(new FadeAnimation(h,255,e.duration,e.ease)),c.push(new FadeAnimation(k,0,e.duration,e.ease)));if(e.slide){switch(e.direction){case "left":h.hOffset=f;c.push(new MoveAnimation(k,0-f,0,e.duration,e.ease));break;case "right":h.hOffset=
0-f;c.push(new MoveAnimation(k,f,0,e.duration,e.ease));break;case "up":h.vOffset=g;c.push(new MoveAnimation(k,0,0-g,e.duration,e.ease));break;case "down":h.vOffset=0-g,c.push(new MoveAnimation(k,0,g,e.duration,e.ease))}c.push(new MoveAnimation(h,0,0,e.duration,e.ease,m))}this.content.show()}else this.content.data=a},contentUpdated:function(){this.content.show();this.buffer.hide();this.buffer.setStyles({hOffset:0,vOffset:0,opacity:255});this.buffer.thaw();this.buffer.show()}},config:{eventTypes:["onValueChanged",
"onValueInitialized"],sourceElement:null,source:null,animation:{duration:250,fade:!0,slide:!0,direction:"left",ease:0}},initialize:function(){this.parent();this.createContent();var a=this.config.sourceElement||this.config.source;a&&this.attachToSource(a);this.config.source=null;delete this.config.source;this.config.sourceElement=null;delete this.config.sourceElement},getSourceDisplayValue:function(){return this.source?this.source.getDisplayValue():""},createContent:function(){this.content=(new MAF.element.Text({ClassName:"ControlValueContainerText",
label:"..."})).appendTo(this);this.buffer=(new MAF.element.Core).appendTo(this)},attachToSource:function(a){var b=null;if(!a||this.source===a)return b=this.getSourceDisplayValue(),this.updateContent(b,{transition:"none"});this.source=a;this.onSourceUpdated.subscribeTo(this.source,this.config.eventTypes,this);b=this.getSourceDisplayValue();this.updateContent(b,{transition:"none"})},suicide:function(){this.content.suicide();delete this.content;this.buffer.suicide();delete this.buffer;delete this.source;
this.parent()}})},{ControlValueContainerText:{styles:{width:"100%",height:"inherit",paddingLeft:10,paddingRight:10,anchorStyle:"rightCenter",opacity:"0.7"}}});define("MAF.control.InputButton",function(){var a=function(a){var b=arguments.callee.caller.__event__||null;this.setValue(a);this.fire("onSelect",null,b)},b=function(){var a=this.getDisplayValue();this.config.valueOnSubline?(this.valueDisplay=(new MAF.element.Text({ClassName:"ControlValueContainerSubline",label:a})).appendTo(this),function(){this.valueDisplay.data=this.getDisplayValue()}.subscribeTo(this,["onValueInitialized","onValueChanged"],this)):this.valueDisplay=(new MAF.control.ValueDisplay({source:this,
styles:{height:"inherit"}})).appendTo(this)};return new MAF.Class({ClassName:"ControlInputButton",Extends:MAF.control.TextButton,Protected:{dispatcher:function(b,c){if("select"===b.type){b.stopPropagation();b.preventDefault();var e=this.config,f=a.bindTo(this),g=this.getValue();f.__event__=void 0;e.changeValue&&e.changeValue.apply?e.changeValue.apply(this,[f,g]):this.changeValue(f,g)}else this.parent(b,c)},onThemeNeeded:function(a){this.parent(a);switch(a.type){case "onAppend":this.config.valueOnSubline||
("ImageToggleButton"===this.ClassName||!this.valueDisplay||a.payload.skip)||(this.valueDisplay.width=this.width)}}},config:{options:[],value:null,valueOnSubline:!1},initialize:function(){this.ClassName+=this.config.valueOnSubline?"Subline":"";this.parent();this.config.options&&(this.setOptions(this.config.options),delete this.config.options);this.setValue(this.config.value||"");delete this.config.value},adjustAccessories:function(){var a=this.width;this.secureIndicator&&this.secure&&(a=this.secureIndicator.hOffset-
this.secureIndicator.width);this.valueDisplay&&(this.valueDisplay.config&&this.valueDisplay.config.styles&&"right"===this.valueDisplay.config.styles.hAlign)&&this.valueDisplay.setStyles({hOffset:a})},createContent:function(){this.getDisplayValue();var a=this.config,c=a.valueOnSubline?"ControlValueContainerMainline":"ControlTextButtonText",e=Object.clone(a.textStyles||Theme.getStyles(c)||{});delete e.width;this.content=(new MAF.element.Text({ClassName:c,label:a.label,styles:e})).appendTo(this);b.call(this)},
getValue:function(){return String(this.retrieve("value")||"")},setValue:function(a){var b=null===this.retrieve("value");a=null===a?"":String(a);if((this.retrieve("value")||"")===a)return"";this.store("value",a);this.fire(b?"onValueInitialized":"onValueChanged",{value:a});return this.getValue()},changeValue:function(a,b){a(b)},getDisplayValue:function(a){var b=a=a||this.getValue();this.getOptions().forEach(function(e){e.value==a&&(b=e.label)});return b},setOptions:function(a,b){a=[].concat(a);var e=
a.map(function(a,d){var e="object"===typeOf(a),k=b&&b.length||0;return a?{value:e&&"value"in a?a.value:a,label:k>d?b[d]:e&&"label"in a?a.label:a}:a});this.store("options",e);this.fire("onOptionsChanged",{options:this.getOptions()})},getOptions:function(){return this.retrieve("options")||[]},getOptionValues:function(){return this.getOptions().map(function(a){return a.value})},getOptionLabels:function(){return this.getOptions().map(function(a){return a.label})},generateStatePacket:function(a){a=a||
{};return this.parent(Object.merge({value:this.getValue()},a))},inspectStatePacket:function(a,b){var e=this.parent(a,b),f=typeOf(e);if(!b){if(e===a)return a;switch(f){case "boolean":case "string":return this.setValue(e)}for(var g in e)switch(g){case "optionCancelled":if(e[g])return this.fire("onOptionCancelled",e),e[g]=null,e;break;case "optionSelected":if(e[g]&&"option"in e){this.fire("onOptionSelected",e.option);e[g]=null;continue}else if(!1===e[g])return this.fire("onOptionCancelled",e),e[g]=null,
e;break;case "option":this.setValue(e[g].value);break;case "value":this.setValue(e[g])}return e}},suicide:function(){this.valueDisplay.suicide();delete this.valueDisplay;this.parent()}})},{ControlInputButton:"ControlButton",ControlInputButtonSubline:{styles:{width:"inherit",height:"91px"}}});define("MAF.control.PromptButton",function(){return new MAF.Class({ClassName:"ControlPromptButton",Extends:MAF.control.InputButton,config:{title:"",message:"Please select an option:"},changeValue:function(a,b){var d=function(b){a(b.selected.value)},c=this.getOptions().slice(0,2).map(function(a){a.callback=d;return a});(new MAF.dialogs.Alert({title:this.config.title||this.config.label,message:this.config.message,buttons:c,focusOnCompletion:this})).show()}})},{ControlPromptButton:"ControlButton"});define("MAF.control.ToggleButton",function(){return new MAF.Class({ClassName:"ControlToggleButton",Extends:MAF.control.InputButton,changeValue:function(a,b){var d=this.getOptions(),c=d.map(function(a){return a.value}).indexOf(b),c=-1==c||c==d.length-1?0:c+1;a(d[c].value)}})},{ControlToggleButton:"ControlButton"});define("MAF.control.ImageToggleButton",function(){return new MAF.Class({ClassName:"ImageToggleButton",Extends:MAF.control.InputButton,config:{styling:!0},changeValue:function(a,b){var d=this.getOptions(),c=d.map(function(a){return a.value}).indexOf(b),c=-1==c||c==d.length-1?0:c+1;a(d[c].value)}})},{ImageToggleButton:"ControlButton"});define("MAF.control.TextEntryButton",function(){return new MAF.Class({ClassName:"ControlTextEntryButton",Extends:MAF.control.InputButton,Protected:{onThemeNeeded:function(a){"onAppend"===a.type&&(a.payload.skip=!0);this.parent(a)}},config:{showCursor:!0,cursorCharacter:"_",bulletCharacter:"\u2022",secureMask:!1,secureMaskType:"mask-submitted",keyboard:{layout:"alphanumeric"},animate:!1,animation:{},overlayBackgroundColor:"rgba(0,0,0,.7)",formBackgroundColor:"black"},createContent:function(){this.content=
(new MAF.element.Text({ClassName:"ControlTextEntryButtonLabel",label:this.config.label})).appendTo(this);this.valueDisplay=(new MAF.element.Text({ClassName:"ControlTextEntryButtonValue",styles:{width:this.width-2*Theme.getStyles("ControlTextEntryButtonValue","margin")}})).appendTo(this);this.valueDisplay._updateContent=function(a){this.valueDisplay.setText(this.getDisplayValue(a.payload.value))}.subscribeTo(this,["onValueInitialized","onValueChanged","onValueEdited"],this);this.valueDisplay._updateContent({payload:{value:this.getValue()}})},
getDisplayValue:function(a,b){var d=this.config.cursorCharacter,c=this.config.bulletCharacter,e=this.config.secureMask;a=b?a:a||this.getValue();if(e&&a.length){var f=c.repeat(a.length);switch(e){case "mask-character":d=b?c.repeat(a.length-1)+a.charAt(a.length-1)+d:f;break;case "mask-submitted":d=b?a+d:f;break;case "mask-all":d=f;break;default:d=f}}else d=a.length?b?a+d:a:b?d:"";return d},destroyOverlay:function(){this._TextEntryOverlay.suicide();delete this._TextEntryOverlay;this.focus()},changeValue:function(a,
b){this._TextEntryOverlay=(new MAF.control.TextEntryOverlay({creator:this})).appendTo(this.getView())}})},{ControlTextEntryButton:{renderSkin:function(a,b,d,c,e){b=new Frame;e.applyLayer("BaseGlow",b);"focused"===a&&e.applyLayer("BaseFocus",b);e.applyLayer("BaseHighlight",b);return b},styles:{width:"inherit",height:102}},ControlTextEntryButtonLabel:{styles:{fontSize:20,hOffset:10,vOffset:62}},ControlTextEntryButtonValue:{styles:{display:"block",margin:10,minHeight:"40px",height:"1.9em",padding:"5px",
border:"2px solid white",borderRadius:"10px",backgroundColor:"rgba(150,150,150,.5)",truncation:"end",opacity:0.9}}});define("MAF.control.TextEntryOverlay",function(){var a={},b=function(){this.config.creator.destroyOverlay()},d=function(a){var c=function(){a.payload&&(a.payload.defaultActionCallback&&a.payload.defaultActionCallback.call)&&a.payload.defaultActionCallback()};a.preventDefault();this.config.creator.fire("onCancel",{event:a,value:this.getValue(),cancelCallback:b.bindTo(this),defaultActionCallback:c})&&(b.call(this),c())},c=function(b){var c=this.inputField.element||!1,d=a[this._classID],h=c&&c.editable||
!1,k=!1,m,p;switch(b.type){case "cursormoved":m=d.value;p=b.payload.cursorPosition||d.cursorPosition;break;case "valuechanged":m=b.payload.value||d.value,p=d.cursorPosition}k=m;m=this.config;var n=m.creator,d=n.config.bulletCharacter||m.bulletCharacter;m=(n.config.secureMask||m.secureMask)&&n.config.secureMaskType||m.secureMaskType;n=d.repeat(k.length);if(m&&n.length)switch(m){case "mask-character":n=d.repeat(k.length-1)+k.charAt(k.length-1);break;case "mask-submitted":n=k;break;case "mask-all":break;
default:n=k}else n=k;d=n;h?"valuechanged"===b.type&&this.inputField.setText(d):(k=this.config.creator.config.cursorCharacter,d=d.substr(0,p)+k+d.substr(p,d.length),this.inputField.setText(d));"valuechanged"===b.type&&((k=this.retrieve("line")||1)&&k!==c.totalLines&&(d=this.inputField.lineHeight,this.form.height=k>c.totalLines?this.form.height-(k-Math.max(1,c.totalLines))*d:this.form.height+(c.totalLines-Math.max(1,k))*d),this.store("line",c.totalLines));h&&(isNumber(c.cursor)&&"cursormoved"===b.type)&&
(c.cursor=p||0)};return new MAF.Class({ClassName:"ControlTextEntryOverlay",Extends:MAF.element.Container,Protected:{onThemeNeeded:function(a){switch(a.type){case "onAppend":this.show()}},initValueManager:function(){var b,d=a[this._classID];d||(this.config.creator&&(this.config.creator.config&&this.config.creator.config.keyboard)&&(b=this.config.creator.config.keyboard.maxLength),this.config.keyboard&&(b=this.config.keyboard.maxLength),b||(b=this.config.maxLength),d=a[this._classID]=new MAF.keyboard.KeyboardValueManager({maxLength:b}),
c.subscribeTo(d,["cursormoved","valuechanged"],this))},createContent:function(){var c=this.config.creator.getView(),d=a[this._classID];this.setStyle("backgroundColor",this.config.creator.config.overlayBackgroundColor);c.element.allowNavigation=!1;var g=Theme.getStyles("ControlButton");Theme.getStyles("ControlTextEntryButtonLabel");var h=Theme.storage.get("ControlTextEntryButton").submitButtonPadding||0,k=Theme.getStyles("ControlTextEntryTextButtonText"),m=this.config.creator.config.submitButtonLabel||
"OK",p=this.config.creator.config.cancelButtonLabel||"Cancel";this.form=(new MAF.element.Container({styles:{width:c.width,vAlign:"center",backgroundColor:this.config.creator.config.formBackgroundColor}})).appendTo(this);var n=Theme.storage.get("ControlTextEntryOverlayClearButton")||{},l=(new MAF.element.Button({ClassName:"ControlTextEntryOverlayClearButton",content:new MAF.element.Text({label:"&#8999;",styles:{width:"inherit",height:"inherit",anchorStyle:"center"}}),styles:n.styling||{},events:{onSelect:function(){d.value=
""}}})).appendTo(this.form);this.inputField=(new MAF.element.TextField({ClassName:"ControlTextEntryButtonValue",label:"",styles:{width:c.width-80,height:"auto",wrap:!0},events:{onCursor:function(a){d.cursorPosition=a.payload.caret||0},onNavigate:function(a){"right"===a.payload.direction&&d.cursorPosition===d.value.length&&(a.preventDefault(),l.focus())}.bindTo(this),onKeyDown:function(a){0>["left","right","up","down"].indexOf(a.payload.key)&&(a.payload.layout=this.keyboard.config.layout,a.preventDefault(),
a.stopPropagation(),d.handleExternalKeyInput(a),this.keyboard.toggleKey(a.payload.key))}.bindTo(this)}})).appendTo(this.form);(new MAF.control.TextButton({label:p,styles:{vAlign:"bottom"},textStyles:k,events:{onSelect:function(){var a=this.getValue(),c=b.bindTo(this);this.config.creator.fire("onCancel",{value:a,cancelCallback:c})&&b.call(this)}.bindTo(this)}})).appendTo(this.form);g=g.height;(new MAF.control.TextButton({label:m,styles:{vAlign:"bottom",vOffset:g+h},textStyles:k,events:{onSelect:function(a){var c=
{value:d.value,cursorPosition:d.cursorPosition,submitCallback:function(){this.config.creator.setValue&&this.config.creator.setValue(c.value);b.call(this)}.bindTo(this)};this.config.creator.fire("onSubmit",c)&&c.submitCallback()}.bindTo(this)}})).appendTo(this.form);c=Object.merge(this.config.creator.config.keyboard,{embedded:!1,styles:{vAlign:"bottom",width:c.width,vOffset:2*g+2*h,controlSize:"standard"},events:{onKeyDown:function(a){a.preventDefault();a.stopPropagation();a.payload.layout=this.keyboard.config.layout;
d.handleExternalKeyInput(a)}.bindTo(this)}});this.keyboard=(new MAF.control.Keyboard(c)).appendTo(this.form);c=(new MAF.element.Text({label:this.config.creator.config.label,styles:{fontSize:20,hOffset:10,vAlign:"bottom",vOffset:2*g+3*h+this.keyboard.height}})).appendTo(this.form);this.form.height=2*g+c.vOffset-3*h},registerHandler:function(){this.boundHandler=d.subscribeTo(MAF.application,["onActivateBackButton","onActivateSettingsButton","onHideView"],this)},unregisterHandler:function(){this.boundHandler.unsubscribeFrom(MAF.application,
["onActivateBackButton","onActivateSettingsButton","onHideView"]);delete this.boundHandler}},config:{maxLength:255,element:View,creator:null},initialize:function(){this.parent();this.onThemeNeeded.subscribeTo(this,"onAppend",this);this.initValueManager();this.createContent();var b=a[this._classID];b.value=this.config.creator.getValue();b.value.length&&(b.cursorPosition=b.value.length)},getValue:function(){return a[this._classID].value},setValue:function(b){a[this._classID].value=b},show:function(){this.registerHandler();
this.keyboard.focus();return this},suicide:function(){this.unregisterHandler();var b=this.config.creator.getView();delete this.config.creator;b.element.allowNavigation=!0;a[this._classID].suicide();delete a[this._classID];this.inputField.suicide();this.keyboard.suicide();this.form.suicide();delete this.inputField;delete this.keyboard;delete this.form;this.parent()}})},{ControlTextEntryOverlay:{styles:{width:"inherit",height:"inherit"}},ControlTextEntryOverlayClearButton:{styling:{border:"2px solid white",
borderRadius:"10px",width:64,height:44,hAlign:"right",hOffset:2,vOffset:9},normal:{styles:{backgroundColor:Theme.getStyles("BaseGlow","backgroundColor")}},focused:{styles:{backgroundColor:Theme.getStyles("BaseFocus","backgroundColor")}}}});define("MAF.control.TabStrip",function(){var a=function(a,d){d=d||[];var c=Math.max(0,Math.min(a,d.length-1));return d[c]};return new MAF.Class({ClassName:"ControlTabStrip",Extends:MAF.element.Container,Protected:{onThemeNeeded:function(a){switch(a.type){case "onAppend":this.initTabs(this.config.tabs,this.focusIndex)}},handleFocusEvent:function(a){var d=this.focusIndex||0,c=-1<parseInt(this.activeIndex,10)?this.activeIndex:-1;switch(a.type){case "onFocus":d===c&&(this.focusIndex=d=0<c?c-1:c<this.buttons.length-
1?c+1:d);this.focusButton(d);break;case "onBlur":this.blurButton(d)}},handleSelectEvent:function(a){return this.activateButton(this.focusIndex)},handleNavEvent:function(a){var d=this.focusIndex,c=this.activeIndex,e=!1;switch(a.payload.direction){case "left":d&&(e=d-1);e==c&&(e=c?c-1:!1);break;case "right":d<this.buttons.length-1&&(e=d+1),e&&e==c&&(e=c<this.buttons.length-1?c+1:!1)}!1!==e&&(a.preventDefault(),this.focusIndex=e,this.focusButton(e),this.blurButton(d))},focusButton:function(b){if(b=a(b,
this.buttons)){var d=this.body.owner;b.fire("onFocus");d.scrollLeft=b.getStyle("left")+d.scrollLeft-(1+d.element.getBounds().left)}},blurButton:function(b){(b=a(b,this.buttons))&&b.fire("onBlur")},activateButton:function(a){var d=this.buttons[this.activeIndex]||!1,c=this.buttons[a]||!1;if(c&&c.fire){var e=this.getButtonConfig(c);this.activeIndex=e.index=a;c.fire("onActive");this.fire("onTabSelect",e)}d&&d.fire&&d.fire("onInactive")},generateButtons:function(a,d){for(this.buttons=this.buttons||[];0<
this.buttons.length;){var c=this.buttons.pop();c.tabController=null;c.suicide()}this.buttons.length=0;this.body.empty();a=-1<parseInt(a,10)?a:0;for(c=0;c<a;c++)this.buttons[c]=this.createButton(d).hide().appendTo(this.body);return this.buttons.length},createButton:function(a){var d=MAF.control.TabStripButton,c=this.config.buttonClass;a=c&&c.inheritsFrom&&c.inheritsFrom(d)?new c({noimages:a}):new d({noimages:a});a.tabController=this;return a},inspectStatePacket:function(a,d){if(!this.config.guid||
a&&!(this.config.guid in a))return a;var c=a&&a[this.config.guid],e=typeof c;if("null"==e||"undefined"==e)return a;d?c.focused&&this.focus():"object"===e&&("activeIndex"in c&&(this.activeIndex=c.activeIndex),"focusIndex"in c&&(this.focusIndex=c.focusIndex));return c},generateStatePacket:function(a){return Object.merge({activeIndex:this.activeIndex,focusIndex:this.focusIndex,focused:this.element.hasFocus},a)}},config:{focus:!0,defaultTab:null},initialize:function(){this.onThemeNeeded.subscribeTo(this,
"onAppend",this);this.handleFocusEvent.subscribeTo(this,["onFocus","onBlur"],this);this.handleSelectEvent.subscribeTo(this,"onSelect",this);this.handleNavEvent.subscribeTo(this,"onNavigate",this);this.activeIndex=0<this.config.defaultTab?--this.config.defaultTab:-1;this.focusIndex=this.activeIndex+1;this.parent();this.body=(new MAF.element.Core({ClassName:(this.config.ClassName||this.ClassName)+"Body",element:List})).appendTo(this)},initTabs:function(a,d){d=d||this.activeIndex+1;if(a){this.body.owner.scrollLeft=
0;this.activeIndex=0<d?--d:-1;this.focusIndex=1>this.activeIndex?0:this.activeIndex+1;this.focusIndex===a.length&&this.focusIndex--;this.config.tabs=a&&a.length?a:[];var c=0,e=!this.config.tabs.filter(function(a){return a.src||a.source}).length;this.generateButtons(this.config.tabs.length,e);this.buttons.forEach(function(a,b){a.setTabContent(this.config.tabs[b],e);a.show();var d=Theme.getStyles(a.ClassName),f=0;["border","borderLeft","borderRight","marginLeft","marginRight"].forEach(function(a){a=
"border"===a?2*parseInt(d[a],10):parseInt(d[a],10);f+=a||0},this);c+=a.width+f;a.fire(b==this.activeIndex?"onActive":"onInactive")},this);this.body.width=c||this.width;if(this.element.hasFocus){var f=parseInt(this.focusIndex,10)||0;this.focusButton(f)}}},getActiveIndex:function(){return this.activeIndex},getFocusIndex:function(){return this.focusIndex},getButtonIndex:function(a){return this.buttons.indexOf(a)},getButtonConfig:function(a){a=this.getButtonIndex(a);return-1<a?Object.clone(this.config.tabs[a]):
!1},suicide:function(){for(;this.buttons.length;)this.buttons.pop().suicide();delete this.buttons;this.body.suicide();delete this.body;this.parent()}})},{ControlTabStrip:{styles:{borderBottom:"2px solid grey",width:"inherit",height:51}},ControlTabStripBody:{styles:{height:"inherit"}}});define("MAF.control.TabStripButton",function(){return new MAF.Class({ClassName:"ControlTabStripButton",Extends:MAF.element.Container,config:{element:Item},Protected:{onThemeNeeded:function(a){if(!a.defaultPrevented){var b=this.element;switch(a.type){case "onFocus":b.addClass("focused");break;case "onBlur":b.removeClass("focused");break;case "onActive":b.addClass("selected");break;case "onInactive":b.removeClass("selected")}}},getTabController:function(){return this.tabController}},initialize:function(){this.onThemeNeeded.subscribeTo(this,
["onAppend","onFocus","onBlur","onActive","onInactive"],this);this.parent();this.config.noimages||(this.image=(new MAF.element.Image({ClassName:this.ClassName+"Image"})).appendTo(this));this.content=(new MAF.element.Text({ClassName:this.ClassName+"Text"})).appendTo(this)},getButtonIndex:function(){return this.getTabController().getButtonIndex(this)},setTabContent:function(a,b){this.content.setText(a.label);if(this.image&&(a.src||a.source)){var d=2*Theme.getStyles(this.ClassName+"Image","marginTop"),
c=Theme.getStyles(this.ClassName+"Text","paddingLeft"),d=this.height-d;this.image.width=this.image.height=d;this.image.setSources(a);this.content.setStyle("paddingLeft",c+d+c/2)}},adjustTabContent:emptyFn,suicide:function(){delete this.tabController;this.image&&(this.image.suicide(),delete this.image);this.parent()}})},{ControlTabStripButton:{normal:{styles:{backgroundColor:Theme.getStyles("BaseGlow","backgroundColor"),"float":"left",borderTop:"2px solid white",borderLeft:"2px solid white",borderRight:"2px solid white",
borderTopLeftRadius:"10px",borderTopRightRadius:"10px",marginLeft:1,height:"inherit",marginRight:1}},selected:{styles:{backgroundColor:Theme.getStyles("BaseActive","backgroundColor")}},focused:{styles:{backgroundColor:Theme.getStyles("BaseFocus","backgroundColor")}}},ControlTabStripButtonText:{styles:{position:"relative",fontSize:20,fontWeight:"bold",paddingLeft:12,paddingRight:12,height:"inherit",anchorStyle:"center"}},ControlTabStripButtonImage:{styles:{marginLeft:12,marginTop:4}}});define("MAF.control.TabPipeButton",function(){return new MAF.Class({ClassName:"ControlTabPipeButton",Extends:MAF.control.TabStripButton})},{ControlTabPipeButton:"ControlTabStripButton",ControlTabPipeButtonText:"ControlTabStripButtonText",ControlTabPipeButtonImage:"ControlTabStripButtonImage"});define("MAF.control.TabPipe",function(){return new MAF.Class({ClassName:"ControlTabPipe",Extends:MAF.control.TabStrip,config:{buttonClass:MAF.control.TabPipeButton},initialize:function(){this.parent();this.body.appendTo((new MAF.element.Container({ClassName:"ControlTabPipeContainer"})).appendTo(this))}})},{ControlTabPipe:{styles:{borderBottom:"2px solid grey",width:"inherit",height:"57px"}},ControlTabPipeBody:"ControlTabStripBody",ControlTabPipeContainer:{styles:{width:"100%",height:"100%",paddingTop:6,
paddingLeft:18,paddingRight:18}}});define("MAF.control.PageIndicator",function(){return new MAF.Class({ClassName:"ControlPageIndicator",Extends:MAF.control.Button,Protected:{dispatcher:function(a,b){switch(a.type){case "navigate":if(a.detail&&a.detail.direction&&("left"===a.detail.direction||"right"===a.detail.direction))return a.preventDefault(),this.shiftSource(a.detail.direction)}this.parent(a,b)},createContent:function(){Theme.getStyles(this.ClassName+"TextLink");var a=this.config.imageSources;this.text=(new MAF.element.Text({ClassName:this.ClassName+
"TextLink"})).appendTo(this);this.arrows={left:(new MAF.element.Image({ClassName:this.ClassName+"Arrowleft",src:a["<"],styles:{height:1,vAlign:"center",vOffset:-8,opacity:0}})).appendTo(this),right:(new MAF.element.Image({ClassName:this.ClassName+"Arrowright",src:a[">"],styles:{height:1,vAlign:"center",vOffset:-8,opacity:0}})).appendTo(this)}},buildDots:function(a,b,d){d="";for(var c=0;c<b;c++)d=a===c?d+"&#9675; ":d+"&#9679; ";return d},buildText:function(a,b,d){return this.config.updateText&&this.config.updateText.call?
this.config.updateText(a,b,d):widget.getLocalizedString("PAGE",[parseInt(a,10)+1,b])},updateArrows:function(a,b){var d={opacity:null},c={opacity:0.3},e=this.getSourceCarousel(),f=this.arrows.left,g=this.arrows.right;1===b?(f.setStyles(c),g.setStyles(c)):e?(f.setStyles(d),g.setStyles(d)):(f.setStyles(a?d:c),g.setStyles(a+1<b?d:c));this.alignArrows()},alignArrows:function(){var a=this.text.element.getTextBounds().width,b=this.config.arrowPadding,d=this.arrows.left,c=this.arrows.right;d.hOffset=this.width/
2-a/2-d.width-b;c.hOffset=d.width+d.hOffset+a+2*b},onSourceUpdated:function(a){return this.update(a.payload)}},config:{threshold:0,arrowPadding:6,imageSources:null,autoDisableWhenEmpty:!0},initialize:function(){this.parent();this.config.imageSources||(this.config.imageSources=Theme.storage.get("ControlPageIndicator","sources"));var a=this.config.sourceElement||this.config.source;a&&this.attachToSource(a);this.config.source=null;delete this.config.source;this.config.sourceElement=null;delete this.config.sourceElement},
attachToSource:function(a){if(!a||a===this.source)return this.update();this.source=a;this.onSourceUpdated.subscribeTo(this.source,"onStateUpdated",this);return this.update()},getSourceCurrentPage:function(){return this.source?this.source.getCurrentPage():1},getSourcePageCount:function(){return this.source?this.source.getPageCount():1},getSourceCarousel:function(){return this.source?this.source.config.carousel:!1},update:function(a){if(a&&(!1===a.pageChanging||void 0===a.currentPage))return this;var b=
a&&a.currentPage?a.currentPage:this.getSourceCurrentPage()||0,d=a&&a.pageCount?a.pageCount:this.getSourcePageCount()||1,c=d<(parseInt(this.config.threshold,10)||0),e=c?this.buildDots:this.buildText;this.text&&this.text.setText(e.call(this,b,d,a));c?(this.element.wantsFocus=!1,this.arrows.left.freeze(),this.arrows.right.freeze()):0<d&&(this.element.wantsFocus=!0,this.arrows.left.thaw(),this.arrows.right.thaw());this.updateArrows(b,d);!1===this.config.focus&&(this.element.wantsFocus=!1);this.config.autoDisableWhenEmpty&&
this.setDisabled(2>d);return this},shiftSource:function(a){this.source.shift(a)},suicide:function(){delete this.previousPage;delete this.source;this.text.suicide();delete this.text;Object.forEach(this.arrows,function(a,b){delete this.arrows[a];b.suicide()},this);delete this.arrows;this.parent()}})},{ControlPageIndicator:{renderSkin:function(a,b,d,c,e){b=new Frame;e.applyLayer("BaseGlow",b);"focused"===a&&e.applyLayer("BaseFocus",b);e.applyLayer("BaseHighlight",b);return b},styles:{width:"inherit",
height:"38px"},sources:{"<":Image.WHITE,">":Image.WHITE}},ControlPageIndicatorTextLink:{styles:{width:"inherit",height:"inherit",anchorStyle:"center"}},ControlPageIndicatorArrowleft:{styles:{marginLeft:"-12px",borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderRight:"8px solid white"}},ControlPageIndicatorArrowRight:{styles:{marginLeft:"2px",borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderLeft:"8px solid white"}}});define("MAF.control.SingleTab",function(){return new MAF.Class({ClassName:"ControlSingleTab",Extends:MAF.control.Button,Protected:{dispatcher:function(a,b){switch(a.type){case "focus":case "blur":this.arrows&&!0===this.config.focusArrows&&(this.arrows.left.visible=this.arrows.right.visible="focus"===a.type?!0:!1);break;case "navigate":if(a.detail&&a.detail.direction)switch(a.detail.direction){case "left":case "right":a.preventDefault(),this.shiftSource(a.detail.direction)}}this.parent(a,b)},createContent:function(){var a=
this.config.imageSources||Theme.storage.get(this.ClassName,"sources");this.text=(new MAF.element.Text({ClassName:(this.config.ClassName||this.ClassName)+"Text",label:this.config.label,styles:Object.merge({width:this.width-80,height:this.height,hOffset:40,anchorStyle:"center",truncation:"SingleTab"===this.ClassName?"end":null},this.config.textStyles||{})})).appendTo(this);this.arrows={left:(new MAF.element.Image({ClassName:"ControlSingleTabArrowleft",autoShow:!this.config.focusArrows,src:a["<"],styles:{left:this.config.arrowPadding,
height:1,vAlign:"center",vOffset:-8,visible:!this.config.focusArrows}})).appendTo(this),right:(new MAF.element.Image({ClassName:"ControlSingleTabArrowright",autoShow:!this.config.focusArrows,src:a[">"],styles:{hAlign:"right",hOffset:this.config.arrowPadding,height:1,vAlign:"center",vOffset:-8,visible:!this.config.focusArrows}})).appendTo(this)};a=this.getOptions();this.setValue(this.config.value||a&&0<a.length?a[0].value:"");delete this.config.value},updateArrows:function(a,b){var d={opacity:null},
c={opacity:0.3},e=this.config.carousel,f=this.arrows.left,g=this.arrows.right;1===b?(f.setStyles(c),g.setStyles(c)):e?(f.setStyles(d),g.setStyles(d)):(f.setStyles(a?d:c),g.setStyles(a+1<b?d:c));this.alignArrows(a,b)},alignArrows:emptyFn},config:{background:!1,arrowPadding:8,focusArrows:!1,carousel:!1},initialize:function(){this.parent();this.config.options&&(this.setOptions(this.config.options),delete this.config.options)},getValue:function(){return String(this.retrieve("value")||"")},setValue:function(a){var b=
void 0===this.retrieve("value");a=void 0===a?"":String(a);if((this.retrieve("value")||"")===a&&!b)return"";this.store("value",a);this.fire(b?"onTabInitialized":"onTabChanged",{value:a,index:this.getActiveIndex()});this.update();return this.getValue()},getDisplayValue:function(a){var b=a=a||this.getValue();this.getOptions().forEach(function(d){d.value==a&&(b=d.label)});return b},initTabs:function(a,b,d){this.setOptions(a,b,d);(0===this.getValue().length||d)&&this.setValue(this.config.value||this.getOptions()[0].value)},
setOptions:function(a,b,d){a=[].concat(a);a=a.map(function(a,d){var f="object"==typeOf(a),g=b&&b.length||0;return a?{value:f&&"value"in a?String(a.value):String(a),label:g>d?b[d]:f&&"label"in a?a.label:a}:a});this.store("options",a);this.fire("onOptionsChanged",{options:this.getOptions()})},getOptions:function(){return this.retrieve("options")||[]},getOptionValues:function(){return this.getOptions().map(function(a){return a.value})},getOptionLabels:function(){return this.getOptions().map(function(a){return a.label})},
getActiveIndex:function(){var a=this.getOptions(),b=this.getValue(),a=a.map(function(a){return a.value}).indexOf(b);return 0>a?0:a},shiftSource:function(a){var b=this.getOptions(),d=!0===this.config.carousel,c=this.getActiveIndex();if(!(2>b.length)){switch(a){case "left":c=0===c?d?b.length-1:c:c-1;break;case "right":c=c===b.length-1?d?0:c:c+1}this.setValue(b[c].value)}},update:function(a){var b=this.getOptions();!0===a&&this.setValue(b[0].value);a=b.map(function(a){return a.value}).indexOf(this.getValue());
var b=b.length,d=this.getDisplayValue();this.text.setText(d);this.updateArrows(0>a?0:a,b)},suicide:function(){this.text.suicide();delete this.text;Object.forEach(this.arrows,function(a,b){delete this.arrows[a];b.suicide()},this);delete this.arrows;this.parent()}})},{ControlSingleTab:"ControlPageIndicator",ControlSingleTabArrowleft:{styles:{borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderRight:"8px solid white"}},ControlSingleTabArrowright:{styles:{borderTop:"8px solid transparent",
borderBottom:"8px solid transparent",borderLeft:"8px solid white"}}});define("MAF.control.FixedTab",function(){return new MAF.Class({ClassName:"ControlFixedTab",Extends:MAF.control.SingleTab,Protected:{createContent:function(){this.right=(new MAF.element.Text({anchorStyle:"leftCenter",styles:Object.merge({height:this.height,opacity:0.7},this.config.textStyles||{})})).appendTo(this);this.parent()},alignArrows:function(a,b){var d=this.text.element.getTextBounds(),c=this.getOptions(),e=this.config.arrowPadding,f=this.arrows;f.left.hOffset=e;this.text.setStyles({width:d.width,
hOffset:f.left.outerWidth+10+e});f.right.hAlign=null;f.right.hOffset=this.text.outerWidth+e;d=f.right.outerWidth+10+e;this.right.setStyles({width:this.width-d,hOffset:d});var g="";c&&(c.forEach(function(b,c){c>a&&(g+=b.label+this.textPadding)},this),c.forEach(function(b,c){c<a&&(g+=b.label+this.textPadding)},this));this.right.setText(g)}},config:{optionsPadding:"    "},initialize:function(){this.parent();this.textPadding=this.config.optionsPadding.replace(/(?:(?:^ | $)|( ) )/gm,"&nbsp;")},suicide:function(){delete this.textPadding;
this.right.suicide();delete this.right;this.parent()}})},{ControlFixedTab:"ControlPageIndicator"});define("MAF.control.MetadataDisplay",function(){return new MAF.Class({ClassName:"ControlMetadataDisplay",Extends:MAF.control.Button,Protected:{createContent:function(){this.content=(new MAF.element.Text({ClassName:this.ClassName+"Text",styles:this.config.textStyles||{}})).appendTo(this)},updateContent:function(a){var b=a&&-1<parseInt(a.startIndex,10)?a.startIndex:this.source.getStartIndex();a=a&&-1<parseInt(a.focusIndex,10)?a.focusIndex:this.source.getFocusIndex();b=-1<parseInt(b,10)&&-1<parseInt(a,
10)?b+a:!1;(b=!1!==b&&this.getSourceDataItem(b))&&(a=this.config.updateMethod||this.updateMethod)&&a.call&&a.call(this,b)},updateMethod:function(a){var b="";switch(typeOf(a)){case "string":b=a;break;case "object":var d=this.config.metadataMap;d?b=a[d.label||d.text]:"label"in a?b=a.label:"text"in a&&(b=a.text)}this.setText(b)},onSourceUpdated:function(a){switch(a.type){case "onStateUpdated":return this.updateContent(a.payload);case "onFocus":this.fire("onFocus");this.content.thaw();break;case "onBlur":this.fire("onBlur"),
this.content.freeze()}}},config:{focus:!1},initialize:function(){this.parent();var a=this.config.sourceElement||this.config.source;a&&this.attachToSource(a);this.config.source=null;delete this.config.source;this.config.sourceElement=null;delete this.config.sourceElement},attachToSource:function(a){if(a===this.source)return this.update();this.source=a;this.onSourceUpdated.subscribeTo(this.source,["onStateUpdated","onFocus","onBlur"],this);return this.updateContent()},getSourceStartIndex:function(){return this.source&&
this.source.getStartIndex()},getSourceFocusIndex:function(){return this.source&&this.source.getFocusIndex()},getSourceDataItem:function(a){return this.source&&this.source.getDataItem(a)},setText:function(a){this.content.setText(a||"")},suicide:function(){delete this.source;this.parent()}})},{ControlMetadataDisplay:{styles:{width:"inherit",height:40}},ControlMetadataDisplayText:{styles:{width:"100%",height:"inherit",paddingLeft:5,paddingRight:5,anchorStyle:"center",truncation:"end"}}});define("MAF.control.Grid",function(){return new MAF.Class({ClassName:"ControlGrid",Extends:MAF.element.Grid,Protected:{generateCells:function(a){a=this.parent(a);this.cells.forEach(function(a){a.fire("onAppend",{parent:this.element,owner:this})},this);return a},onThemeNeeded:function(a){if(!a.defaultPrevented)switch(a.type){case "onFocus":this.renderSkin("focused");break;case "onBlur":case "onAppend":this.renderSkin("normal")}}},initialize:function(){this.parent();this.onThemeNeeded.subscribeTo(this,
["onAppend","onFocus","onBlur"],this)}})},{ControlGrid:{renderSkin:function(a,b,d,c,e){}},ControlGridCellHighlight:{}});define("MAF.control.GridCell",function(){return new MAF.Class({ClassName:"ControlGridCell",Extends:MAF.element.GridCell,Protected:{onThemeNeeded:function(a){if(!a.defaultPrevented){var b=this.getCellCoordinates();switch(a.type){case "onFocus":this.renderSkin("focused",b);break;case "onBlur":case "onAppend":this.renderSkin("normal",b)}}}},initialize:function(){this.parent();this.onThemeNeeded.subscribeTo(this,["onAppend","onFocus","onBlur"],this)}})},{ControlGridCell:{renderSkin:function(a,b,d,c,e){b=
new Frame;e.applyLayer("BaseGlow",b);"focused"===a&&e.applyLayer("BaseFocus",b);e.applyLayer("BaseHighlight",b);return b}}});define("MAF.control.PhotoGridCell",function(){var a=function(){var a=Math.min(this.width,this.height)-2*(this.config.cellPadding||0);this.photo.aspectSizeMax(a);this.photo.show()};return new MAF.Class({ClassName:"ControlPhotoGridCell",Extends:MAF.control.GridCell,config:{cellPadding:16},initialize:function(){this.parent();this.photo=(new MAF.element.Image({ClassName:"ControlPhotoHolderImage",hideWhileLoading:!0,autoShow:!1,styles:{hAlign:"center",vAlign:"center"}})).appendTo(this);a.subscribeTo(this.photo,
"onLoaded",this);this.photo.setSources(this.config)},setSources:function(a){return this.photo.setSources(a)},setSource:function(a){return this.photo.setSource(a)}})},{ControlPhotoGridCell:"ControlGridCell",ControlPhotoHolderImage:{styles:{border:"2px solid white"}}});define("MAF.dialogs.BaseDialogImplementation",function(){var a={};return new MAF.Class({ClassName:"BaseDialogImplementation",Implements:[Library.Storage],Protected:{removeHandler:function(){var b=a[this._classID];b&&(b.unsubscribeFrom(MAF.application,["onDialogDone","onDialogCancelled","onHideView"]),delete a[this._classID])}},config:{focusOnCompletion:null,isModal:!1},initialize:function(){this.store("key",md5(this._classID))},show:function(){MAF.application.isSidebarLoaded()&&(this.store("viewId",
MAF.application.getCurrentViewId()),a[this._classID]=this.dispatcher.subscribeTo(MAF.application,["onDialogDone","onDialogCancelled","onHideView"],this),MAF.HostEventManager.send("showDialog",this.getDialogConfig()))},hide:function(){this.removeHandler();MAF.HostEventManager.send("hideDialog",this.getDialogConfig())},dispatcher:function(a){"onHideView"==a.type?this.retrieve("viewId")===a.payload.viewId&&this.removeHandler():a.payload.key===this.retrieve("key")&&(this.removeHandler(),"onDialogCancelled"===
a.type&&(a.payload.cancelled=!0),this.config.focusOnCompletion&&(this.config.focusOnCompletion.focus&&this.config.focusOnCompletion.focus.call)&&(this.config.focusOnCompletion.focus(),delete this.config.focusOnCompletion),this.handleCallback(a.payload))},getDialogConfig:function(){if(DEBUG)throw Error("All subclasses must provide this method!");},handleCallback:function(a){if(DEBUG)throw Error("All subclasses must provide this method!");}})});define("MAF.dialogs.Alert",function(){return new MAF.Class({ClassName:"AlertDialog",Extends:MAF.dialogs.BaseDialogImplementation,config:{title:"",message:"",buttons:[],cancelCallback:null},initialize:function(){this.parent();var a=[],b={};if(this.config.buttons&&this.config.buttons instanceof Array)[].concat(this.config.buttons).forEach(function(d){var c=md5(d.label+"100");d.callback&&d.callback.call&&this.store(c,d.callback);a.push({value:c,label:d.label});b[c]=d},this),this.store("configs",b),this.store("buttons",
a);else throw Error("Can't create an alert without any buttons");delete this.config.buttons},getDialogConfig:function(){return{type:"alert",conf:{ignoreBackKey:this.config.isModal,key:this.retrieve("key"),title:this.config.title,message:this.config.message,buttons:this.retrieve("buttons")}}},handleCallback:function(a){var b=a.selectedValue,d=this.retrieve(b),b={selected:this.retrieve("configs")[b]||{}};a.cancelled?this.config.cancelCallback&&this.config.cancelCallback.call&&this.config.cancelCallback(b):
d&&d.call&&d(b)}})});define("MAF.dialogs.TextEntry",function(){return new MAF.Class({ClassName:"TextEntryDialog",Extends:MAF.dialogs.BaseDialogImplementation,config:{title:"",message:"",callback:null,cancelCallback:null},initialize:function(){this.parent()},getDialogConfig:function(){return{type:"textentry",conf:{ignoreBackKey:this.config.isModal,key:this.retrieve("key"),title:this.config.title,message:this.config.message}}},handleCallback:function(a){a.cancelled?this.config.cancelCallback&&this.config.cancelCallback.call&&
this.config.cancelCallback(a):this.config.callback&&this.config.callback.call&&this.config.callback(a)}})});define("MAF.dialogs.VerifyPin",function(){return new MAF.Class({ClassName:"VerifyPinDialog",Extends:MAF.dialogs.BaseDialogImplementation,config:{title:"",message:"",errorMessage:"",isAdminPIN:!1,profileId:null,forgotPinCallback:null,callback:null,cancelCallback:null},initialize:function(){this.parent()},getDialogConfig:function(){return{type:"pin",conf:{key:this.retrieve("key"),title:this.config.title,message:this.config.message,errorMessage:this.config.errorMessage,isAdminPIN:this.config.isAdminPIN,
profileId:this.config.profileId,ignoreBackKey:this.config.isModal}}},handleCallback:function(a){a.cancelled?this.config.cancelCallback&&this.config.cancelCallback.call&&this.config.cancelCallback(a):a.forgot?this.config.forgotPinCallback&&this.config.forgotPinCallback.call&&this.config.forgotPinCallback(a):this.config.callback&&this.config.callback.call&&this.config.callback(a)}})});define("MAF.dialogs.Login",function(){return new MAF.Class({ClassName:"LoginDialog",Extends:MAF.dialogs.BaseDialogImplementation,config:{title:"",message:"",callback:null,cancelCallback:null},initialize:function(){this.parent()},getDialogConfig:function(){return{type:"login",conf:{ignoreBackKey:this.config.isModal,key:this.retrieve("key"),title:this.config.title,message:this.config.message}}},handleCallback:function(a){a.cancelled?this.config.cancelCallback&&this.config.cancelCallback.call&&this.config.cancelCallback(a):
this.config.callback&&this.config.callback.call&&this.config.callback(a)}})});define("MAF.system.BaseView",function(){var a={};return new MAF.Class({ClassName:"BaseView",Extends:MAF.element.Core,Protected:{initElement:function(){this.parent();var a=this.constructor.prototype;a&&a.constructor&&this.element.addClass(a.constructor.prototype.ClassName)},elementEvents:function(a){this.parent(["focus","blur"].concat(a||[]))},dispatcher:function(a){this.parent(a);switch(a.type){case "firstdisplay":this.fire("onFirstDisplay",null,a);break;case "focus":this.fire("onFocus",null,a);break;
case "blur":this.fire("onBlur",null,a)}},onLoadView:function(){this.fire("onCreateView")&&this.createView()},onUnloadView:function(){this.fire("onDestroyView")&&this.destroyView();this.unregisterMessageCenterListeners();this.cache={};this.controls={};this.elements={};a[this._classID]=[]},onShowView:function(){this.fire("onUpdateView")&&this.updateView()},onHideView:function(){this.fire("onHideView")&&this.hideView()},onSelectView:function(){this.fire("onSelectView")&&this.selectView()},onUnselectView:function(){this.fire("onUnselectView")&&
this.unselectView()},setInitialFocus:emptyFn,unregisterMessageCenterListeners:function(){if(0<a[this._classID].length)for(var b=!1;b=a[this._classID].pop();)b&&(b.unsubscribeFrom&&b.unsubscribeFrom.call)&&b.unsubscribeFrom(MAF.messages,MAF.messages.eventType)},getControlData:function(a,d){if(this.persist&&this.persist.___systemViewData___&&this.persist.___systemViewData___[a]){var c=this.persist.___systemViewData___[a];d&&this.clearControlData(a);return c}},setControlData:function(a,d){this.persist=
this.persist||{};this.persist.___systemViewData___=this.persist.___systemViewData___||{};this.persist.___systemViewData___[a]=d},clearControlData:function(a){delete this.persist.___systemViewData___[a]},getViewController:function(){return this}},config:{element:View},initialize:function(){this.parent();this.cache={};this.persist={};this.controls={};this.elements={};a[this._classID]=[];this.selected=this.rendered=!1;this.config.backParams&&(this.backParams=this.config.backParams,this.config.backParams=
null,delete this.config.backParams);this.config.persistParams&&(this.persist=this.config.persistParams,this.config.persistParams=null,delete this.config.persistParams);this.initView()},initView:emptyFn,createView:emptyFn,updateView:emptyFn,selectView:emptyFn,unselectView:emptyFn,destroyView:emptyFn,hideView:emptyFn,favbutton:emptyFn,getView:function(){return this},registerMessageCenterListenerCallback:function(b){b&&b.subscribeTo&&a[this._classID].push(b.subscribeTo(MAF.messages,MAF.messages.eventType,
this))},registerMessageCenterListenerControl:function(b){b&&b.fire&&a[this._classID].push(b.fire.subscribeTo(MAF.messages,MAF.messages.eventType,b))},suicide:function(){delete a[this._classID];delete this.persist;delete this.cache;Object.forEach(this.elements,function(a,d){d&&d.suicide&&(delete this.elements[a],d.suicide())},this);delete this.elements;Object.forEach(this.controls,function(a,d){d&&d.suicide&&(delete this.controls[a],d.suicide())},this);delete this.controls;this.parent()}})});define("MAF.system.WindowedView",function(){var a=function(a,d){(a=Object.merge(this.persist,a,this.backParams))&&Object.forEach(this.controls,function(f,g){"array"===typeOf(g)?g.forEach(function(f,g){b.call(this,f,a,d)},this):b.call(this,g,a,d)},this)},b=function(a,b,d){a.config&&(a.config.guid&&a.inspectStatePacket&&a.inspectStatePacket.call)&&a.inspectStatePacket.call(a,b,d)},d=function(a,b){a.config&&(a.config.guid&&a.generateStatePacket&&a.generateStatePacket.call)&&(b[a.config.guid]=a.generateStatePacket.call(a))};
return new MAF.Class({ClassName:"WindowedView",Extends:MAF.system.BaseView,Protected:{dispatcher:function(a){this.parent(a);switch(a.type){case "navigate":this.fire("onNavigate",a.detail,a);break;case "navigateoutofbounds":this.fire("onNavigateOutOfBounds",a.detail,a)}},elementEvents:function(a){this.parent(["navigate","navigateoutofbounds"].concat(a||[]))},setInitialFocus:function(){!0===this.hasbeenfocused&&document.activeElement||(this.parent(),this.hasbeenfocused=!0,this.element.focusedView||
this.resetFocus(),a.call(this,this.getControlData("statePacket",!0),!0),this.fire("onFocusView")&&this.focusView())},onSelectView:function(b){this.parent(b);this.element.focusedView||this.resetFocus();a.call(this,this.getControlData("statePacket"),!1)},onUnselectView:function(a){this.parent(a);var b={};Object.forEach(this.controls,function(a,c){"array"===typeOf(c)?c.forEach(function(a,c){d.call(this,a,b)},this):d.call(this,c,b)},this);this.setControlData("statePacket",b);this.hasbeenfocused=!1},onHideView:function(a){this.parent(a);
this.backParams={}}},focusView:emptyFn,resetFocus:function(){this.element&&this.element.navigate("down",[0,0])}})});define("MAF.system.SidebarView",function(){return new MAF.Class({ClassName:"SidebarView",Extends:MAF.system.WindowedView,viewType:"SIDEBAR"})},{SidebarView:{styles:{width:"588px",height:"930px"}}});define("MAF.system.FullscreenView",function(){return new MAF.Class({ClassName:"FullscreenView",Extends:MAF.system.WindowedView,viewType:"FULLSCREEN",config:{showPassthroughVideo:!1}})},{FullscreenView:{styles:{width:"1920px",height:"1080px"}}});define("MAF.system.SnippetView",function(){return new MAF.Class({ClassName:"SnippetView",Extends:MAF.system.BaseView,viewType:"SNIPPET"})},{SnippetView:{styles:{width:"470px",height:"166px"}}});define("MAF.system.AnchorSnippetView",function(){return new MAF.Class({ClassName:"AnchorSnippetView",Extends:MAF.system.SnippetView,viewType:"SNIPPET"})});define("MAF.system.ProfileSnippetView",function(){return new MAF.Class({ClassName:"ProfileSnippetView",Extends:MAF.system.SnippetView,viewType:"SNIPPET"})});define("MAF.system.OptionSelectView",function(){return new MAF.Class({ClassName:"OptionSelectView",Extends:MAF.system.SidebarView,Protected:{cancelDialogNeeded:function(a){log("cancelDialogNeeded OptionSelectView")},onOptionCancelled:function(a){this.unregisterHandlers();var b={};this.config.data.guid&&(b[this.config.data.guid]={optionSelected:!1,optionViewId:this.config.id,cancelType:a});MAF.application.previousView(b)}},config:{data:{optionGridRows:1,optionGridColumns:1,value:null,backLabel:"Select an Option"}},
createView:function(){var a=(new MAF.control.BackButton({label:this.config.data.backLabel,events:{onSelect:this.cancelOption.bindTo(this)}})).appendTo(this),b=(new MAF.control.PageIndicator({styles:{vAlign:"bottom"}})).appendTo(this);this.elements.grid=(new MAF.control.Grid({rows:this.config.data.optionGridRows,columns:this.config.data.optionGridColumns,styles:{width:this.width,height:this.height-a.height-b.height,vOffset:a.height},cellCreator:this.optionCellCreator,cellUpdater:this.optionCellUpdater})).attachAccessory(b).appendTo(this)},
updateView:function(){this.registerHandlers();this.elements.grid.changeDataset(this.config.data.options)},submitOption:function(a){this.unregisterHandlers();var b={};this.config.data.guid&&(b[this.config.data.guid]={optionSelected:!0,option:a,optionViewId:this.config.viewId});MAF.application.previousView(b)},cancelOption:function(a){a.preventDefault();if(this.config.data.cancelDialog)this.cancelDialogNeeded(a.type);else this.onOptionCancelled(a.type)},registerHandlers:function(){this.cancel=this.cancelOption.bindTo(this);
this.cancel.subscribeTo(MAF.application,["onActivateBackButton","onActivateSettingsButton","onActivateHomeButton"])},unregisterHandlers:function(){this.cancel.unsubscribeFrom(MAF.application,["onActivateBackButton","onActivateSettingsButton","onActivateHomeButton"]);delete this.cancel},optionCellCreator:function(){var a=new MAF.control.GridCell({styles:this.getCellDimensions(),events:{onSelect:function(){var a=this.getCellDataItem();this.grid.owner.submitOption(a)}}});a.content=(new MAF.element.Text({ClassName:"ControlOptionSelectCellText",
styles:{width:a.width-10,height:a.height}})).appendTo(a);return a},optionCellUpdater:function(a,b){a.content.setText(b.label)}})},{ControlOptionSelectCellText:{styles:{width:"100%",height:"inherit",paddingLeft:10,paddingRight:10,anchorStyle:"leftCenter"}}});define("MAF.system.AboutDocView",function(){return new MAF.Class({ClassName:"AboutDocView",Extends:MAF.system.SidebarView,config:{data:{backLabel:"Back"}},createView:function(){this.controls.backButton=(new MAF.control.BackButton({guid:this._classID+".BackButton",label:this.config.data.backLabel})).appendTo(this);this.controls.pageIndicator=(new MAF.control.PageIndicator({guid:this._classID+".PageIndicator",styles:{width:this.width,vAlign:"bottom"}})).appendTo(this);var a=Theme.getStyles("AboutDocViewTextGrid",
"margin");this.elements.textGrid=(new MAF.element.TextGrid({ClassName:"AboutDocViewTextGrid",styles:{width:this.width-2*a,height:this.height-(this.controls.pageIndicator.height+this.controls.backButton.height)-2*a,vOffset:this.controls.backButton.outerHeight,anchorStyle:"justify"}})).appendTo(this).attachAccessories(this.controls.pageIndicator)},updateView:function(){this.elements.textGrid.setText(this.config.data.value)}})},{AboutDocViewTextGrid:{styles:{fontSize:22,color:"#FFFFFF",margin:7,wrap:!0}}});define("MAF.control.SelectButton",function(){return new MAF.Class({ClassName:"ControlSelectButton",Extends:MAF.control.InputButton,config:{valueOnSubline:!1,fillEmptySpace:!1,optionViewClass:MAF.system.OptionSelectView,optionGridRows:1,optionGridColumns:1},changeValue:function(a,b){var d=this.config.optionViewClass;!DEBUG||d&&d.inheritsFrom&&d.inheritsFrom(MAF.system.SidebarView)||warn(this.ClassName,"buildOptionView","no usable view class in config.optionViewClass");d={id:this.config.optionListViewId||
this._classID+"."+d.prototype.ClassName,data:{guid:this.config.guid,backLabel:this.config.label,options:this.getOptions(),value:b,optionGridRows:this.config.optionGridRows,optionGridColumns:this.config.optionGridColumns,cancelDialog:this.config.cancelDialog},viewClass:d};this.optionListViewId=d.id;MAF.application.addViewConfig(d);MAF.application.loadView(d.id)},inspectStatePacket:function(a,b){var d=this.parent(a,b);if(!b){var c;if(d){if(d.optionViewId){var e=d.optionViewId;e&&(MAF.application.removeView(e),
delete this.optionListViewId)}switch(d.cancelType){case "onActivateHomeButton":c=MAF.application.loadDefaultView;break;case "onActivateSettingsButton":c=MAF.application.loadSettingsView}}try{return d}finally{c&&c()}}}})},{ControlSelectButton:"ControlButton",ControlSelectButtonSubline:"ControlInputButtonSubline"});define("MAF.views.AboutBox",function(){return new MAF.Class({ClassName:"AboutBoxView",Extends:MAF.system.SidebarView,config:{BackButtonTitle:"About"},createView:function(){var a=["copyright","tos","privacy"],b=parseInt(Theme.getStyles("ControlTextButton","normal").height,10)||51,d=(new MAF.control.BackButton({label:this.config.BackButtonTitle})).appendTo(this),c=[];"array"===typeOf(this.config.pages)?(this.config.pages.forEach(function(b){if(-1<a.indexOf(b.id)){if(!("srcString"in b))try{b.srcString=
filesystem.readFile("About/"+widget.locale+"/"+b.id+".txt",!0)}catch(d){b.srcString=""}c.splice(0,0,b)}else c.push(b)}),c.length=5<c.length?5:c.length):this.config.pages=[];var d=(new MAF.element.Container({styles:{width:this.width,height:this.height-(b*c.length+d.height),vOffset:d.height}})).appendTo(this),e=(new MAF.element.Text({ClassName:"AboutBoxViewMetadataName",label:widget.name})).appendTo(d),f=(new MAF.element.Text({ClassName:"AboutBoxViewMetadataDescription",label:widget.description,styles:{vOffset:e.height+
e.vOffset}})).appendTo(d),e=Theme.storage.get("AboutBoxViewMetadataAuthorNote","PAD_TOP"),e=(new MAF.element.Text({ClassName:"AboutBoxViewMetadataAuthorNote",label:widget.getLocalizedString("WIDGET_BY")+"...",styles:{vOffset:f.height+f.vOffset+e}})).appendTo(d),e=(new MAF.element.Text({ClassName:"AboutBoxViewMetadataAuthor",label:widget.author&&0!==widget.author.length&&widget.author!==widget.company?widget.author+", "+(widget.company||""):widget.company||"",styles:{vOffset:e.height+e.vOffset}})).appendTo(d),
f=(new MAF.element.Text({ClassName:"AboutBoxViewMetadataVersion",label:widget.version,styles:{vOffset:e.height+e.vOffset}})).appendTo(d);if(widget.authorURL||widget.url)e=Theme.storage.get("AboutBoxViewMetadataUrlNote","PAD_TOP"),e=(new MAF.element.Text({ClassName:"AboutBoxViewMetadataUrlNote",label:widget.getLocalizedString("MORE_INFO")+"...",styles:{vOffset:f.height+f.vOffset+e}})).appendTo(d),(new MAF.element.Text({ClassName:"AboutBoxViewMetadataUrl",label:widget.authorURL||widget.url,styles:{vOffset:e.height+
e.vOffset}})).appendTo(d);e=Theme.storage.get("AboutBoxViewMetadataCopyright","PAD_BOTTOM");(new MAF.element.Text({ClassName:"AboutBoxViewMetadataCopyright",label:widget.getLocalizedString("COPYRIGHT",(new Date).getFullYear())+" "+widget.copyright,styles:{vOffset:d.height-e}})).appendTo(d);e=Theme.storage.get("AboutBoxViewMetadataReserved","PAD_BOTTOM");(new MAF.element.Text({ClassName:"AboutBoxViewMetadataReserved",label:widget.getLocalizedString("RIGHTS_RESERVED"),styles:{vOffset:d.height-e}})).appendTo(d);
if(c.length){var g=null,h=(new MAF.element.Core({styles:{width:this.width,height:b*c.length,vAlign:"bottom"}})).appendTo(this);c.forEach(function(a){g=a instanceof MAF.element.Button?a:new MAF.control.TextButton({label:a.name,value:a.srcString,styles:{vOffset:g?g.outerHeight:0},events:{onSelect:function(){var a={id:this._classID+"AboutDocView",data:{backLabel:this.config.label,value:this.config.value},viewClass:MAF.system.AboutDocView};MAF.application.addViewConfig(a);MAF.application.loadView(a.id,
{documentText:this.config.value})}}});g.appendTo(h)})}}})},{AboutBoxView:"SidebarView",AboutBoxViewMetadataName:{styles:{width:"100%",paddingLeft:5,paddingRight:5,truncation:"end",vOffset:67,fontSize:32}},AboutBoxViewMetadataDescription:{styles:{width:"100%",paddingLeft:5,paddingRight:5,truncation:"end",fontSize:18,fontWeight:"bold"}},AboutBoxViewMetadataAuthorNote:{PAD_TOP:20,styles:{hOffset:5,fontSize:18}},AboutBoxViewMetadataAuthor:{styles:{hOffset:5,fontSize:18}},AboutBoxViewMetadataVersion:{styles:{hOffset:5,
fontSize:18}},AboutBoxViewMetadataUrlNote:{PAD_TOP:20,styles:{hOffset:5,fontSize:18}},AboutBoxViewMetadataUrl:{styles:{hOffset:5,fontSize:18}},AboutBoxViewMetadataCopyright:{PAD_BOTTOM:40,styles:{hOffset:5,fontSize:15}},AboutBoxViewMetadataReserved:{PAD_BOTTOM:20,styles:{hOffset:5,fontSize:15}}});define("MAF.views.SeachSuggest",function(){return new MAF.Class({ClassName:"SearchSuggestView",Extends:MAF.system.SidebarView,config:{Cursor:"_",DisplayDefaultValue:"",AutocompleteThreshold:3,GridRows:6,GridColumns:1,bulletCharacter:"\u2022",secureMask:!1,secureMaskType:"mask-submitted",formBackgroundColor:"#000",keyboard:{startFocused:!0,maxLength:15}},createView:emptyFn,updateView:emptyFn})});